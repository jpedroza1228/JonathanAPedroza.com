{
  "hash": "6b1756b9b5d219b48f11804ed717eed0",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Bayesian Network for US Coffee Tasting Data\" \nsubtitle: |\n  Estimation Using Bnlearn Package\nimage: pourover.jpg\ncategories: [Bayesian, Bayesian Network, bayes net, R, bnlearn, dag]\ndate: 2024-11-11\n# citation:\n  # url: \nexecute:\n  warning: false\n  message: false\n  fig-height: 8\n  fig-width: 8\nparams:\n  slug: Bayes-Net-Bnlearn-Coffee-Tasting\n  date: 2024-11-11\n---\n\n\n![Photo by [Najib Kalil](https://unsplash.com/@nkalil?utm_content=creditCopyText&utm_medium=referral&utm_source=unsplash) on [Unsplash](https://unsplash.com/photos/coffee-drop-in-jar-BKfsCuFQ5R8?utm_content=creditCopyText&utm_medium=referral&utm_source=unsplash)](pourover.jpg){fig-alt=\"An image of a drop of coffee falling into a pourover carafe.\" fig-align=\"left\" width=\"6in\" height=\"6in\"}\n\nFor this post, I wanted to include some additional analyses to the descriptive analyses from this [video](https://www.youtube.com/watch?v=bMOOQfeloH0). Specifically, I thought this would be a good opportunity to create a bayesian network for inference. The data can be found [here](https://bit.ly/gacttCSV). There is no documentation, but each item is coded as the full question so it is easier to follow. This analysis is strictly to walk through using the bnlearn package for a fun dataset. Because the participants are subscribers to the [James Hoffmann Youtube channel](https://www.youtube.com/channel/UCMb0O2CdPBNi-QqPk5T3gsQ) that are located in the United States, the sample could be seen as representative of James' US subscribers.\n\n# Data Prep & Exploratory Data Analysis\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(inspectdf)\nlibrary(bnlearn)\nlibrary(Rgraphviz)\nlibrary(reactable)\nlibrary(ggdag)\nlibrary(dagitty)\n\nbn_score <- bnlearn::score\n\ntheme_set(theme_light())\n\ncoffee <- read_csv(here::here(\"posts/2024-11-11-bayes-net-bnlearn-us-coffee-tasting\", \"hoffmann_america_taste_data.csv\")) |>\n  janitor::clean_names()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncoffee |>\n  inspect_na() |>\n  show_plot()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-1.png){width=768}\n:::\n:::\n\n\nAfter scanning through the data, it seems like a good amount of data are missing. I decided to then drop any columns that are missing more than half of the data. You can see the difference between the two visuals showing the amount of missing data and the number of columns included.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncoffee_drop <- coffee[, which(colMeans(!is.na(coffee)) > 0.5)]\n\ncoffee_drop |>\n  inspect_na() |>\n  show_plot()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){width=768}\n:::\n:::\n\n\nBelow is the code for removing some questions that were `Check all that apply` that also had columns in the dataset that were already separated into dummy-coded variables. An example would be `where_do_you_typically_drink_coffee`, which was dropped because there were columns like `where_do_you_typically_drink_coffee_at_home` included in the dataset. I also renamed all of the columns to names that were easy to follow and not as long.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncoffee_drop <- coffee_drop |>\n  select(\n    -c(\n      where_do_you_typically_drink_coffee,\n      # how_do_you_brew_coffee_at_home,\n      do_you_usually_add_anything_to_your_coffee,\n      why_do_you_drink_coffee\n    )\n  ) |>\n  rename(\n    age = what_is_your_age,\n    cup_per_day = how_many_cups_of_coffee_do_you_typically_drink_per_day,\n    drink_at_home = where_do_you_typically_drink_coffee_at_home,\n    drink_at_office = where_do_you_typically_drink_coffee_at_the_office,\n    drink_on_go = where_do_you_typically_drink_coffee_on_the_go,\n    drink_at_cafe = where_do_you_typically_drink_coffee_at_a_cafe,\n    drink_none_of_these = where_do_you_typically_drink_coffee_none_of_these,\n    home_brew_pour_over = how_do_you_brew_coffee_at_home_pour_over,\n    home_brew_french_press = how_do_you_brew_coffee_at_home_french_press,\n    home_brew_espresso = how_do_you_brew_coffee_at_home_espresso,\n    home_brew_mr_coffee = how_do_you_brew_coffee_at_home_coffee_brewing_machine_e_g_mr_coffee,\n    home_brew_pods = how_do_you_brew_coffee_at_home_pod_capsule_machine_e_g_keurig_nespresso,\n    home_brew_instant = how_do_you_brew_coffee_at_home_instant_coffee,\n    home_brew_bean2cup = how_do_you_brew_coffee_at_home_bean_to_cup_machine,\n    home_brew_cold_brew = how_do_you_brew_coffee_at_home_cold_brew,\n    home_brew_cometeer = how_do_you_brew_coffee_at_home_coffee_extract_e_g_cometeer,\n    home_brew_other = how_do_you_brew_coffee_at_home_other,\n    favorite_coffee_drink = what_is_your_favorite_coffee_drink,\n    coffee_black = do_you_usually_add_anything_to_your_coffee_no_just_black,\n    coffee_milk_alt_creamer = do_you_usually_add_anything_to_your_coffee_milk_dairy_alternative_or_coffee_creamer,\n    coffee_sugar = do_you_usually_add_anything_to_your_coffee_sugar_or_sweetener,\n    coffee_syrup = do_you_usually_add_anything_to_your_coffee_flavor_syrup,\n    coffee_other = do_you_usually_add_anything_to_your_coffee_other,\n    coffee_characteristic_preference = before_todays_tasting_which_of_the_following_best_described_what_kind_of_coffee_you_like,\n    coffee_strength = how_strong_do_you_like_your_coffee,\n    roast_preference = what_roast_level_of_coffee_do_you_prefer,\n    caffeine_preference = how_much_caffeine_do_you_like_in_your_coffee,\n    expertise = lastly_how_would_you_rate_your_own_coffee_expertise,\n    preference_a_to_b = between_coffee_a_coffee_b_and_coffee_c_which_did_you_prefer,\n    preference_a_to_d = between_coffee_a_and_coffee_d_which_did_you_prefer,\n    favorite_abcd = lastly_what_was_your_favorite_overall_coffee,\n    remote_work = do_you_work_from_home_or_in_person,\n    money_spend_a_month = in_total_much_money_do_you_typically_spend_on_coffee_in_a_month,\n    why_drink_taste_good = why_do_you_drink_coffee_it_tastes_good,\n    why_drink_caffeine = why_do_you_drink_coffee_i_need_the_caffeine,\n    why_drink_ritual = why_do_you_drink_coffee_i_need_the_ritual,\n    why_drink_makes_bathroom = why_do_you_drink_coffee_it_makes_me_go_to_the_bathroom,\n    why_drink_other = why_do_you_drink_coffee_other,\n    like_taste = do_you_like_the_taste_of_coffee,\n    know_where_coffee_comes_from = do_you_know_where_your_coffee_comes_from,\n    most_spent_on_cup_coffee = what_is_the_most_youve_ever_paid_for_a_cup_of_coffee,\n    willing_to_spend_cup_coffee = what_is_the_most_youd_ever_be_willing_to_pay_for_a_cup_of_coffee,\n    good_value_cafe = do_you_feel_like_you_re_getting_good_value_for_your_money_when_you_buy_coffee_at_a_cafe,\n    equipment_spent_5years = approximately_how_much_have_you_spent_on_coffee_equipment_in_the_past_5_years,\n    good_value_equipment = do_you_feel_like_you_re_getting_good_value_for_your_money_with_regards_to_your_coffee_equipment\n  )\n```\n:::\n\n\nFinally, I decided to drop rows with NA from logical type columns. Once cleaning was done, the variables I was interested in had little to no missing data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncoffee_logical <- coffee_drop |>\n  select_if(is.logical)\n\ncoffee_drop <- coffee_drop |>\n  drop_na(\n    colnames(coffee_logical)\n  )\n\ncoffee_drop <- coffee_drop |>\n  mutate(\n    across(\n      where(\n        is.logical\n      ),\n      ~case_when(\n        .x == TRUE ~ 1,\n        .x == FALSE ~ 0\n      )\n    ),\n    across(\n      where(\n        is.character\n      ),\n      ~as.factor(.x)\n    )\n  )\n\ncoffee_drop <- coffee_drop |>\n  select(\n    -matches(\n      \"_notes\"\n    )\n  )\n\ncoffee_drop |>\n  inspect_na() |>\n  show_plot()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=768}\n:::\n:::\n\n\n## Coffee Preference Counts\n\nThe target variable of interest was participants' favorite coffee out of the four samples that were provided in their testing kits. As stated in the linked video, Coffee D was the chosen as participants' favorite coffee more than the other three options.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncoffee_drop |>\n  drop_na(favorite_abcd) |>\n  ggplot(\n    aes(\n      favorite_abcd\n    )\n  ) +\n  geom_bar(\n    aes(\n      fill = favorite_abcd\n    )\n  ) +\n  viridis::scale_fill_viridis(\n    discrete = TRUE\n  ) +\n  labs(\n    x = \"Coffee Choices\",\n    y = \"Counts\",\n    title = \"Counts of Each Coffee\"\n  ) +\n  theme(\n    legend.position = \"none\"\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=768}\n:::\n:::\n\n\n## Coffee Preference by Age Group\n\nThis next visual shows the preference for each of the four coffees based on age brackets. We can see that the number of participants that rated coffee D as a 5 is highest for the 26-34 age bracket. Some basic descriptive statistics are provided in the following table. Tables can be filtered by typing in values in the box under the variable name. You can also click on the variable name and it will sort the values. Clicking the value again will sort in the opposite direction.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncoffee_drop |>\n  select(\n    age,\n    matches(\n      \"personal_pref\"\n    )\n  ) |>\n  pivot_longer(\n    -age\n  ) |>\n  group_by(\n    age,\n    name\n  ) |>\n  count(\n    value\n    ) |>\n  mutate(\n    value = as.factor(value),\n    age = as.factor(age),\n    age = fct_relevel(\n      age,\n      \"<18 years old\",\n      \"18-24 years old\",\n      \"25-34 years old\",\n      \"35-44 years old\",\n      \"45-54 years old\",\n      \"55-64 years old\",\n      \">65 years old\"\n    ),\n    name = case_when(\n      name == \"coffee_a_personal_preference\" ~ \"Coffee A Preference\",\n      name == \"coffee_b_personal_preference\" ~ \"Coffee B Preference\",\n      name == \"coffee_c_personal_preference\" ~ \"Coffee C Preference\",\n      name == \"coffee_d_personal_preference\" ~ \"Coffee D Preference\"\n    )\n  ) |> \n  drop_na() |>\n  ggplot(\n    aes(\n      age,\n      n\n    )\n  ) +\n  geom_col(\n    position = position_dodge(),\n    aes(\n      fill = value\n    )\n  ) +\n  facet_wrap(\n    ~name\n  ) +\n  viridis::scale_fill_viridis(\n    discrete = TRUE\n    ) +\n  labs(\n    x = \"\",\n    y = \"Counts\",\n    fill = \"Rating\"\n  ) +\n  theme(\n    legend.position = \"top\",\n    strip.background = element_rect(\n      fill = \"white\"\n      ),\n    strip.text = element_text(\n      color = \"black\"\n    ),\n    axis.text.x = element_text(\n      angle = 45,\n      vjust = 0.5\n      )\n    ) +\n  NULL\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){width=768}\n:::\n\n```{.r .cell-code}\ncoffee_drop |>\n  select(\n    age,\n    matches(\n      \"personal_pref\"\n    )\n  ) |>\n  pivot_longer(\n    -age\n  ) |>\n  group_by(\n    age,\n    name\n  ) |>\n  summarize(\n    across(\n      value,\n      list(\n        mean = ~mean(.x, na.rm = TRUE),\n        median = ~median(.x, na.rm = TRUE)\n      )\n    ),\n    .groups = \"drop\"\n  ) |>\n  arrange(\n    name\n  ) |>\n  reactable(\n    filterable = TRUE,\n    searchable = TRUE\n  )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"reactable html-widget html-fill-item\" id=\"htmlwidget-50d9694237abc7e054a6\" style=\"width:auto;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-50d9694237abc7e054a6\">{\"x\":{\"tag\":{\"name\":\"Reactable\",\"attribs\":{\"data\":{\"age\":[\"<18 years old\",\">65 years old\",\"18-24 years old\",\"25-34 years old\",\"35-44 years old\",\"45-54 years old\",\"55-64 years old\",\"<18 years old\",\">65 years old\",\"18-24 years old\",\"25-34 years old\",\"35-44 years old\",\"45-54 years old\",\"55-64 years old\",\"<18 years old\",\">65 years old\",\"18-24 years old\",\"25-34 years old\",\"35-44 years old\",\"45-54 years old\",\"55-64 years old\",\"<18 years old\",\">65 years old\",\"18-24 years old\",\"25-34 years old\",\"35-44 years old\",\"45-54 years old\",\"55-64 years old\"],\"name\":[\"coffee_a_personal_preference\",\"coffee_a_personal_preference\",\"coffee_a_personal_preference\",\"coffee_a_personal_preference\",\"coffee_a_personal_preference\",\"coffee_a_personal_preference\",\"coffee_a_personal_preference\",\"coffee_b_personal_preference\",\"coffee_b_personal_preference\",\"coffee_b_personal_preference\",\"coffee_b_personal_preference\",\"coffee_b_personal_preference\",\"coffee_b_personal_preference\",\"coffee_b_personal_preference\",\"coffee_c_personal_preference\",\"coffee_c_personal_preference\",\"coffee_c_personal_preference\",\"coffee_c_personal_preference\",\"coffee_c_personal_preference\",\"coffee_c_personal_preference\",\"coffee_c_personal_preference\",\"coffee_d_personal_preference\",\"coffee_d_personal_preference\",\"coffee_d_personal_preference\",\"coffee_d_personal_preference\",\"coffee_d_personal_preference\",\"coffee_d_personal_preference\",\"coffee_d_personal_preference\"],\"value_mean\":[3.25,3.27692307692308,3.24347826086957,3.41364734299517,3.33251231527094,3.1491935483871,2.94117647058824,2.75,3.24615384615385,3.20579710144928,2.98491249245625,3.05911330049261,3.25,3.29411764705882,3.08333333333333,3.21875,3.10144927536232,2.99095295536791,3.0923645320197,3.15725806451613,3.35294117647059,3.25,2.32307692307692,3.38550724637681,3.61654589371981,3.43103448275862,2.94758064516129,2.45751633986928],\"value_median\":[4,3,3,4,4,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,2,4,4,4,3,2]},\"columns\":[{\"id\":\"age\",\"name\":\"age\",\"type\":\"factor\"},{\"id\":\"name\",\"name\":\"name\",\"type\":\"character\"},{\"id\":\"value_mean\",\"name\":\"value_mean\",\"type\":\"numeric\"},{\"id\":\"value_median\",\"name\":\"value_median\",\"type\":\"numeric\"}],\"filterable\":true,\"searchable\":true,\"dataKey\":\"b245c793cf2bf144c610d6f50f7af374\"},\"children\":[]},\"class\":\"reactR_markup\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n## Coffee Preference by Gender\n\nWhen looking at the coffee preferences of different genders, males rated coffees A and D highly. It seems visually that Coffees A, B, and C are higher rated than than Coffee D. The other genders did not have a lot of data, so I also decided to get some basic descriptive statistics for each group. You can look further into the data by filtering by name (A, B, C, D) and by gender.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncoffee_drop |>\n  select(\n    gender,\n    matches(\n      \"personal_pref\"\n    )\n  ) |>\n  pivot_longer(\n    -gender\n  ) |>\n  group_by(\n    gender,\n    name\n  ) |>\n  count(\n    value\n    ) |>\n  mutate(\n    value = as.factor(value),\n    gender = as.factor(gender),\n    name = as.factor(name),\n    gender = fct_relevel(\n      gender,\n      \"Male\",\n      \"Female\",\n      \"Non-binary\",\n      \"Other (please specify)\",\n      \"Prefer not to say\"\n    ),\n    name = case_when(\n      name == \"coffee_a_personal_preference\" ~ \"Coffee A Preference\",\n      name == \"coffee_b_personal_preference\" ~ \"Coffee B Preference\",\n      name == \"coffee_c_personal_preference\" ~ \"Coffee C Preference\",\n      name == \"coffee_d_personal_preference\" ~ \"Coffee D Preference\"\n    )\n  ) |> \n  drop_na() |>\n  ggplot(\n    aes(\n      gender,\n      n\n    )\n  ) +\n  geom_col(\n    position = position_dodge(),\n    aes(\n      fill = value\n    )\n  ) +\n  facet_wrap(\n    ~name\n  ) +\n  viridis::scale_fill_viridis(\n    discrete = TRUE\n    ) +\n  labs(\n    x = \"\",\n    y = \"Counts\",\n    fill = \"Rating\"\n  ) +\n  theme(\n    legend.position = \"top\",\n    strip.background = element_rect(\n      fill = \"white\"\n      ),\n    strip.text = element_text(\n      color = \"black\"\n    )\n    ) +\n  NULL\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-1.png){width=768}\n:::\n\n```{.r .cell-code}\ncoffee_drop |>\n  select(\n    gender,\n    matches(\n      \"personal_pref\"\n    )\n  ) |>\n  pivot_longer(\n    -gender\n  ) |>\n  group_by(\n    gender,\n    name\n  ) |>\n  summarize(\n    across(\n      value,\n      list(\n        mean = ~mean(.x, na.rm = TRUE),\n        median = ~median(.x, na.rm = TRUE)\n      )\n    ),\n    .groups = \"drop\"\n  ) |>\n  arrange(\n    name\n  ) |>\n  mutate(\n    name = case_when(\n      name == \"coffee_a_personal_preference\" ~ \"Coffee A Preference\",\n      name == \"coffee_b_personal_preference\" ~ \"Coffee B Preference\",\n      name == \"coffee_c_personal_preference\" ~ \"Coffee C Preference\",\n      name == \"coffee_d_personal_preference\" ~ \"Coffee D Preference\"\n    )\n  ) |>\n  reactable(\n    filterable = TRUE,\n    searchable = TRUE\n  )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"reactable html-widget html-fill-item\" id=\"htmlwidget-ea0ef48e1ae262a428f4\" style=\"width:auto;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-ea0ef48e1ae262a428f4\">{\"x\":{\"tag\":{\"name\":\"Reactable\",\"attribs\":{\"data\":{\"gender\":[\"Female\",\"Male\",\"Non-binary\",\"Other (please specify)\",\"Prefer not to say\",null,\"Female\",\"Male\",\"Non-binary\",\"Other (please specify)\",\"Prefer not to say\",null,\"Female\",\"Male\",\"Non-binary\",\"Other (please specify)\",\"Prefer not to say\",null,\"Female\",\"Male\",\"Non-binary\",\"Other (please specify)\",\"Prefer not to say\",null],\"name\":[\"Coffee A Preference\",\"Coffee A Preference\",\"Coffee A Preference\",\"Coffee A Preference\",\"Coffee A Preference\",\"Coffee A Preference\",\"Coffee B Preference\",\"Coffee B Preference\",\"Coffee B Preference\",\"Coffee B Preference\",\"Coffee B Preference\",\"Coffee B Preference\",\"Coffee C Preference\",\"Coffee C Preference\",\"Coffee C Preference\",\"Coffee C Preference\",\"Coffee C Preference\",\"Coffee C Preference\",\"Coffee D Preference\",\"Coffee D Preference\",\"Coffee D Preference\",\"Coffee D Preference\",\"Coffee D Preference\",\"Coffee D Preference\"],\"value_mean\":[3.0796812749004,3.42062818336163,3.20833333333333,3.11111111111111,3.2,3.21276595744681,3.23107569721116,3.02504244482173,2.91666666666667,2.66666666666667,3.12903225806452,2.74468085106383,3.20185922974768,3.01612903225806,3.01041666666667,2.66666666666667,3,3.31914893617021,2.81673306772908,3.59108280254777,3.72916666666667,3.77777777777778,3.48387096774194,3.4468085106383],\"value_median\":[3,4,3,3,3,3,3,3,3,2,3,3,3,3,3,3,3,3,3,4,4,4,4,3]},\"columns\":[{\"id\":\"gender\",\"name\":\"gender\",\"type\":\"factor\"},{\"id\":\"name\",\"name\":\"name\",\"type\":\"character\"},{\"id\":\"value_mean\",\"name\":\"value_mean\",\"type\":\"numeric\"},{\"id\":\"value_median\",\"name\":\"value_median\",\"type\":\"numeric\"}],\"filterable\":true,\"searchable\":true,\"dataKey\":\"030e7f576d5f94de6875f7f6b7b4bc83\"},\"children\":[]},\"class\":\"reactR_markup\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\nIn addition to the table, I also included a plot for participants that identified as Non-binary, Other, or preferred not to say.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncoffee_drop |>\n  select(\n    gender,\n    matches(\n      \"personal_pref\"\n    )\n  ) |>\n  pivot_longer(\n    -gender\n  ) |>\n  group_by(\n    gender,\n    name\n  ) |>\n  count(\n    value\n    ) |>\n  mutate(\n    value = as.factor(value),\n    gender = as.factor(gender),\n    name = as.factor(name),\n    gender = fct_relevel(\n      gender,\n      \"Male\",\n      \"Female\",\n      \"Non-binary\",\n      \"Other (please specify)\",\n      \"Prefer not to say\"\n    ),\n    name = case_when(\n      name == \"coffee_a_personal_preference\" ~ \"Coffee A Preference\",\n      name == \"coffee_b_personal_preference\" ~ \"Coffee B Preference\",\n      name == \"coffee_c_personal_preference\" ~ \"Coffee C Preference\",\n      name == \"coffee_d_personal_preference\" ~ \"Coffee D Preference\"\n    )\n  ) |> \n  drop_na() |>\n  filter(\n    !gender %in% c(\"Male\", \"Female\")\n  ) |>\n  ggplot(\n    aes(\n      gender,\n      n\n    )\n  ) +\n  geom_col(\n    position = position_dodge(),\n    aes(\n      fill = value\n    )\n  ) +\n  facet_wrap(\n    ~name\n  ) +\n  viridis::scale_fill_viridis(\n    discrete = TRUE\n    ) +\n  labs(\n    x = \"\",\n    y = \"Counts\",\n    fill = \"Rating\"\n  ) +\n  theme(\n    legend.position = \"top\",\n    strip.background = element_rect(\n      fill = \"white\"\n      ),\n    strip.text = element_text(\n      color = \"black\"\n    )\n    ) +\n  NULL\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-9-1.png){width=768}\n:::\n:::\n\n\n## Coffee Preference by Expertise\n\nThis visual is similar to that from the video. I just included some colors to make the coffee preferences stand out a little more.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncoffee_drop |>\n  group_by(\n    favorite_abcd,\n    expertise\n  ) |>\n  count() |> \n  ungroup(\n    favorite_abcd\n    ) |>\n  mutate(\n    percent = n/sum(n),\n    percent = percent*100\n  ) |>\n  drop_na() |>\n  ggplot(\n    aes(\n      as.factor(expertise),\n      percent\n    )\n  ) +\n  geom_col(\n    aes(\n      fill = as.factor(favorite_abcd)\n    )\n  ) +\n  viridis::scale_fill_viridis(\n    discrete = TRUE\n  ) +\n  labs(\n    title = \"Favorite Coffees By Self-Defined Expertise\",\n    x = \"Expertise\",\n    y = \"Percentage\",\n    fill = \"\"\n  ) +\n  NULL\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-10-1.png){width=768}\n:::\n:::\n\n\n# Visualizing the Directed Acyclic Graph (DAG)\n\nNow for the [Bayesian Network](https://www.bayesserver.com/docs/introduction/bayesian-networks/)model. The code below shows the relationships that were modeled. These relationships were somewhat based on the video's content and what I thought would make sense to see what participants' favorite coffee was. While there are better methods for choosing the relationships modeled, this is a fun analysis for some fun data so I kept it simple.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel_dag <- dagitty('\ndag {\n\"Age Range\" [pos=\"-0.853,-0.673\"]\n\"Coffee Roast Preference (Light, Med, Dark)\" [pos=\"-0.807,-0.117\"]\n\"Cups of Coffee Per Day (1 or less, 2, 3 or more)\" [pos=\"-0.610,-0.398\"]\n\"Expertise Level (1-10)\" [pos=\"-1.132,-0.122\"]\n\"Favorite Coffee (A, B, C, D)\" [outcome,pos=\"-0.952,0.060\"]\n\"Favorite Coffee Drink(Pourover, Espresso, etc.)\" [pos=\"-0.990,-0.400\"]\n\"Type of Brewer at Home (Pourover, Espresso,\" [pos=\"-1.370,-0.401\"]\nGender [pos=\"-1.208,-0.672\"]\n\"Age Range\" -> \"Cups of Coffee Per Day (1 or less, 2, 3 or more)\"\n\"Age Range\" -> \"Favorite Coffee Drink(Pourover, Espresso, etc.)\"\n\"Age Range\" -> \"Type of Brewer at Home (Pourover, Espresso,\"\n\"Coffee Roast Preference (Light, Med, Dark)\" -> \"Expertise Level (1-10)\"\n\"Coffee Roast Preference (Light, Med, Dark)\" -> \"Favorite Coffee (A, B, C, D)\"\n\"Cups of Coffee Per Day (1 or less, 2, 3 or more)\" -> \"Coffee Roast Preference (Light, Med, Dark)\"\n\"Expertise Level (1-10)\" -> \"Favorite Coffee (A, B, C, D)\"\n\"Favorite Coffee Drink(Pourover, Espresso, etc.)\" -> \"Coffee Roast Preference (Light, Med, Dark)\"\n\"Favorite Coffee Drink(Pourover, Espresso, etc.)\" -> \"Cups of Coffee Per Day (1 or less, 2, 3 or more)\"\n\"Type of Brewer at Home (Pourover, Espresso,\" -> \"Coffee Roast Preference (Light, Med, Dark)\"\n\"Type of Brewer at Home (Pourover, Espresso,\" -> \"Favorite Coffee Drink(Pourover, Espresso, etc.)\"\nGender -> \"Favorite Coffee Drink(Pourover, Espresso, etc.)\"\nGender -> \"Type of Brewer at Home (Pourover, Espresso,\"\n}\n\n')\n\nggdag(model_dag) + \n  geom_dag_point(\n    color = \"gray70\"\n    ) +\n  geom_dag_edges(\n    edge_color = \"dodgerblue\"\n    ) +\n  geom_dag_text(\n    color = \"black\",\n    nudge_y = -.02\n    ) +\n  theme_dag()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-11-1.png){width=1152}\n:::\n:::\n\n\n# Variables Chosen For Modeling & Dropping NAs\n\nBelow is a loop of the variables chosen for the model that was visualized above. To keep things simple I dropped NA values and wanted to see quick distributions of each variable's levels.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npurrr::map2(\n  coffee_drop |>\n  select(\n    gender,\n    age,\n    cup_per_day,\n    favorite_coffee_drink,\n    home_brew_pour_over,\n    home_brew_french_press,\n    home_brew_espresso,\n    home_brew_mr_coffee,\n    home_brew_pods,\n    home_brew_instant,\n    home_brew_bean2cup,\n    home_brew_cold_brew,\n    home_brew_cometeer,\n    home_brew_other,\n    roast_preference,\n    expertise,\n    favorite_abcd\n  ) |> \n  drop_na(),\n  names(coffee_drop |>\n  select(\n    gender,\n    age,\n    cup_per_day,\n    favorite_coffee_drink,\n    home_brew_pour_over,\n    home_brew_french_press,\n    home_brew_espresso,\n    home_brew_mr_coffee,\n    home_brew_pods,\n    home_brew_instant,\n    home_brew_bean2cup,\n    home_brew_cold_brew,\n    home_brew_cometeer,\n    home_brew_other,\n    roast_preference,\n    expertise,\n    favorite_abcd\n  ) |> \n  drop_na()\n  ),\n  ~ggplot(\n    coffee_drop |>\n  select(\n    gender,\n    age,\n    cup_per_day,\n    favorite_coffee_drink,\n    home_brew_pour_over,\n    home_brew_french_press,\n    home_brew_espresso,\n    home_brew_mr_coffee,\n    home_brew_pods,\n    home_brew_instant,\n    home_brew_bean2cup,\n    home_brew_cold_brew,\n    home_brew_cometeer,\n    home_brew_other,\n    roast_preference,\n    expertise,\n    favorite_abcd\n  ) |> \n  drop_na(),\n  aes(.x)\n  ) + \n  geom_bar(\n    fill = \"dodgerblue\"\n  ) +\n  coord_flip() +\n  labs(\n    title = glue::glue(\"{.y}\")\n  )\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$gender\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-12-1.png){width=768}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n$age\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-12-2.png){width=768}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n$cup_per_day\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-12-3.png){width=768}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n$favorite_coffee_drink\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-12-4.png){width=768}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n$home_brew_pour_over\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-12-5.png){width=768}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n$home_brew_french_press\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-12-6.png){width=768}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n$home_brew_espresso\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-12-7.png){width=768}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n$home_brew_mr_coffee\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-12-8.png){width=768}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n$home_brew_pods\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-12-9.png){width=768}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n$home_brew_instant\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-12-10.png){width=768}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n$home_brew_bean2cup\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-12-11.png){width=768}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n$home_brew_cold_brew\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-12-12.png){width=768}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n$home_brew_cometeer\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-12-13.png){width=768}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n$home_brew_other\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-12-14.png){width=768}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n$roast_preference\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-12-15.png){width=768}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n$expertise\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-12-16.png){width=768}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n$favorite_abcd\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-12-17.png){width=768}\n:::\n:::\n\n\nBased on the visuals, I decided to combine levels for some variables.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnona <- \n  coffee_drop |>\n  select(\n    submission_id,\n    gender,\n    age,\n    cup_per_day,\n    home_brew_pour_over,\n    home_brew_french_press,\n    home_brew_espresso,\n    home_brew_mr_coffee,\n    home_brew_pods,\n    home_brew_instant,\n    home_brew_bean2cup,\n    home_brew_cold_brew,\n    home_brew_cometeer,\n    home_brew_other,\n    favorite_coffee_drink,\n    roast_preference,\n    expertise,\n    favorite_abcd\n  ) |>\n  drop_na() |>\n  mutate(\n    gender = case_when(\n      gender == \"Female\" ~ \"Female\",\n      gender == \"Male\" ~ \"Male\",\n      TRUE ~ \"Other\"\n    ),\n    age = case_when(\n      age == \"<18 years old\" ~ \"under24\",\n      age == \"18-24 years old\" ~ \"under24\",\n      age == \"45-54 years old\" ~ \"over44\",\n      age == \"55-64 years old\" ~ \"over44\",\n      age == \">65 years old\" ~ \"over44\",\n      TRUE ~ age\n    ),\n    cup_per_day = case_when(\n      cup_per_day == \"More than 4\" ~ \"three_or_more\",\n      cup_per_day == \"4\" ~ \"three_or_more\",\n      cup_per_day == \"3\" ~ \"three_or_more\",\n      cup_per_day == \"Less than 1\" ~ \"one_or_less\",\n      cup_per_day == \"1\" ~ \"one_or_less\",\n      TRUE ~ cup_per_day\n    ),\n    favorite_coffee_drink = case_when(\n      favorite_coffee_drink == \"Regular drip coffee\" ~ \"drip\",\n      favorite_coffee_drink == \"Pourover\" ~ \"pourover\",\n      favorite_coffee_drink == \"Other\" ~ \"other\",\n      favorite_coffee_drink == \"Mocha\" ~ \"other\",\n      favorite_coffee_drink == \"Latte\" ~ \"latte\",\n      favorite_coffee_drink == \"Iced coffee\" ~ \"other\",\n      favorite_coffee_drink == \"Espresso\" ~ \"espresso\",\n      favorite_coffee_drink == \"Cortado\" ~ \"cortado\",\n      favorite_coffee_drink == \"Cold brew\" ~ \"other\",\n      favorite_coffee_drink == \"Cappuccino\" ~ \"cappuccino\",\n      favorite_coffee_drink == \"Blended drink (e.g. Frappuccino)\" ~ \"other\",\n      favorite_coffee_drink == \"Americano\" ~ \"americano\"\n    ),\n    roast_preference = case_when(\n      roast_preference == \"Nordic\" ~ \"light\",\n      roast_preference == \"Medium\" ~ \"medium\",\n      roast_preference == \"Light\" ~ \"light\",\n      roast_preference == \"Italian\" ~ \"dark\",\n      roast_preference == \"French\" ~ \"dark\",\n      roast_preference == \"Dark\" ~ \"dark\",\n      roast_preference == \"Blonde\" ~ \"light\",\n    )\n  )\n\nid <- nona$submission_id\n\nnona <- nona |>\n  select(\n    -submission_id\n  )\n\nnona_allcat <- nona  \n```\n:::\n\n\n# Changing to Factor Types for Bnlearn\n\n\n::: {.cell}\n\n```{.r .cell-code}\nno_fact <- nona |>\n  mutate(\n    across(\n      everything(),\n      ~as.factor(.x)\n    )\n  )\n\n# glimpse(no_fact)\n# class(no_fact)\n\nno_fact <- as.data.frame(no_fact)\n```\n:::\n\n\n# Bayesian Network\n\n## Using Bnlearn\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Building Bayesian Network\ndag <- empty.graph(nodes = colnames(no_fact))\n\narcs <- matrix(\n  c(\"gender\", \"cup_per_day\",\n    \"gender\", \"favorite_coffee_drink\",\n    \"gender\", \"home_brew_pour_over\",\n    \"gender\", \"home_brew_french_press\",\n    \"gender\", \"home_brew_espresso\",\n    \"gender\", \"home_brew_mr_coffee\",\n    \"gender\", \"home_brew_pods\",\n    \"gender\", \"home_brew_instant\",\n    \"gender\", \"home_brew_bean2cup\",\n    \"gender\", \"home_brew_cold_brew\",\n    \"gender\", \"home_brew_cometeer\",\n    \"gender\", \"home_brew_other\",\n    \"age\", \"cup_per_day\",\n    \"age\", \"favorite_coffee_drink\",\n    \"age\", \"home_brew_pour_over\",\n    \"age\", \"home_brew_french_press\",\n    \"age\", \"home_brew_espresso\",\n    \"age\", \"home_brew_mr_coffee\",\n    \"age\", \"home_brew_pods\",\n    \"age\", \"home_brew_instant\",\n    \"age\", \"home_brew_bean2cup\",\n    \"age\", \"home_brew_cold_brew\",\n    \"age\", \"home_brew_cometeer\",\n    \"age\", \"home_brew_other\",\n\n    \"cup_per_day\", \"roast_preference\",\n    \"favorite_coffee_drink\", \"roast_preference\",\n    \"home_brew_pour_over\", \"roast_preference\",\n    \"home_brew_french_press\", \"roast_preference\",\n    \"home_brew_espresso\", \"roast_preference\",\n    \"home_brew_mr_coffee\", \"roast_preference\",\n    \"home_brew_pods\", \"roast_preference\",\n    \"home_brew_instant\", \"roast_preference\",\n    \"home_brew_bean2cup\", \"roast_preference\",\n    \"home_brew_cold_brew\", \"roast_preference\",\n    \"home_brew_cometeer\", \"roast_preference\",\n    \"home_brew_other\", \"roast_preference\",\n\n    \"roast_preference\", \"expertise\",\n    \"roast_preference\", \"favorite_abcd\",\n    \"expertise\", \"favorite_abcd\"),\n  byrow = TRUE,\n  ncol = 2,\n  dimnames = list(NULL, c(\"from\", \"to\"))\n)\n\narcs(dag) <- arcs\n\n# graphviz.plot(dag)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(12345)\ndag_fit <- bn.fit(dag, data = no_fact, method = \"bayes\", iss = 5)\n```\n:::\n\n\n### Gender - Conditional Probability Table (CPT)\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntibble(\n  Gender = attributes(dag_fit$gender$prob)$dimnames[[1]],\n  Probability = round(array(dag_fit$gender$prob), 2)\n) |>\n  reactable()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"reactable html-widget html-fill-item\" id=\"htmlwidget-ead145e30063f1b2d1a3\" style=\"width:auto;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-ead145e30063f1b2d1a3\">{\"x\":{\"tag\":{\"name\":\"Reactable\",\"attribs\":{\"data\":{\"Gender\":[\"Female\",\"Male\",\"Other\"],\"Probability\":[0.23,0.73,0.04]},\"columns\":[{\"id\":\"Gender\",\"name\":\"Gender\",\"type\":\"character\"},{\"id\":\"Probability\",\"name\":\"Probability\",\"type\":\"numeric\"}],\"dataKey\":\"f061ea2040f57be9718860b6bf75a4dc\"},\"children\":[]},\"class\":\"reactR_markup\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n### Age - CPT\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntibble(\n  Age = attributes(dag_fit$age$prob)$dimnames[[1]],\n  Probability = round(array(dag_fit$age$prob), 2)\n) |>\n  reactable()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"reactable html-widget html-fill-item\" id=\"htmlwidget-0c28877da762cc53054d\" style=\"width:auto;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-0c28877da762cc53054d\">{\"x\":{\"tag\":{\"name\":\"Reactable\",\"attribs\":{\"data\":{\"Age\":[\"25-34 years old\",\"35-44 years old\",\"over44\",\"under24\"],\"Probability\":[0.5,0.24,0.14,0.11]},\"columns\":[{\"id\":\"Age\",\"name\":\"Age\",\"type\":\"character\"},{\"id\":\"Probability\",\"name\":\"Probability\",\"type\":\"numeric\"}],\"dataKey\":\"ba273c252518b3e7bb9274cff7b3a4c6\"},\"children\":[]},\"class\":\"reactR_markup\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n### Cups of Coffee Per Day - CPT\n\n\n::: {.cell}\n\n:::\n\n\nBelow are the conditional probabilities for cups of coffee per day based on genders and age ranges.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndag_fit$cup_per_day$prob |>\n  as_tibble() |>\n  mutate(\n    n = round(n, 2)\n  ) |>\n  gg_func(x = cup_per_day, y = n, fill = gender, facet = age) +\n  labs(\n    title = \"Probability of Cups of Coffee Per Day From the Great American Tasting\",\n    subtitle = \"Based on Gender and Age Range\",\n    x = \"\",\n    y = \"Probability\",\n    fill = \"\"\n  ) +\n  theme(\n    legend.position = \"bottom\"\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-20-1.png){width=768}\n:::\n\n```{.r .cell-code}\ndag_fit$cup_per_day$prob |>\n  as_tibble() |>\n  reactable(\n    filterable = TRUE,\n    searchable = TRUE\n  )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"reactable html-widget html-fill-item\" id=\"htmlwidget-36430fc38ec60452bb6d\" style=\"width:auto;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-36430fc38ec60452bb6d\">{\"x\":{\"tag\":{\"name\":\"Reactable\",\"attribs\":{\"data\":{\"cup_per_day\":[\"2\",\"one_or_less\",\"three_or_more\",\"2\",\"one_or_less\",\"three_or_more\",\"2\",\"one_or_less\",\"three_or_more\",\"2\",\"one_or_less\",\"three_or_more\",\"2\",\"one_or_less\",\"three_or_more\",\"2\",\"one_or_less\",\"three_or_more\",\"2\",\"one_or_less\",\"three_or_more\",\"2\",\"one_or_less\",\"three_or_more\",\"2\",\"one_or_less\",\"three_or_more\",\"2\",\"one_or_less\",\"three_or_more\",\"2\",\"one_or_less\",\"three_or_more\",\"2\",\"one_or_less\",\"three_or_more\"],\"gender\":[\"Female\",\"Female\",\"Female\",\"Male\",\"Male\",\"Male\",\"Other\",\"Other\",\"Other\",\"Female\",\"Female\",\"Female\",\"Male\",\"Male\",\"Male\",\"Other\",\"Other\",\"Other\",\"Female\",\"Female\",\"Female\",\"Male\",\"Male\",\"Male\",\"Other\",\"Other\",\"Other\",\"Female\",\"Female\",\"Female\",\"Male\",\"Male\",\"Male\",\"Other\",\"Other\",\"Other\"],\"age\":[\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"over44\",\"over44\",\"over44\",\"over44\",\"over44\",\"over44\",\"over44\",\"over44\",\"over44\",\"under24\",\"under24\",\"under24\",\"under24\",\"under24\",\"under24\",\"under24\",\"under24\",\"under24\"],\"n\":[0.361078998073218,0.574720616570328,0.0642003853564547,0.465730245926338,0.363929258512389,0.170340495561273,0.48072330262709,0.468440805185943,0.0508358921869669,0.337008115143163,0.568519369162456,0.0944725156943807,0.494747849232378,0.284281572318076,0.220970578449546,0.479229989868288,0.296859169199595,0.223910840932118,0.407690905777292,0.414251868051759,0.17805722617095,0.43839277485946,0.226062114090867,0.335545111049673,0.333333333333333,0.489177489177489,0.177489177489177,0.28367816091954,0.680919540229885,0.0354022988505747,0.417454028243422,0.465000507975211,0.117545463781367,0.184634448574969,0.71995043370508,0.0954151177199504]},\"columns\":[{\"id\":\"cup_per_day\",\"name\":\"cup_per_day\",\"type\":\"character\"},{\"id\":\"gender\",\"name\":\"gender\",\"type\":\"character\"},{\"id\":\"age\",\"name\":\"age\",\"type\":\"character\"},{\"id\":\"n\",\"name\":\"n\",\"type\":\"numeric\"}],\"filterable\":true,\"searchable\":true,\"dataKey\":\"afdd110682a9e97fdce324d4be5301a1\"},\"children\":[]},\"class\":\"reactR_markup\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n### Home Brewing - Pourover\n\nFor all of the following home brewing probability tables, the visuals will be based on genders and age ranges.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndag_fit$home_brew_pour_over$prob |>\n  as_tibble() |>\n  mutate(\n    n = round(n, 2)\n  ) |>\n  gg_func(x = gender, y = n, fill = home_brew_pour_over, facet = age) +\n  labs(\n    title = \"Probability of Making Pourover at Home From the Great American Tasting\",\n    subtitle = \"Based on Gender and Age Range\",\n    x = \"\",\n    y = \"Probability\",\n    fill = \"\"\n  ) +\n  theme(\n    legend.position = \"bottom\"\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-21-1.png){width=768}\n:::\n\n```{.r .cell-code}\ndag_fit$home_brew_pour_over$prob |>\n  as_tibble() |>\n  reactable(\n    filterable = TRUE,\n    searchable = TRUE\n  )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"reactable html-widget html-fill-item\" id=\"htmlwidget-e5d25f664ea3c8f9d6fe\" style=\"width:auto;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-e5d25f664ea3c8f9d6fe\">{\"x\":{\"tag\":{\"name\":\"Reactable\",\"attribs\":{\"data\":{\"home_brew_pour_over\":[\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\"],\"gender\":[\"Female\",\"Female\",\"Male\",\"Male\",\"Other\",\"Other\",\"Female\",\"Female\",\"Male\",\"Male\",\"Other\",\"Other\",\"Female\",\"Female\",\"Male\",\"Male\",\"Other\",\"Other\",\"Female\",\"Female\",\"Male\",\"Male\",\"Other\",\"Other\"],\"age\":[\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"over44\",\"over44\",\"over44\",\"over44\",\"over44\",\"over44\",\"under24\",\"under24\",\"under24\",\"under24\",\"under24\",\"under24\"],\"n\":[0.458381502890173,0.541618497109827,0.270530561157082,0.729469438842918,0.285056294779939,0.714943705220061,0.607487367937529,0.392512632062471,0.311778126336803,0.688221873663197,0.445288753799392,0.554711246200608,0.591853471842537,0.408146528157463,0.451893834669616,0.548106165330384,0.5,0.5,0.5,0.5,0.337244742456568,0.662755257543432,0.5,0.5]},\"columns\":[{\"id\":\"home_brew_pour_over\",\"name\":\"home_brew_pour_over\",\"type\":\"character\"},{\"id\":\"gender\",\"name\":\"gender\",\"type\":\"character\"},{\"id\":\"age\",\"name\":\"age\",\"type\":\"character\"},{\"id\":\"n\",\"name\":\"n\",\"type\":\"numeric\"}],\"filterable\":true,\"searchable\":true,\"dataKey\":\"396a23b299d3e16cffb37aeabaef930f\"},\"children\":[]},\"class\":\"reactR_markup\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n### Home Brewing - French Press\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndag_fit$home_brew_french_press$prob |>\n  as_tibble() |>\n  mutate(\n    n = round(n, 2)\n  ) |>\n  gg_func(x = gender, y = n, fill = home_brew_french_press, facet = age) +\n  labs(\n    title = \"Probability of Making French Press at Home From the Great American Tasting\",\n    subtitle = \"Based on Gender and Age Range\",\n    x = \"\",\n    y = \"Probability\",\n    fill = \"\"\n  ) +\n  theme(\n    legend.position = \"bottom\"\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-22-1.png){width=768}\n:::\n\n```{.r .cell-code}\ndag_fit$home_brew_french_press$prob |>\nas_tibble() |>\n  reactable(\n    filterable = TRUE,\n    searchable = TRUE\n  )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"reactable html-widget html-fill-item\" id=\"htmlwidget-022c5f4be455498a3808\" style=\"width:auto;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-022c5f4be455498a3808\">{\"x\":{\"tag\":{\"name\":\"Reactable\",\"attribs\":{\"data\":{\"home_brew_french_press\":[\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\"],\"gender\":[\"Female\",\"Female\",\"Male\",\"Male\",\"Other\",\"Other\",\"Female\",\"Female\",\"Male\",\"Male\",\"Other\",\"Other\",\"Female\",\"Female\",\"Male\",\"Male\",\"Other\",\"Other\",\"Female\",\"Female\",\"Male\",\"Male\",\"Other\",\"Other\"],\"age\":[\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"over44\",\"over44\",\"over44\",\"over44\",\"over44\",\"over44\",\"under24\",\"under24\",\"under24\",\"under24\",\"under24\",\"under24\"],\"n\":[0.832947976878613,0.167052023121387,0.797893053334261,0.20210694666574,0.776356192425793,0.223643807574207,0.778364722094626,0.221635277905374,0.775488378725225,0.224511621274775,0.737082066869301,0.262917933130699,0.873974849644615,0.126025150355385,0.783660492120542,0.216339507879458,0.811688311688312,0.188311688311688,0.81448275862069,0.18551724137931,0.77247790307833,0.22752209692167,0.723048327137546,0.276951672862454]},\"columns\":[{\"id\":\"home_brew_french_press\",\"name\":\"home_brew_french_press\",\"type\":\"character\"},{\"id\":\"gender\",\"name\":\"gender\",\"type\":\"character\"},{\"id\":\"age\",\"name\":\"age\",\"type\":\"character\"},{\"id\":\"n\",\"name\":\"n\",\"type\":\"numeric\"}],\"filterable\":true,\"searchable\":true,\"dataKey\":\"0049620bcee322e603e7c48f9e0a54a7\"},\"children\":[]},\"class\":\"reactR_markup\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n### Home Brewing - Espresso\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndag_fit$home_brew_espresso$prob |>\n  as_tibble() |>\n  mutate(\n    n = round(n, 2)\n  ) |>\n  gg_func(x = gender, y = n, fill = home_brew_espresso, facet = age) +\n  labs(\n    title = \"Probability of Making Espresso at Home From the Great American Tasting\",\n    subtitle = \"Based on Gender and Age Range\",\n    x = \"\",\n    y = \"Probability\",\n    fill = \"\"\n  ) +\n  theme(\n    legend.position = \"bottom\"\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-23-1.png){width=768}\n:::\n\n```{.r .cell-code}\ndag_fit$home_brew_espresso$prob |>\nas_tibble() |>\n  reactable(\n    filterable = TRUE,\n    searchable = TRUE\n  )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"reactable html-widget html-fill-item\" id=\"htmlwidget-6c7f0e729e271df8aeb5\" style=\"width:auto;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-6c7f0e729e271df8aeb5\">{\"x\":{\"tag\":{\"name\":\"Reactable\",\"attribs\":{\"data\":{\"home_brew_espresso\":[\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\"],\"gender\":[\"Female\",\"Female\",\"Male\",\"Male\",\"Other\",\"Other\",\"Female\",\"Female\",\"Male\",\"Male\",\"Other\",\"Other\",\"Female\",\"Female\",\"Male\",\"Male\",\"Other\",\"Other\",\"Female\",\"Female\",\"Male\",\"Male\",\"Other\",\"Other\"],\"age\":[\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"over44\",\"over44\",\"over44\",\"over44\",\"over44\",\"over44\",\"under24\",\"under24\",\"under24\",\"under24\",\"under24\",\"under24\"],\"n\":[0.627630057803468,0.372369942196532,0.518357555107433,0.481642444892567,0.604401228249744,0.395598771750256,0.69568213137345,0.30431786862655,0.525666619135891,0.47433338086411,0.700607902735562,0.299392097264438,0.782121377802078,0.217878622197922,0.624412496544097,0.375587503455903,0.811688311688312,0.188311688311688,0.615862068965517,0.384137931034483,0.611551356293813,0.388448643706187,0.812267657992565,0.187732342007435]},\"columns\":[{\"id\":\"home_brew_espresso\",\"name\":\"home_brew_espresso\",\"type\":\"character\"},{\"id\":\"gender\",\"name\":\"gender\",\"type\":\"character\"},{\"id\":\"age\",\"name\":\"age\",\"type\":\"character\"},{\"id\":\"n\",\"name\":\"n\",\"type\":\"numeric\"}],\"filterable\":true,\"searchable\":true,\"dataKey\":\"321c5e740b71c26bbc1be8b973e88cf6\"},\"children\":[]},\"class\":\"reactR_markup\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n### Home Brewing - coffee Brewing Machine\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndag_fit$home_brew_mr_coffee$prob |>\n  as_tibble() |>\n  mutate(\n    n = round(n, 2)\n  ) |>\n  gg_func(x = gender, y = n, fill = home_brew_mr_coffee, facet = age) +\n  labs(\n    title = \"Probability of Making Coffee Using a Coffee Brewing Machine at Home From the Great American Tasting\",\n    subtitle = \"Based on Gender and Age Range\",\n    x = \"\",\n    y = \"Probability\",\n    fill = \"\"\n  ) +\n  theme(\n    legend.position = \"bottom\"\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-24-1.png){width=768}\n:::\n\n```{.r .cell-code}\ndag_fit$home_brew_mr_coffee$prob |>\nas_tibble() |>\n  reactable(\n    filterable = TRUE,\n    searchable = TRUE\n  )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"reactable html-widget html-fill-item\" id=\"htmlwidget-365b5ba640c3be882fd0\" style=\"width:auto;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-365b5ba640c3be882fd0\">{\"x\":{\"tag\":{\"name\":\"Reactable\",\"attribs\":{\"data\":{\"home_brew_mr_coffee\":[\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\"],\"gender\":[\"Female\",\"Female\",\"Male\",\"Male\",\"Other\",\"Other\",\"Female\",\"Female\",\"Male\",\"Male\",\"Other\",\"Other\",\"Female\",\"Female\",\"Male\",\"Male\",\"Other\",\"Other\",\"Female\",\"Female\",\"Male\",\"Male\",\"Other\",\"Other\"],\"age\":[\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"over44\",\"over44\",\"over44\",\"over44\",\"over44\",\"over44\",\"under24\",\"under24\",\"under24\",\"under24\",\"under24\",\"under24\"],\"n\":[0.788554913294798,0.211445086705202,0.862144496210277,0.137855503789723,0.899181166837257,0.100818833162743,0.767340376665136,0.232659623334864,0.811421645515471,0.188578354484529,0.846504559270517,0.153495440729483,0.67058501913614,0.32941498086386,0.733895493502903,0.266104506497097,0.811688311688312,0.188311688311688,0.781379310344828,0.218620689655172,0.845626333434928,0.154373666565072,0.812267657992565,0.187732342007435]},\"columns\":[{\"id\":\"home_brew_mr_coffee\",\"name\":\"home_brew_mr_coffee\",\"type\":\"character\"},{\"id\":\"gender\",\"name\":\"gender\",\"type\":\"character\"},{\"id\":\"age\",\"name\":\"age\",\"type\":\"character\"},{\"id\":\"n\",\"name\":\"n\",\"type\":\"numeric\"}],\"filterable\":true,\"searchable\":true,\"dataKey\":\"3e6dda29df490cd1ae1cc9ad44a87ed8\"},\"children\":[]},\"class\":\"reactR_markup\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n### Home Brewing - Pods\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndag_fit$home_brew_pods$prob |>\n  as_tibble() |>\n  mutate(\n    n = round(n, 2)\n  ) |>\n  gg_func(x = gender, y = n, fill = home_brew_pods, facet = age) +\n  labs(\n    title = \"Probability of Making Coffee Using Pods at Home From the Great American Tasting\",\n    subtitle = \"Based on Gender and Age Range\",\n    x = \"\",\n    y = \"Probability\",\n    fill = \"\"\n  ) +\n  theme(\n    legend.position = \"bottom\"\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-25-1.png){width=768}\n:::\n\n```{.r .cell-code}\ndag_fit$home_brew_pods$prob |>\nas_tibble() |>\n  reactable(\n    filterable = TRUE,\n    searchable = TRUE\n  )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"reactable html-widget html-fill-item\" id=\"htmlwidget-67c52c62b95d8db5341f\" style=\"width:auto;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-67c52c62b95d8db5341f\">{\"x\":{\"tag\":{\"name\":\"Reactable\",\"attribs\":{\"data\":{\"home_brew_pods\":[\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\"],\"gender\":[\"Female\",\"Female\",\"Male\",\"Male\",\"Other\",\"Other\",\"Female\",\"Female\",\"Male\",\"Male\",\"Other\",\"Other\",\"Female\",\"Female\",\"Male\",\"Male\",\"Other\",\"Other\",\"Female\",\"Female\",\"Male\",\"Male\",\"Other\",\"Other\"],\"age\":[\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"over44\",\"over44\",\"over44\",\"over44\",\"over44\",\"over44\",\"under24\",\"under24\",\"under24\",\"under24\",\"under24\",\"under24\"],\"n\":[0.888439306358382,0.111560693641619,0.947256797162923,0.0527432028370767,0.936028659160696,0.063971340839304,0.883096003674782,0.116903996325218,0.932910309425353,0.0670896905746471,0.919452887537994,0.0805471124620061,0.795243302351011,0.204756697648989,0.866602156483273,0.133397843516727,0.967532467532468,0.0324675324675325,0.781379310344828,0.218620689655172,0.882200548613228,0.117799451386772,0.946096654275093,0.0539033457249071]},\"columns\":[{\"id\":\"home_brew_pods\",\"name\":\"home_brew_pods\",\"type\":\"character\"},{\"id\":\"gender\",\"name\":\"gender\",\"type\":\"character\"},{\"id\":\"age\",\"name\":\"age\",\"type\":\"character\"},{\"id\":\"n\",\"name\":\"n\",\"type\":\"numeric\"}],\"filterable\":true,\"searchable\":true,\"dataKey\":\"414d51ff5273149fdb506a1221539407\"},\"children\":[]},\"class\":\"reactR_markup\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n### Home Brewing - Instant Coffee\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndag_fit$home_brew_instant$prob |>\n  as_tibble() |>\n  mutate(\n    n = round(n, 2)\n  ) |>\n  gg_func(x = gender, y = n, fill = home_brew_instant, facet = age) +\n  labs(\n    title = \"Probability of Making Instant Coffee at Home From the Great American Tasting\",\n    subtitle = \"Based on Gender and Age Range\",\n    x = \"\",\n    y = \"Probability\",\n    fill = \"\"\n  ) +\n  theme(\n    legend.position = \"bottom\"\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-26-1.png){width=768}\n:::\n\n```{.r .cell-code}\ndag_fit$home_brew_instant$prob |>\nas_tibble() |>\n  reactable(\n    filterable = TRUE,\n    searchable = TRUE\n  )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"reactable html-widget html-fill-item\" id=\"htmlwidget-ee4062b5e3d26ef3b0d3\" style=\"width:auto;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-ee4062b5e3d26ef3b0d3\">{\"x\":{\"tag\":{\"name\":\"Reactable\",\"attribs\":{\"data\":{\"home_brew_instant\":[\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\"],\"gender\":[\"Female\",\"Female\",\"Male\",\"Male\",\"Other\",\"Other\",\"Female\",\"Female\",\"Male\",\"Male\",\"Other\",\"Other\",\"Female\",\"Female\",\"Male\",\"Male\",\"Other\",\"Other\",\"Female\",\"Female\",\"Male\",\"Male\",\"Other\",\"Other\"],\"age\":[\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"over44\",\"over44\",\"over44\",\"over44\",\"over44\",\"over44\",\"under24\",\"under24\",\"under24\",\"under24\",\"under24\",\"under24\"],\"n\":[0.949479768786127,0.0505202312138728,0.972289826854878,0.027710173145122,0.911463664278403,0.0885363357215967,0.960266421681213,0.0397335783187873,0.979110223869956,0.0208897761300442,0.882978723404255,0.117021276595745,0.965828321487151,0.0341716785128485,0.966132153718551,0.0338678462814487,0.967532467532468,0.0324675324675325,0.913793103448276,0.0862068965517241,0.959006400487656,0.0409935995123438,0.946096654275093,0.0539033457249071]},\"columns\":[{\"id\":\"home_brew_instant\",\"name\":\"home_brew_instant\",\"type\":\"character\"},{\"id\":\"gender\",\"name\":\"gender\",\"type\":\"character\"},{\"id\":\"age\",\"name\":\"age\",\"type\":\"character\"},{\"id\":\"n\",\"name\":\"n\",\"type\":\"numeric\"}],\"filterable\":true,\"searchable\":true,\"dataKey\":\"dfa9ec4bd68394740bf235de186a46e4\"},\"children\":[]},\"class\":\"reactR_markup\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n### Home Brewing - Bean 2 Cup\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndag_fit$home_brew_bean2cup$prob |>\n  as_tibble() |>\n  mutate(\n    n = round(n, 2)\n  ) |>\n  gg_func(x = gender, y = n, fill = home_brew_bean2cup, facet = age) +\n  labs(\n    title = \"Probability of Making Coffee Using a Bean 2 Cup Machine at Home From the Great American Tasting\",\n    subtitle = \"Based on Gender and Age Range\",\n    x = \"\",\n    y = \"Probability\",\n    fill = \"\"\n  ) +\n  theme(\n    legend.position = \"bottom\"\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-27-1.png){width=768}\n:::\n\n```{.r .cell-code}\ndag_fit$home_brew_bean2cup$prob |>\nas_tibble() |>\n  reactable(\n    filterable = TRUE,\n    searchable = TRUE\n  )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"reactable html-widget html-fill-item\" id=\"htmlwidget-cda39bb058342c4e54e6\" style=\"width:auto;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-cda39bb058342c4e54e6\">{\"x\":{\"tag\":{\"name\":\"Reactable\",\"attribs\":{\"data\":{\"home_brew_bean2cup\":[\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\"],\"gender\":[\"Female\",\"Female\",\"Male\",\"Male\",\"Other\",\"Other\",\"Female\",\"Female\",\"Male\",\"Male\",\"Other\",\"Other\",\"Female\",\"Female\",\"Male\",\"Male\",\"Other\",\"Other\",\"Female\",\"Female\",\"Male\",\"Male\",\"Other\",\"Other\"],\"age\":[\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"over44\",\"over44\",\"over44\",\"over44\",\"over44\",\"over44\",\"under24\",\"under24\",\"under24\",\"under24\",\"under24\",\"under24\"],\"n\":[0.977225433526012,0.0227745664739884,0.988978513316181,0.0110214866838189,0.960593654042989,0.0394063459570113,0.960266421681213,0.0397335783187873,0.972265792100385,0.027734207899615,0.955927051671733,0.0440729483282675,0.933023510114817,0.0669764898851832,0.962814487144042,0.037185512855958,0.967532467532468,0.0324675324675325,0.996551724137931,0.00344827586206897,0.988265772630296,0.0117342273697044,0.901486988847584,0.0985130111524164]},\"columns\":[{\"id\":\"home_brew_bean2cup\",\"name\":\"home_brew_bean2cup\",\"type\":\"character\"},{\"id\":\"gender\",\"name\":\"gender\",\"type\":\"character\"},{\"id\":\"age\",\"name\":\"age\",\"type\":\"character\"},{\"id\":\"n\",\"name\":\"n\",\"type\":\"numeric\"}],\"filterable\":true,\"searchable\":true,\"dataKey\":\"5bace53c61170106d65b50d54df92a33\"},\"children\":[]},\"class\":\"reactR_markup\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n### Home Brewing - Cold Brew\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndag_fit$home_brew_cold_brew$prob |>\n  as_tibble() |>\n  mutate(\n    n = round(n, 2)\n  ) |>\n  gg_func(x = gender, y = n, fill = home_brew_cold_brew, facet = age) +\n  labs(\n    title = \"Probability of Making Cold Brew at Home From the Great American Tasting\",\n    subtitle = \"Based on Gender and Age Range\",\n    x = \"\",\n    y = \"Probability\",\n    fill = \"\"\n  ) +\n  theme(\n    legend.position = \"bottom\"\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-28-1.png){width=768}\n:::\n\n```{.r .cell-code}\ndag_fit$home_brew_cold_brew$prob |>\nas_tibble() |>\n  reactable(\n    filterable = TRUE,\n    searchable = TRUE\n  )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"reactable html-widget html-fill-item\" id=\"htmlwidget-39eb4471c1cea5a9437d\" style=\"width:auto;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-39eb4471c1cea5a9437d\">{\"x\":{\"tag\":{\"name\":\"Reactable\",\"attribs\":{\"data\":{\"home_brew_cold_brew\":[\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\"],\"gender\":[\"Female\",\"Female\",\"Male\",\"Male\",\"Other\",\"Other\",\"Female\",\"Female\",\"Male\",\"Male\",\"Other\",\"Other\",\"Female\",\"Female\",\"Male\",\"Male\",\"Other\",\"Other\",\"Female\",\"Female\",\"Male\",\"Male\",\"Other\",\"Other\"],\"age\":[\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"over44\",\"over44\",\"over44\",\"over44\",\"over44\",\"over44\",\"under24\",\"under24\",\"under24\",\"under24\",\"under24\",\"under24\"],\"n\":[0.830173410404624,0.169826589595376,0.850462415687365,0.149537584312635,0.776356192425793,0.223643807574207,0.850022967386311,0.149977032613689,0.855910452017681,0.144089547982319,0.773556231003039,0.22644376899696,0.92646254784035,0.0735374521596501,0.893143489079347,0.106856510920652,0.967532467532468,0.0324675324675325,0.81448275862069,0.18551724137931,0.882200548613228,0.117799451386772,0.812267657992565,0.187732342007435]},\"columns\":[{\"id\":\"home_brew_cold_brew\",\"name\":\"home_brew_cold_brew\",\"type\":\"character\"},{\"id\":\"gender\",\"name\":\"gender\",\"type\":\"character\"},{\"id\":\"age\",\"name\":\"age\",\"type\":\"character\"},{\"id\":\"n\",\"name\":\"n\",\"type\":\"numeric\"}],\"filterable\":true,\"searchable\":true,\"dataKey\":\"938b2dbe2878eabe28041c2bf8701bcb\"},\"children\":[]},\"class\":\"reactR_markup\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n### Home Brewing - Cometeer\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndag_fit$home_brew_cometeer$prob |>\n  as_tibble() |>\n  mutate(\n    n = round(n, 2)\n  ) |>\n  gg_func(x = gender, y = n, fill = home_brew_cometeer, facet = age) +\n  labs(\n    title = \"Probability of Making Cometeer Coffees at Home From the Great American Tasting\",\n    subtitle = \"Based on Gender and Age Range\",\n    x = \"\",\n    y = \"Probability\",\n    fill = \"\"\n  ) +\n  theme(\n    legend.position = \"bottom\"\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-29-1.png){width=768}\n:::\n\n```{.r .cell-code}\ndag_fit$home_brew_cometeer$prob |>\nas_tibble() |>\n  reactable(\n    filterable = TRUE,\n    searchable = TRUE\n  )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"reactable html-widget html-fill-item\" id=\"htmlwidget-45cfb6b7262b92c7e53b\" style=\"width:auto;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-45cfb6b7262b92c7e53b\">{\"x\":{\"tag\":{\"name\":\"Reactable\",\"attribs\":{\"data\":{\"home_brew_cometeer\":[\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\"],\"gender\":[\"Female\",\"Female\",\"Male\",\"Male\",\"Other\",\"Other\",\"Female\",\"Female\",\"Male\",\"Male\",\"Other\",\"Other\",\"Female\",\"Female\",\"Male\",\"Male\",\"Other\",\"Other\",\"Female\",\"Female\",\"Male\",\"Male\",\"Other\",\"Other\"],\"age\":[\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"over44\",\"over44\",\"over44\",\"over44\",\"over44\",\"over44\",\"under24\",\"under24\",\"under24\",\"under24\",\"under24\",\"under24\"],\"n\":[0.941156069364162,0.0588439306358381,0.949760100132119,0.0502398998678812,0.960593654042989,0.0394063459570113,0.916169039963252,0.0838309600367478,0.946599172964494,0.0534008270355055,0.955927051671733,0.0440729483282675,0.939584472389284,0.0604155276107162,0.946226154271496,0.0537738457285043,0.811688311688312,0.188311688311688,0.996551724137931,0.00344827586206897,0.988265772630296,0.0117342273697044,0.990706319702602,0.00929368029739777]},\"columns\":[{\"id\":\"home_brew_cometeer\",\"name\":\"home_brew_cometeer\",\"type\":\"character\"},{\"id\":\"gender\",\"name\":\"gender\",\"type\":\"character\"},{\"id\":\"age\",\"name\":\"age\",\"type\":\"character\"},{\"id\":\"n\",\"name\":\"n\",\"type\":\"numeric\"}],\"filterable\":true,\"searchable\":true,\"dataKey\":\"ee73d7535432118d21c0ea2449db3bfa\"},\"children\":[]},\"class\":\"reactR_markup\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n### Home Brewing - Other\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndag_fit$home_brew_other$prob |>\n  as_tibble() |>\n  mutate(\n    n = round(n, 2)\n  ) |>\n  gg_func(x = gender, y = n, fill = home_brew_other, facet = age) +\n  labs(\n    title = \"Probability of Making Coffee From Other Methods at Home From the Great American Tasting\",\n    subtitle = \"Based on Gender and Age Range\",\n    x = \"\",\n    y = \"Probability\",\n    fill = \"\"\n  ) +\n  theme(\n    legend.position = \"bottom\"\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-30-1.png){width=768}\n:::\n\n```{.r .cell-code}\ndag_fit$home_brew_other$prob |>\nas_tibble() |>\n  reactable(\n    filterable = TRUE,\n    searchable = TRUE\n  )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"reactable html-widget html-fill-item\" id=\"htmlwidget-d2f6733efa9352c56482\" style=\"width:auto;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-d2f6733efa9352c56482\">{\"x\":{\"tag\":{\"name\":\"Reactable\",\"attribs\":{\"data\":{\"home_brew_other\":[\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\",\"0\",\"1\"],\"gender\":[\"Female\",\"Female\",\"Male\",\"Male\",\"Other\",\"Other\",\"Female\",\"Female\",\"Male\",\"Male\",\"Other\",\"Other\",\"Female\",\"Female\",\"Male\",\"Male\",\"Other\",\"Other\",\"Female\",\"Female\",\"Male\",\"Male\",\"Other\",\"Other\"],\"age\":[\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"over44\",\"over44\",\"over44\",\"over44\",\"over44\",\"over44\",\"under24\",\"under24\",\"under24\",\"under24\",\"under24\",\"under24\"],\"n\":[0.85514450867052,0.14485549132948,0.804568527918782,0.195431472081218,0.800921187308086,0.199078812691914,0.855535140101056,0.144464859898943,0.816554969342649,0.183445030657351,0.773556231003039,0.22644376899696,0.860852925095681,0.139147074904319,0.773707492397014,0.226292507602986,0.655844155844156,0.344155844155844,0.897241379310345,0.102758620689655,0.75053337397135,0.24946662602865,0.812267657992565,0.187732342007435]},\"columns\":[{\"id\":\"home_brew_other\",\"name\":\"home_brew_other\",\"type\":\"character\"},{\"id\":\"gender\",\"name\":\"gender\",\"type\":\"character\"},{\"id\":\"age\",\"name\":\"age\",\"type\":\"character\"},{\"id\":\"n\",\"name\":\"n\",\"type\":\"numeric\"}],\"filterable\":true,\"searchable\":true,\"dataKey\":\"ecd209ef7e35250d0ba955d07306d0b7\"},\"children\":[]},\"class\":\"reactR_markup\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n### Favorite Coffee Drink - CPT\n\nThese probabilities are for participants' favorite coffee drinks based on their genders and age ranges.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndag_fit$favorite_coffee_drink$prob |>\n  as_tibble() |>\n  mutate(\n    n = round(n, 2)\n  ) |>\n  gg_func(\n    x = favorite_coffee_drink,\n    y = n,\n    fill = gender,\n    facet = age\n  ) +\n  labs(\n    title = \"Probability of Favorite Coffee Drinks From the Great American Tasting\",\n    subtitle = \"Based on Gender and Age Range\",\n    x = \"\",\n    y = \"Probability\",\n    fill = \"\"\n  ) +\n  theme(\n    legend.position = \"bottom\"\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-31-1.png){width=768}\n:::\n\n```{.r .cell-code}\ndag_fit$favorite_coffee_drink$prob |>\nas_tibble() |>\n  reactable(\n    filterable = TRUE,\n    searchable = TRUE\n  )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"reactable html-widget html-fill-item\" id=\"htmlwidget-cf45893cf3421d901ec7\" style=\"width:auto;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-cf45893cf3421d901ec7\">{\"x\":{\"tag\":{\"name\":\"Reactable\",\"attribs\":{\"data\":{\"favorite_coffee_drink\":[\"americano\",\"cappuccino\",\"cortado\",\"drip\",\"espresso\",\"latte\",\"other\",\"pourover\",\"americano\",\"cappuccino\",\"cortado\",\"drip\",\"espresso\",\"latte\",\"other\",\"pourover\",\"americano\",\"cappuccino\",\"cortado\",\"drip\",\"espresso\",\"latte\",\"other\",\"pourover\",\"americano\",\"cappuccino\",\"cortado\",\"drip\",\"espresso\",\"latte\",\"other\",\"pourover\",\"americano\",\"cappuccino\",\"cortado\",\"drip\",\"espresso\",\"latte\",\"other\",\"pourover\",\"americano\",\"cappuccino\",\"cortado\",\"drip\",\"espresso\",\"latte\",\"other\",\"pourover\",\"americano\",\"cappuccino\",\"cortado\",\"drip\",\"espresso\",\"latte\",\"other\",\"pourover\",\"americano\",\"cappuccino\",\"cortado\",\"drip\",\"espresso\",\"latte\",\"other\",\"pourover\",\"americano\",\"cappuccino\",\"cortado\",\"drip\",\"espresso\",\"latte\",\"other\",\"pourover\",\"americano\",\"cappuccino\",\"cortado\",\"drip\",\"espresso\",\"latte\",\"other\",\"pourover\",\"americano\",\"cappuccino\",\"cortado\",\"drip\",\"espresso\",\"latte\",\"other\",\"pourover\",\"americano\",\"cappuccino\",\"cortado\",\"drip\",\"espresso\",\"latte\",\"other\",\"pourover\"],\"gender\":[\"Female\",\"Female\",\"Female\",\"Female\",\"Female\",\"Female\",\"Female\",\"Female\",\"Male\",\"Male\",\"Male\",\"Male\",\"Male\",\"Male\",\"Male\",\"Male\",\"Other\",\"Other\",\"Other\",\"Other\",\"Other\",\"Other\",\"Other\",\"Other\",\"Female\",\"Female\",\"Female\",\"Female\",\"Female\",\"Female\",\"Female\",\"Female\",\"Male\",\"Male\",\"Male\",\"Male\",\"Male\",\"Male\",\"Male\",\"Male\",\"Other\",\"Other\",\"Other\",\"Other\",\"Other\",\"Other\",\"Other\",\"Other\",\"Female\",\"Female\",\"Female\",\"Female\",\"Female\",\"Female\",\"Female\",\"Female\",\"Male\",\"Male\",\"Male\",\"Male\",\"Male\",\"Male\",\"Male\",\"Male\",\"Other\",\"Other\",\"Other\",\"Other\",\"Other\",\"Other\",\"Other\",\"Other\",\"Female\",\"Female\",\"Female\",\"Female\",\"Female\",\"Female\",\"Female\",\"Female\",\"Male\",\"Male\",\"Male\",\"Male\",\"Male\",\"Male\",\"Male\",\"Male\",\"Other\",\"Other\",\"Other\",\"Other\",\"Other\",\"Other\",\"Other\",\"Other\"],\"age\":[\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"25-34 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"35-44 years old\",\"over44\",\"over44\",\"over44\",\"over44\",\"over44\",\"over44\",\"over44\",\"over44\",\"over44\",\"over44\",\"over44\",\"over44\",\"over44\",\"over44\",\"over44\",\"over44\",\"over44\",\"over44\",\"over44\",\"over44\",\"over44\",\"over44\",\"over44\",\"over44\",\"under24\",\"under24\",\"under24\",\"under24\",\"under24\",\"under24\",\"under24\",\"under24\",\"under24\",\"under24\",\"under24\",\"under24\",\"under24\",\"under24\",\"under24\",\"under24\",\"under24\",\"under24\",\"under24\",\"under24\",\"under24\",\"under24\",\"under24\",\"under24\"],\"n\":[0.0639595375722543,0.127774566473988,0.0611849710982659,0.0917052023121387,0.0278901734104046,0.327543352601156,0.147196531791908,0.152745664739884,0.0634604686739448,0.0726392462276615,0.0976722759196162,0.100175578888812,0.101844447534942,0.108519922119463,0.102678881858007,0.353009178777554,0.0129222108495394,0.098899692937564,0.11118219037871,0.0743346980552712,0.0497697031729785,0.270854657113613,0.135747185261003,0.24628966223132,0.0995062011943041,0.0829696830500689,0.0774575103353238,0.105018373909049,0.0113114377583831,0.319993109784107,0.19321313734497,0.110530546623794,0.073666761728219,0.0770889776130044,0.0822223014401825,0.104466704691288,0.107888920576073,0.111311136460858,0.0890667332097533,0.354288464280622,0.111322188449848,0.220744680851064,0.0383738601823708,0.111322188449848,0.0748480243161094,0.184270516717325,0.00189969604863222,0.257218844984802,0.0790732640787316,0.111878075451066,0.0265855658829962,0.197170585019136,0.0462684527063969,0.216853471842537,0.157804811372335,0.164365773646802,0.0532554603262372,0.0897497926458391,0.049937793751728,0.179326790157589,0.103020458943876,0.139514791263478,0.0897497926458391,0.295445120265413,0.00811688311688312,0.163961038961039,0.00811688311688312,0.319805194805195,0.00811688311688312,0.00811688311688312,0.319805194805195,0.163961038961039,0.0836206896551724,0.0670689655172414,0.0505172413793104,0.0505172413793104,0.0174137931034483,0.365,0.249137931034483,0.116724137931034,0.0550518134715026,0.0733389210606522,0.0952834501676318,0.0989408716854617,0.102598293203292,0.135515086863761,0.17940414507772,0.259867418469979,0.00232342007434944,0.225371747211896,0.091542750929368,0.091542750929368,0.091542750929368,0.136152416356877,0.269981412639405,0.091542750929368]},\"columns\":[{\"id\":\"favorite_coffee_drink\",\"name\":\"favorite_coffee_drink\",\"type\":\"character\"},{\"id\":\"gender\",\"name\":\"gender\",\"type\":\"character\"},{\"id\":\"age\",\"name\":\"age\",\"type\":\"character\"},{\"id\":\"n\",\"name\":\"n\",\"type\":\"numeric\"}],\"filterable\":true,\"searchable\":true,\"dataKey\":\"a15c211739e663229a12d0496f5d9044\"},\"children\":[]},\"class\":\"reactR_markup\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n### Roast Preference - CPT\n\n\n::: {.cell}\n\n```{.r .cell-code}\nroast_pref_func <- function(\n  dag_table,\n  x,\n  y = n,\n  fill,\n  facet_x,\n  facet_y\n){\n  {{dag_table}} |>\n  as_tibble() |>\n  mutate(\n    fill = str_to_title({{fill}}),\n    n = round(n, 2),\n    across(\n      -n,\n      ~as.factor(.x)\n    ),\n    x = fct_relevel(\n      {{x}},\n      \"three_or_more\",\n      \"2\",\n      \"one_or_less\"\n    ),\n    fill = fct_relevel(\n      fill,\n      \"Dark\",\n      \"Medium\",\n      \"Light\"\n    )\n  ) |>\n  ggplot(\n    aes(\n      x,\n      {{y}}\n    )\n  ) +\n  geom_col(\n    aes(\n      fill = fill\n      )\n  ) +\n  coord_flip() +\n  facet_grid(\n    vars({{facet_x}}),\n    vars({{facet_y}})\n  ) +\n  viridis::scale_fill_viridis(\n    discrete = TRUE\n  ) +\n  guides(\n    fill = guide_legend(\n      reverse = TRUE\n      )\n    )\n}\n```\n:::\n\n\nThe CPT here only include the probabilities for whether participants used one home brewer or not and considered all of the other home brewers as not using those at home. If I included all of them, these tables would be unbearably long. This post is already pretty long.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nroast_pref_func(\n  dag_table = dag_fit$roast_preference$prob[1:3, 1:3, 1:2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1:8],\n  x = cup_per_day,\n  y = n,\n  fill = roast_preference,\n  facet_x = favorite_coffee_drink,\n  facet_y = home_brew_pour_over\n) +\n  labs(\n    title = \"Probability of Coffee Roast Preference From the Great American Tasting\",\n    subtitle = \"Based on Gender, Age, Cups Per Day, and Whether Participants Brew at Home Using a Pourover\",\n    x = \"\",\n    y = \"Probability\",\n    fill = \"\"\n  ) +\n  theme(\n    legend.position = \"bottom\"\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-33-1.png){width=768}\n:::\n\n```{.r .cell-code}\ndag_fit$roast_preference$prob[1:3, 1:3, 1:2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1:8] |>\nas_tibble() |>\n  reactable(\n    filterable = TRUE,\n    searchable = TRUE\n  )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"reactable html-widget html-fill-item\" id=\"htmlwidget-5b9422a17fe613445d51\" style=\"width:auto;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-5b9422a17fe613445d51\">{\"x\":{\"tag\":{\"name\":\"Reactable\",\"attribs\":{\"data\":{\"roast_preference\":[\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\"],\"cup_per_day\":[\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\"],\"home_brew_pour_over\":[\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\"],\"favorite_coffee_drink\":[\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\"],\"n\":[0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,2.26040804886098e-05,2.26040804886098e-05,0.999954791839023,1.69533477775856e-05,0.499991523326111,0.499991523326111,3.39049711468696e-05,0.499983047514427,0.499983047514427,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.125002649061639,0.624996291313706,0.250001059624656,4.2384986220641e-06,0.624996291313706,0.374999470187672,6.78030457128134e-05,6.78030457128134e-05,0.999864393908574,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,7.53503414123969e-06,0.888876330498654,0.111116134467205,0.0714323774204205,0.785707711728365,0.142859910851215,1.35628161831523e-05,0.999972874367634,1.35628161831523e-05,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.0666684751034765,0.499998869726994,0.43333265516953,0.125001766048578,0.541664900618089,0.333333333333333,8.47688945627536e-06,0.74998940388818,0.250002119222364,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,1.69533477775856e-05,0.999966093304445,1.69533477775856e-05,1.69533477775856e-05,0.749978808315278,0.250004238336944,1.69533477775856e-05,0.999966093304445,1.69533477775856e-05,0.333333333333333,0.333333333333333,0.333333333333333,3.39049711468696e-05,0.999932190057706,3.39049711468696e-05,0.333333333333333,0.333333333333333,0.333333333333333,0.153848962783744,0.384614582061788,0.461536455154469,0.0370392696733915,0.370370091290826,0.592590639035782,6.78030457128134e-05,6.78030457128134e-05,0.999864393908574,0.333333333333333,0.333333333333333,0.333333333333333,6.78030457128134e-05,6.78030457128134e-05,0.999864393908574,0.333333333333333,0.333333333333333,0.333333333333333,6.16505327222533e-06,0.545450622238827,0.454543212707901,0.0714304744383232,0.678568920058574,0.250000605503103,2.26040804886098e-05,0.333333333333333,0.666644062586178,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.0220592891828412,0.794116957745085,0.183823753072073,0.00909150879243708,0.727271998663394,0.263636492544169,0.0606077420049576,0.727270298585432,0.212121959409611]},\"columns\":[{\"id\":\"roast_preference\",\"name\":\"roast_preference\",\"type\":\"character\"},{\"id\":\"cup_per_day\",\"name\":\"cup_per_day\",\"type\":\"character\"},{\"id\":\"home_brew_pour_over\",\"name\":\"home_brew_pour_over\",\"type\":\"character\"},{\"id\":\"favorite_coffee_drink\",\"name\":\"favorite_coffee_drink\",\"type\":\"character\"},{\"id\":\"n\",\"name\":\"n\",\"type\":\"numeric\"}],\"filterable\":true,\"searchable\":true,\"dataKey\":\"ef52aa455d491332566611612fa07f17\"},\"children\":[]},\"class\":\"reactR_markup\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nroast_pref_func(\n  dag_table = dag_fit$roast_preference$prob[1:3, 1:3, 1, 1:2, 1, 1, 1, 1, 1, 1, 1, 1, 1:8],\n  x = cup_per_day,\n  y = n,\n  fill = roast_preference,\n  facet_x = favorite_coffee_drink,\n  facet_y = home_brew_french_press\n) +\n  labs(\n    title = \"Probability of Coffee Roast Preference From the Great American Tasting\",\n    subtitle = \"Based on Gender, Age, Cups Per Day, and Whether Participants Brew at Home Using a French Press\",\n    x = \"\",\n    y = \"Probability\",\n    fill = \"\"\n  ) +\n  theme(\n    legend.position = \"bottom\"\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-34-1.png){width=768}\n:::\n\n```{.r .cell-code}\ndag_fit$roast_preference$prob[1:3, 1:3, 1, 1:2, 1, 1, 1, 1, 1, 1, 1, 1, 1:8] |>\nas_tibble() |>\n  reactable(\n    filterable = TRUE,\n    searchable = TRUE\n  )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"reactable html-widget html-fill-item\" id=\"htmlwidget-5fc28990726b9a0e3e52\" style=\"width:auto;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-5fc28990726b9a0e3e52\">{\"x\":{\"tag\":{\"name\":\"Reactable\",\"attribs\":{\"data\":{\"roast_preference\":[\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\"],\"cup_per_day\":[\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\"],\"home_brew_french_press\":[\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\"],\"favorite_coffee_drink\":[\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\"],\"n\":[0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.499983047514427,0.499983047514427,3.39049711468696e-05,1.69533477775856e-05,0.499991523326111,0.499991523326111,6.78030457128134e-05,6.78030457128134e-05,0.999864393908574,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,1.69533477775856e-05,0.749978808315278,0.250004238336944,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,6.78030457128134e-05,0.999864393908574,6.78030457128134e-05,0.999864393908574,6.78030457128134e-05,6.78030457128134e-05,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.166672317878399,1.13024234656395e-05,0.833316379698135,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,2.26040804886098e-05,0.666644062586178,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,3.39049711468696e-05,0.999932190057706,3.39049711468696e-05,0.333333333333333,0.333333333333333,0.333333333333333,1.13024234656395e-05,0.166672317878399,0.833316379698135,0.28571566969121,0.571421651543951,0.142862678764839,0.999864393908574,6.78030457128134e-05,6.78030457128134e-05,0.333333333333333,0.333333333333333,0.333333333333333,6.78030457128134e-05,6.78030457128134e-05,0.999864393908574,0.333333333333333,0.333333333333333,0.333333333333333,1.35628161831523e-05,1.35628161831523e-05,0.999972874367634,0.499994348788267,1.13024234656395e-05,0.499994348788267,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,1.69533477775856e-05,0.250004238336944,0.749978808315278,0.499983047514427,3.39049711468696e-05,0.499983047514427,6.78030457128134e-05,0.999864393908574,6.78030457128134e-05]},\"columns\":[{\"id\":\"roast_preference\",\"name\":\"roast_preference\",\"type\":\"character\"},{\"id\":\"cup_per_day\",\"name\":\"cup_per_day\",\"type\":\"character\"},{\"id\":\"home_brew_french_press\",\"name\":\"home_brew_french_press\",\"type\":\"character\"},{\"id\":\"favorite_coffee_drink\",\"name\":\"favorite_coffee_drink\",\"type\":\"character\"},{\"id\":\"n\",\"name\":\"n\",\"type\":\"numeric\"}],\"filterable\":true,\"searchable\":true,\"dataKey\":\"5e0627462d493819b767c77e7d05a630\"},\"children\":[]},\"class\":\"reactR_markup\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nroast_pref_func(\n  dag_table = dag_fit$roast_preference$prob[1:3, 1:3, 1, 1, 1:2, 1, 1, 1, 1, 1, 1, 1, 1:8],\n  x = cup_per_day,\n  y = n,\n  fill = roast_preference,\n  facet_x = favorite_coffee_drink,\n  facet_y = home_brew_espresso\n) +\n  labs(\n    title = \"Probability of Coffee Roast Preference From the Great American Tasting\",\n    subtitle = \"Based on Gender, Age, Cups Per Day, and Whether Participants Brew Espresso at Home\",\n    x = \"\",\n    y = \"Probability\",\n    fill = \"\"\n  ) +\n  theme(\n    legend.position = \"bottom\"\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-35-1.png){width=768}\n:::\n\n```{.r .cell-code}\ndag_fit$roast_preference$prob[1:3, 1:3, 1, 1, 1:2, 1, 1, 1, 1, 1, 1, 1, 1:8] |>\nas_tibble() |>\n  reactable(\n    filterable = TRUE,\n    searchable = TRUE\n  )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"reactable html-widget html-fill-item\" id=\"htmlwidget-567bf53cc3ee54369c8c\" style=\"width:auto;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-567bf53cc3ee54369c8c\">{\"x\":{\"tag\":{\"name\":\"Reactable\",\"attribs\":{\"data\":{\"roast_preference\":[\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\"],\"cup_per_day\":[\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\"],\"home_brew_espresso\":[\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\"],\"favorite_coffee_drink\":[\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\"],\"n\":[0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.187501854343147,0.312500264906164,0.499997880750689,0.333333333333333,0.333333333333333,0.333333333333333,6.78030457128134e-05,6.78030457128134e-05,0.999864393908574,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.111113622817547,0.22222347807544,0.666662899107013,0.0555586951886003,0.166668550446493,0.777772754364906,1.35628161831523e-05,1.35628161831523e-05,0.999972874367634,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.200002712618423,0.399998643690789,0.399998643690789,0.090913574584198,0.090913574584198,0.818172850831604,1.69533477775856e-05,0.499991523326111,0.499991523326111,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.999864393908574,6.78030457128134e-05,6.78030457128134e-05,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.166668550446493,0.38888826096228,0.444443188591227,0.10526560002627,0.578944738433248,0.315789661540482,0.111116134467205,0.555550532199461,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,3.39049711468696e-05,0.999932190057706,3.39049711468696e-05,0.333333333333333,0.333333333333333,0.333333333333333,0.161291451677756,0.258065010109018,0.580643538213226,0.240741089591485,0.148148845849638,0.611110064558877,0.200005425126473,0.200005425126473,0.599989149747054,0.333333333333333,0.333333333333333,0.333333333333333,6.78030457128134e-05,6.78030457128134e-05,0.999864393908574,0.333333333333333,0.333333333333333,0.333333333333333,0.399997287436763,0.200005425126473,0.399997287436763,0.214287444282009,0.142859910851215,0.642852644866776,3.39049711468696e-05,0.499983047514427,0.499983047514427,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,3.39049711468696e-05,0.499983047514427,0.499983047514427,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333]},\"columns\":[{\"id\":\"roast_preference\",\"name\":\"roast_preference\",\"type\":\"character\"},{\"id\":\"cup_per_day\",\"name\":\"cup_per_day\",\"type\":\"character\"},{\"id\":\"home_brew_espresso\",\"name\":\"home_brew_espresso\",\"type\":\"character\"},{\"id\":\"favorite_coffee_drink\",\"name\":\"favorite_coffee_drink\",\"type\":\"character\"},{\"id\":\"n\",\"name\":\"n\",\"type\":\"numeric\"}],\"filterable\":true,\"searchable\":true,\"dataKey\":\"99f8b5720500e0a2a1a8608ee2a7ba1c\"},\"children\":[]},\"class\":\"reactR_markup\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nroast_pref_func(\n  dag_table = dag_fit$roast_preference$prob[1:3, 1:3, 1, 1, 1, 1:2, 1, 1, 1, 1, 1, 1, 1:8],\n  x = cup_per_day,\n  y = n,\n  fill = roast_preference,\n  facet_x = favorite_coffee_drink,\n  facet_y = home_brew_mr_coffee\n) +\n  labs(\n    title = \"Probability of Coffee Roast Preference From the Great American Tasting\",\n    subtitle = \"Based on Gender, Age, Cups Per Day, and Whether Participants Brew at Home Using a Coffee Machine\",\n    x = \"\",\n    y = \"Probability\",\n    fill = \"\"\n  ) +\n  theme(\n    legend.position = \"bottom\"\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-36-1.png){width=768}\n:::\n\n```{.r .cell-code}\ndag_fit$roast_preference$prob[1:3, 1:3, 1, 1, 1, 1:2, 1, 1, 1, 1, 1, 1, 1:8] |>\nas_tibble() |>\n  reactable(\n    filterable = TRUE,\n    searchable = TRUE\n  )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"reactable html-widget html-fill-item\" id=\"htmlwidget-d162df8a12e1f4d47013\" style=\"width:auto;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-d162df8a12e1f4d47013\">{\"x\":{\"tag\":{\"name\":\"Reactable\",\"attribs\":{\"data\":{\"roast_preference\":[\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\"],\"cup_per_day\":[\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\"],\"home_brew_mr_coffee\":[\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\"],\"favorite_coffee_drink\":[\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\"],\"n\":[0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,2.26040804886098e-05,0.333333333333333,0.666644062586178,0.333333333333333,2.26040804886098e-05,0.666644062586178,0.333333333333333,2.26040804886098e-05,0.666644062586178,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,1.35628161831523e-05,0.399997287436763,0.599989149747054,3.39049711468696e-05,3.39049711468696e-05,0.999932190057706,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.499983047514427,3.39049711468696e-05,0.499983047514427,0.499983047514427,3.39049711468696e-05,0.499983047514427,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.212121959409611,0.272727646371472,0.515150394218917,0.166668079505529,0.20833439296248,0.624997527531991,0.20833439296248,0.333333333333333,0.458332273704187,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,3.39049711468696e-05,0.499983047514427,0.499983047514427,0.999864393908574,6.78030457128134e-05,6.78030457128134e-05,3.39049711468696e-05,0.499983047514427,0.499983047514427,0.333333333333333,0.333333333333333,0.333333333333333,3.39049711468696e-05,0.999932190057706,3.39049711468696e-05,0.333333333333333,0.333333333333333,0.333333333333333,0.312500264906164,0.125002649061639,0.562497086032197,0.142859910851215,0.428570044574393,0.428570044574393,6.78030457128134e-05,0.999864393908574,6.78030457128134e-05,0.333333333333333,0.333333333333333,0.333333333333333,6.78030457128134e-05,6.78030457128134e-05,0.999864393908574,0.333333333333333,0.333333333333333,0.333333333333333,0.28571566969121,0.28571566969121,0.42856866061758,0.166668550446493,0.333333333333333,0.499998116220173,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.200005425126473,0.599989149747054,0.200005425126473,3.39049711468696e-05,0.999932190057706,3.39049711468696e-05,0.250004238336944,0.499991523326111,0.250004238336944]},\"columns\":[{\"id\":\"roast_preference\",\"name\":\"roast_preference\",\"type\":\"character\"},{\"id\":\"cup_per_day\",\"name\":\"cup_per_day\",\"type\":\"character\"},{\"id\":\"home_brew_mr_coffee\",\"name\":\"home_brew_mr_coffee\",\"type\":\"character\"},{\"id\":\"favorite_coffee_drink\",\"name\":\"favorite_coffee_drink\",\"type\":\"character\"},{\"id\":\"n\",\"name\":\"n\",\"type\":\"numeric\"}],\"filterable\":true,\"searchable\":true,\"dataKey\":\"e882a86ebf9320dbe8539fe8cc9c4db0\"},\"children\":[]},\"class\":\"reactR_markup\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nroast_pref_func(\n  dag_table = dag_fit$roast_preference$prob[1:3, 1:3, 1, 1, 1, 1, 1:2, 1, 1, 1, 1, 1, 1:8],\n  x = cup_per_day,\n  y = n,\n  fill = roast_preference,\n  facet_x = favorite_coffee_drink,\n  facet_y = home_brew_pods\n) +\n  labs(\n    title = \"Probability of Coffee Roast Preference From the Great American Tasting\",\n    subtitle = \"Based on Gender, Age, Cups Per Day, and Whether Participants Brew at Home Using Pods\",\n    x = \"\",\n    y = \"Probability\",\n    fill = \"\"\n  ) +\n  theme(\n    legend.position = \"bottom\"\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-37-1.png){width=768}\n:::\n\n```{.r .cell-code}\ndag_fit$roast_preference$prob[1:3, 1:3, 1, 1, 1, 1, 1:2, 1, 1, 1, 1, 1, 1:8] |>\nas_tibble() |>\n  reactable(\n    filterable = TRUE,\n    searchable = TRUE\n  )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"reactable html-widget html-fill-item\" id=\"htmlwidget-638c24ac95dd61b1e898\" style=\"width:auto;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-638c24ac95dd61b1e898\">{\"x\":{\"tag\":{\"name\":\"Reactable\",\"attribs\":{\"data\":{\"roast_preference\":[\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\"],\"cup_per_day\":[\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\"],\"home_brew_pods\":[\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\"],\"favorite_coffee_drink\":[\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\"],\"n\":[0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.499983047514427,0.499983047514427,3.39049711468696e-05,6.78030457128134e-05,6.78030457128134e-05,0.999864393908574,3.39049711468696e-05,3.39049711468696e-05,0.999932190057706,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.499983047514427,3.39049711468696e-05,0.499983047514427,0.999932190057706,3.39049711468696e-05,3.39049711468696e-05,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,3.39049711468696e-05,3.39049711468696e-05,0.999932190057706,0.499983047514427,0.499983047514427,3.39049711468696e-05,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.200005425126473,0.200005425126473,0.599989149747054,0.42856866061758,0.28571566969121,0.28571566969121,6.78030457128134e-05,6.78030457128134e-05,0.999864393908574,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,6.78030457128134e-05,0.999864393908574,6.78030457128134e-05,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,3.39049711468696e-05,0.999932190057706,3.39049711468696e-05,0.333333333333333,0.333333333333333,0.333333333333333,0.499994348788267,0.166672317878399,0.333333333333333,0.250002119222364,0.250002119222364,0.499995761555272,6.78030457128134e-05,6.78030457128134e-05,0.999864393908574,0.333333333333333,0.333333333333333,0.333333333333333,6.78030457128134e-05,6.78030457128134e-05,0.999864393908574,0.333333333333333,0.333333333333333,0.333333333333333,0.666644062586178,2.26040804886098e-05,0.333333333333333,0.214287444282009,0.285714977712804,0.499997578005187,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333]},\"columns\":[{\"id\":\"roast_preference\",\"name\":\"roast_preference\",\"type\":\"character\"},{\"id\":\"cup_per_day\",\"name\":\"cup_per_day\",\"type\":\"character\"},{\"id\":\"home_brew_pods\",\"name\":\"home_brew_pods\",\"type\":\"character\"},{\"id\":\"favorite_coffee_drink\",\"name\":\"favorite_coffee_drink\",\"type\":\"character\"},{\"id\":\"n\",\"name\":\"n\",\"type\":\"numeric\"}],\"filterable\":true,\"searchable\":true,\"dataKey\":\"dec76d8590624547e320161b9c90d6d1\"},\"children\":[]},\"class\":\"reactR_markup\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nroast_pref_func(\n  dag_table = dag_fit$roast_preference$prob[1:3, 1:3, 1, 1, 1, 1, 1, 1:2, 1, 1, 1, 1, 1:8],\n  x = cup_per_day,\n  y = n,\n  fill = roast_preference,\n  facet_x = favorite_coffee_drink,\n  facet_y = home_brew_instant\n) +\n  labs(\n    title = \"Probability of Coffee Roast Preference From the Great American Tasting\",\n    subtitle = \"Based on Gender, Age, Cups Per Day, and Whether Participants Brew at Home Using Instant Coffee\",\n    x = \"\",\n    y = \"Probability\",\n    fill = \"\"\n  ) +\n  theme(\n    legend.position = \"bottom\"\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-38-1.png){width=768}\n:::\n\n```{.r .cell-code}\ndag_fit$roast_preference$prob[1:3, 1:3, 1, 1, 1, 1, 1, 1:2, 1, 1, 1, 1, 1:8] |>\nas_tibble() |>\n  reactable(\n    filterable = TRUE,\n    searchable = TRUE\n  )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"reactable html-widget html-fill-item\" id=\"htmlwidget-70c00ca10a73b8b1c7f8\" style=\"width:auto;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-70c00ca10a73b8b1c7f8\">{\"x\":{\"tag\":{\"name\":\"Reactable\",\"attribs\":{\"data\":{\"roast_preference\":[\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\"],\"cup_per_day\":[\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\"],\"home_brew_instant\":[\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\"],\"favorite_coffee_drink\":[\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\"],\"n\":[0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,6.78030457128134e-05,0.999864393908574,6.78030457128134e-05,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,6.78030457128134e-05,6.78030457128134e-05,0.999864393908574,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.999864393908574,6.78030457128134e-05,6.78030457128134e-05,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,3.39049711468696e-05,0.999932190057706,3.39049711468696e-05,0.333333333333333,0.333333333333333,0.333333333333333,3.39049711468696e-05,0.499983047514427,0.499983047514427,0.499983047514427,0.499983047514427,3.39049711468696e-05,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,6.78030457128134e-05,6.78030457128134e-05,0.999864393908574,0.333333333333333,0.333333333333333,0.333333333333333,0.999864393908574,6.78030457128134e-05,6.78030457128134e-05,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333]},\"columns\":[{\"id\":\"roast_preference\",\"name\":\"roast_preference\",\"type\":\"character\"},{\"id\":\"cup_per_day\",\"name\":\"cup_per_day\",\"type\":\"character\"},{\"id\":\"home_brew_instant\",\"name\":\"home_brew_instant\",\"type\":\"character\"},{\"id\":\"favorite_coffee_drink\",\"name\":\"favorite_coffee_drink\",\"type\":\"character\"},{\"id\":\"n\",\"name\":\"n\",\"type\":\"numeric\"}],\"filterable\":true,\"searchable\":true,\"dataKey\":\"fd7bea6ac5cdf94ac7128ec2c1e73ab2\"},\"children\":[]},\"class\":\"reactR_markup\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nroast_pref_func(\n  dag_table = dag_fit$roast_preference$prob[1:3, 1:3, 1, 1, 1, 1, 1, 1, 1:2, 1, 1, 1, 1:8],\n  x = cup_per_day,\n  y = n,\n  fill = roast_preference,\n  facet_x = favorite_coffee_drink,\n  facet_y = home_brew_bean2cup\n) +\n  labs(\n    title = \"Probability of Coffee Roast Preference From the Great American Tasting\",\n    subtitle = \"Based on Gender, Age, Cups Per Day, and Whether Participants Brew at Home Using a Bean 2 Cup Machine\",\n    x = \"\",\n    y = \"Probability\",\n    fill = \"\"\n  ) +\n  theme(\n    legend.position = \"bottom\"\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-39-1.png){width=768}\n:::\n\n```{.r .cell-code}\ndag_fit$roast_preference$prob[1:3, 1:3, 1, 1, 1, 1, 1, 1, 1:2, 1, 1, 1, 1:8] |>\nas_tibble() |>\n  reactable(\n    filterable = TRUE,\n    searchable = TRUE\n  )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"reactable html-widget html-fill-item\" id=\"htmlwidget-bd4a76daae4e1ff4a1c4\" style=\"width:auto;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-bd4a76daae4e1ff4a1c4\">{\"x\":{\"tag\":{\"name\":\"Reactable\",\"attribs\":{\"data\":{\"roast_preference\":[\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\"],\"cup_per_day\":[\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\"],\"home_brew_bean2cup\":[\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\"],\"favorite_coffee_drink\":[\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\"],\"n\":[0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,6.78030457128134e-05,6.78030457128134e-05,0.999864393908574,0.499983047514427,0.499983047514427,3.39049711468696e-05,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,6.78030457128134e-05,6.78030457128134e-05,0.999864393908574,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,6.78030457128134e-05,0.999864393908574,6.78030457128134e-05,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,6.78030457128134e-05,6.78030457128134e-05,0.999864393908574,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,6.78030457128134e-05,0.999864393908574,6.78030457128134e-05,6.78030457128134e-05,6.78030457128134e-05,0.999864393908574,0.333333333333333,0.333333333333333,0.333333333333333,3.39049711468696e-05,0.999932190057706,3.39049711468696e-05,0.333333333333333,0.333333333333333,0.333333333333333,0.999932190057706,3.39049711468696e-05,3.39049711468696e-05,0.250004238336944,1.69533477775856e-05,0.749978808315278,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,6.78030457128134e-05,6.78030457128134e-05,0.999864393908574,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,3.39049711468696e-05,0.999932190057706,3.39049711468696e-05,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333]},\"columns\":[{\"id\":\"roast_preference\",\"name\":\"roast_preference\",\"type\":\"character\"},{\"id\":\"cup_per_day\",\"name\":\"cup_per_day\",\"type\":\"character\"},{\"id\":\"home_brew_bean2cup\",\"name\":\"home_brew_bean2cup\",\"type\":\"character\"},{\"id\":\"favorite_coffee_drink\",\"name\":\"favorite_coffee_drink\",\"type\":\"character\"},{\"id\":\"n\",\"name\":\"n\",\"type\":\"numeric\"}],\"filterable\":true,\"searchable\":true,\"dataKey\":\"d46c9a8e7bc700343021c4111adbb7b8\"},\"children\":[]},\"class\":\"reactR_markup\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nroast_pref_func(\n  dag_table = dag_fit$roast_preference$prob[1:3, 1:3, 1, 1, 1, 1, 1, 1, 1, 1:2, 1, 1, 1:8],\n  x = cup_per_day,\n  y = n,\n  fill = roast_preference,\n  facet_x = favorite_coffee_drink,\n  facet_y = home_brew_cold_brew\n) +\n  labs(\n    title = \"Probability of Coffee Roast Preference From the Great American Tasting\",\n    subtitle = \"Based on Gender, Age, Cups Per Day, and Whether Participants Brew Cold Brew at Home\",\n    x = \"\",\n    y = \"Probability\",\n    fill = \"\"\n  ) +\n  theme(\n    legend.position = \"bottom\"\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-40-1.png){width=768}\n:::\n\n```{.r .cell-code}\ndag_fit$roast_preference$prob[1:3, 1:3, 1, 1, 1, 1, 1, 1, 1, 1:2, 1, 1, 1:8] |>\nas_tibble() |>\n  reactable(\n    filterable = TRUE,\n    searchable = TRUE\n  )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"reactable html-widget html-fill-item\" id=\"htmlwidget-57d37090663ef84b312c\" style=\"width:auto;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-57d37090663ef84b312c\">{\"x\":{\"tag\":{\"name\":\"Reactable\",\"attribs\":{\"data\":{\"roast_preference\":[\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\"],\"cup_per_day\":[\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\"],\"home_brew_cold_brew\":[\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\"],\"favorite_coffee_drink\":[\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\"],\"n\":[0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,6.78030457128134e-05,6.78030457128134e-05,0.999864393908574,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,3.39049711468696e-05,0.999932190057706,3.39049711468696e-05,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,6.78030457128134e-05,0.999864393908574,6.78030457128134e-05,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,6.78030457128134e-05,6.78030457128134e-05,0.999864393908574,0.333333333333333,0.333333333333333,0.333333333333333,3.39049711468696e-05,0.499983047514427,0.499983047514427,0.10000474708224,0.10000474708224,0.79999050583552,2.26040804886098e-05,2.26040804886098e-05,0.999954791839023,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333]},\"columns\":[{\"id\":\"roast_preference\",\"name\":\"roast_preference\",\"type\":\"character\"},{\"id\":\"cup_per_day\",\"name\":\"cup_per_day\",\"type\":\"character\"},{\"id\":\"home_brew_cold_brew\",\"name\":\"home_brew_cold_brew\",\"type\":\"character\"},{\"id\":\"favorite_coffee_drink\",\"name\":\"favorite_coffee_drink\",\"type\":\"character\"},{\"id\":\"n\",\"name\":\"n\",\"type\":\"numeric\"}],\"filterable\":true,\"searchable\":true,\"dataKey\":\"3b72d75fc8fe2d7b844cb540e3c98327\"},\"children\":[]},\"class\":\"reactR_markup\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nroast_pref_func(\n  dag_table = dag_fit$roast_preference$prob[1:3, 1:3, 1, 1, 1, 1, 1, 1, 1, 1, 1:2, 1, 1:8],\n  x = cup_per_day,\n  y = n,\n  fill = roast_preference,\n  facet_x = favorite_coffee_drink,\n  facet_y = home_brew_cometeer\n) +\n  labs(\n    title = \"Probability of Coffee Roast Preference From the Great American Tasting\",\n    subtitle = \"Based on Gender, Age, Cups Per Day, and Whether Participants Brew at Home Using Cometeer\",\n    x = \"\",\n    y = \"Probability\",\n    fill = \"\"\n  ) +\n  theme(\n    legend.position = \"bottom\"\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-41-1.png){width=768}\n:::\n\n```{.r .cell-code}\ndag_fit$roast_preference$prob[1:3, 1:3, 1, 1, 1, 1, 1, 1, 1, 1, 1:2, 1, 1:8] |>\nas_tibble() |>\n  reactable(\n    filterable = TRUE,\n    searchable = TRUE\n  )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"reactable html-widget html-fill-item\" id=\"htmlwidget-f2421537016949050280\" style=\"width:auto;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-f2421537016949050280\">{\"x\":{\"tag\":{\"name\":\"Reactable\",\"attribs\":{\"data\":{\"roast_preference\":[\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\"],\"cup_per_day\":[\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\"],\"home_brew_cometeer\":[\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\"],\"favorite_coffee_drink\":[\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\"],\"n\":[0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.999864393908574,6.78030457128134e-05,6.78030457128134e-05,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,6.78030457128134e-05,0.999864393908574,6.78030457128134e-05,6.78030457128134e-05,6.78030457128134e-05,0.999864393908574,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,6.78030457128134e-05,0.999864393908574,6.78030457128134e-05,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,3.39049711468696e-05,0.999932190057706,3.39049711468696e-05,0.333333333333333,0.333333333333333,0.333333333333333,6.78030457128134e-05,6.78030457128134e-05,0.999864393908574,0.999864393908574,6.78030457128134e-05,6.78030457128134e-05,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,6.78030457128134e-05,6.78030457128134e-05,0.999864393908574,0.333333333333333,0.333333333333333,0.333333333333333,3.39049711468696e-05,3.39049711468696e-05,0.999932190057706,2.26040804886098e-05,0.333333333333333,0.666644062586178,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.999864393908574,6.78030457128134e-05,6.78030457128134e-05,6.78030457128134e-05,0.999864393908574,6.78030457128134e-05]},\"columns\":[{\"id\":\"roast_preference\",\"name\":\"roast_preference\",\"type\":\"character\"},{\"id\":\"cup_per_day\",\"name\":\"cup_per_day\",\"type\":\"character\"},{\"id\":\"home_brew_cometeer\",\"name\":\"home_brew_cometeer\",\"type\":\"character\"},{\"id\":\"favorite_coffee_drink\",\"name\":\"favorite_coffee_drink\",\"type\":\"character\"},{\"id\":\"n\",\"name\":\"n\",\"type\":\"numeric\"}],\"filterable\":true,\"searchable\":true,\"dataKey\":\"1ca38ec4d6aa23b0fc8bf8ff4f8ad27e\"},\"children\":[]},\"class\":\"reactR_markup\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nroast_pref_func(\n  dag_table = dag_fit$roast_preference$prob[1:3, 1:3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1:2, 1:8],\n  x = cup_per_day,\n  y = n,\n  fill = roast_preference,\n  facet_x = favorite_coffee_drink,\n  facet_y = home_brew_other\n) +\n  labs(\n    title = \"Probability of Coffee Roast Preference From the Great American Tasting\",\n    subtitle = \"Based on Gender, Age, Cups Per Day, and Whether Participants Brew at Home Using an Other Method\",\n    x = \"\",\n    y = \"Probability\",\n    fill = \"\"\n  ) +\n  theme(\n    legend.position = \"bottom\"\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-42-1.png){width=768}\n:::\n\n```{.r .cell-code}\ndag_fit$roast_preference$prob[1:3, 1:3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1:2, 1:8] |>\nas_tibble() |>\n  reactable(\n    filterable = TRUE,\n    searchable = TRUE\n  )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"reactable html-widget html-fill-item\" id=\"htmlwidget-71b1f6e077aca11beeff\" style=\"width:auto;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-71b1f6e077aca11beeff\">{\"x\":{\"tag\":{\"name\":\"Reactable\",\"attribs\":{\"data\":{\"roast_preference\":[\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\",\"dark\",\"light\",\"medium\"],\"cup_per_day\":[\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\",\"2\",\"2\",\"2\",\"one_or_less\",\"one_or_less\",\"one_or_less\",\"three_or_more\",\"three_or_more\",\"three_or_more\"],\"home_brew_other\":[\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\"],\"favorite_coffee_drink\":[\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"americano\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cappuccino\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"cortado\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"drip\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"espresso\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"latte\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"other\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\",\"pourover\"],\"n\":[0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.166672317878399,0.499994348788267,0.333333333333333,0.250002119222364,0.374998940388818,0.374998940388818,6.78030457128134e-05,0.999864393908574,6.78030457128134e-05,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.222224733900269,0.444441932766397,0.333333333333333,0.200002712618423,0.200002712618423,0.599994574763155,6.78030457128134e-05,0.999864393908574,6.78030457128134e-05,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,3.39049711468696e-05,0.999932190057706,3.39049711468696e-05,7.53503414123969e-06,0.333333333333333,0.666659131632525,6.78030457128134e-05,6.78030457128134e-05,0.999864393908574,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.111113622817547,0.55555304384912,0.333333333333333,0.0714323774204205,0.428570044574393,0.499997578005187,6.78030457128134e-05,6.78030457128134e-05,0.999864393908574,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,6.78030457128134e-05,0.999864393908574,6.78030457128134e-05,9.68783846885651e-06,0.42856866061758,0.571421651543951,0.499983047514427,0.499983047514427,3.39049711468696e-05,0.333333333333333,0.333333333333333,0.333333333333333,3.39049711468696e-05,0.999932190057706,3.39049711468696e-05,0.333333333333333,0.333333333333333,0.333333333333333,6.16505327222533e-06,0.363635803176975,0.636358031769752,0.117649640056455,0.294118116373901,0.588232243569644,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,6.78030457128134e-05,6.78030457128134e-05,0.999864393908574,0.333333333333333,0.333333333333333,0.333333333333333,5.65130754302623e-06,0.250001412826886,0.749992935865571,0.0833354525916268,0.374999646790284,0.541664900618089,0.666644062586178,0.333333333333333,2.26040804886098e-05,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.333333333333333,0.111116134467205,0.555550532199461,0.333333333333333,5.21659838139385e-06,0.692302074432512,0.307692708969106,3.39049711468696e-05,0.999932190057706,3.39049711468696e-05]},\"columns\":[{\"id\":\"roast_preference\",\"name\":\"roast_preference\",\"type\":\"character\"},{\"id\":\"cup_per_day\",\"name\":\"cup_per_day\",\"type\":\"character\"},{\"id\":\"home_brew_other\",\"name\":\"home_brew_other\",\"type\":\"character\"},{\"id\":\"favorite_coffee_drink\",\"name\":\"favorite_coffee_drink\",\"type\":\"character\"},{\"id\":\"n\",\"name\":\"n\",\"type\":\"numeric\"}],\"filterable\":true,\"searchable\":true,\"dataKey\":\"593dd72b2bf2c02870b14f1a94c24e23\"},\"children\":[]},\"class\":\"reactR_markup\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n### Expertise Level - CPT\n\nHere are the probabilities of expertise level based on coffee roast preference. Explanations are hard to be made for this because the probabilities do not differ by much based on roast level.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nexpertise_tbl <- dag_fit$expertise$prob |> as_tibble() |>\n  mutate(\n    roast_preference = str_to_title(roast_preference),\n    across(\n      -n,\n      ~as.factor(.x)\n    ),\n    expertise = fct_relevel(\n      expertise,\n      \"1\",\n      \"2\",\n      \"3\",\n      \"4\",\n      \"5\",\n      \"6\",\n      \"7\",\n      \"8\",\n      \"9\",\n      \"10\"\n    ),\n    roast_preference = fct_relevel(\n      roast_preference,\n      \"Light\",\n      \"Medium\",\n      \"Dark\"\n    )\n  ) \n\nexpertise_tbl |>\n  ggplot(\n    aes(\n      roast_preference,\n      n\n    )\n  ) +\n  geom_col(\n    aes(\n      fill = expertise\n    ),\n    position = position_dodge()\n  ) +\n  geom_text(\n    data = expertise_tbl |> filter(roast_preference == \"Light\"),\n    aes(\n      label = expertise,\n      group = expertise,\n      color = expertise\n    ),\n    position = position_dodge(width = .9),\n    vjust = -.5\n  ) +\n   labs(\n    title = \"Probability of Self-Defined Expertise Level From The Great American Tasting\",\n    subtitle = \"Based on Coffee Roast Preference\",\n    x = \"\",\n    y = \"Probability\",\n    caption = \"Note: Probabilities range from 0 to 1. The scale is reduced to visually compare groups.\"\n  ) +\n  viridis::scale_color_viridis(\n    discrete = TRUE\n    ) +\n  viridis::scale_fill_viridis(\n    discrete = TRUE\n    ) +\n  scale_x_discrete(\n    expand = c(0, .5)\n  ) +\n  theme(\n    legend.position = \"none\",\n    axis.text = element_text(\n      color = \"black\"\n    ),\n    axis.title = element_text(\n      color = \"black\"\n    ),\n    plot.title = element_text(\n      color = \"black\"\n    ),\n    plot.subtitle = element_text(\n      color = \"black\"\n    ),\n    plot.caption = element_text(\n      color = \"black\"\n    )\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-43-1.png){width=768}\n:::\n\n```{.r .cell-code}\nexpertise_tbl |>\nas_tibble() |>\n  reactable(\n    filterable = TRUE,\n    searchable = TRUE\n  )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"reactable html-widget html-fill-item\" id=\"htmlwidget-b501cfa83cbdf4107bfa\" style=\"width:auto;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-b501cfa83cbdf4107bfa\">{\"x\":{\"tag\":{\"name\":\"Reactable\",\"attribs\":{\"data\":{\"expertise\":[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\"],\"roast_preference\":[\"Dark\",\"Dark\",\"Dark\",\"Dark\",\"Dark\",\"Dark\",\"Dark\",\"Dark\",\"Dark\",\"Dark\",\"Light\",\"Light\",\"Light\",\"Light\",\"Light\",\"Light\",\"Light\",\"Light\",\"Light\",\"Light\",\"Medium\",\"Medium\",\"Medium\",\"Medium\",\"Medium\",\"Medium\",\"Medium\",\"Medium\",\"Medium\",\"Medium\"],\"n\":[0.0647716682199441,0.0535880708294501,0.101118359739049,0.134669151910531,0.207362534948742,0.18219944082013,0.184995340167754,0.0507921714818267,0.0116495806150979,0.00885368126747437,0.0110794877007522,0.0257166090668835,0.0348648099207156,0.0598698922545233,0.115368977434438,0.229416548078878,0.293453954055702,0.182455783695873,0.0354746899776377,0.0122992478145965,0.0328632251197445,0.0464342735497605,0.0863491218733369,0.107903139968068,0.179749866950506,0.234034060670569,0.203698775944651,0.0935337945715806,0.0113092070250133,0.00412453432676956]},\"columns\":[{\"id\":\"expertise\",\"name\":\"expertise\",\"type\":\"factor\"},{\"id\":\"roast_preference\",\"name\":\"roast_preference\",\"type\":\"factor\"},{\"id\":\"n\",\"name\":\"n\",\"type\":\"numeric\"}],\"filterable\":true,\"searchable\":true,\"dataKey\":\"6ecbebcebf047dad91314027f6a043b1\"},\"children\":[]},\"class\":\"reactR_markup\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n### Favorite Coffee (A, B, C, D) - CPT\n\nThere are a lot of probabilities for participants' favorite coffee based on their self-defined expertise level and coffee roast preference. It may be easier to follow along with the table rather than the visual.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfavorite_abcd_prob <- dag_fit$favorite_abcd$prob |> as_tibble() |>\n  mutate(\n    across(\n      -n,\n      ~as.factor(.x)\n    ),\n    expertise = fct_relevel(\n      expertise,\n      \"1\",\n      \"2\",\n      \"3\",\n      \"4\",\n      \"5\",\n      \"6\",\n      \"7\",\n      \"8\",\n      \"9\",\n      \"10\"\n    ),\n    roast_preference = fct_relevel(\n      roast_preference,\n      \"light\",\n      \"medium\",\n      \"dark\"\n    ),\n    favorite_abcd = fct_relevel(\n      favorite_abcd,\n      \"Coffee A\",\n      \"Coffee B\",\n      \"Coffee C\",\n      \"Coffee D\"\n    )\n  )\n\n# scales::show_col(viridis::viridis_pal(option = \"E\")(3))\n\nfavorite_abcd_prob |>\n  ggplot(\n    aes(\n      favorite_abcd,\n      n\n    )\n  ) +\n  geom_col(\n    aes(\n      fill = roast_preference\n    ),\n    position = position_dodge()\n  ) +\n  geom_text(\n    data = favorite_abcd_prob |>\n    filter(\n        expertise == \"4\" &\n      favorite_abcd == \"Coffee D\" &\n      roast_preference == \"light\"\n    ),\n    label = \"Light\\nRoast\",\n    nudge_y = .03,\n    color = \"#00204DFF\"\n  ) +\n  geom_text(\n    data = favorite_abcd_prob |>\n    filter(\n        expertise == \"4\" &\n      favorite_abcd == \"Coffee C\" &\n      roast_preference == \"medium\"\n    ),\n    label = \"Medium\\nRoast\",\n    nudge_y = .03,\n    color = \"#7C7B78FF\"\n  ) +\n  geom_text(\n    data = favorite_abcd_prob |>\n    filter(\n        expertise == \"4\" &\n      favorite_abcd == \"Coffee B\" &\n      roast_preference == \"dark\"\n    ),\n    label = \"Dark\\nRoast\",\n    nudge_y = .03,\n    color = \"#FFEA46FF\"\n  ) +\n  facet_wrap(\n    ~expertise,\n    ncol = 5\n  ) +\n  scale_y_continuous(\n    breaks = seq(.1, .6, .1)\n  ) +\n  viridis::scale_fill_viridis(\n    discrete = TRUE,\n    option = \"cividis\"\n  ) +\n  labs(\n    title = \"Probability of One's Favorite Coffees From The Great American Tasting\",\n    subtitle = \"Based on Self-Defined Expertise Level & Roast Level Preference\",\n    x = \"\",\n    y = \"Probability\"\n  ) +\n  theme(\n    legend.position = \"none\",\n    strip.background = element_rect(\n      fill = \"#7C7B78FF\"\n    ),\n    axis.text = element_text(\n      color = \"#7C7B78FF\"\n    ),\n    axis.title = element_text(\n      color = \"#7C7B78FF\"\n    ),\n    plot.title = element_text(\n      color = \"#7C7B78FF\"\n    ),\n    plot.subtitle = element_text(\n      color = \"#7C7B78FF\"\n    )\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-44-1.png){width=1152}\n:::\n\n```{.r .cell-code}\nfavorite_abcd_prob |>\nas_tibble() |>\n  reactable(\n    filterable = TRUE,\n    searchable = TRUE\n  )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"reactable html-widget html-fill-item\" id=\"htmlwidget-4737e851c4248b5ae93b\" style=\"width:auto;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-4737e851c4248b5ae93b\">{\"x\":{\"tag\":{\"name\":\"Reactable\",\"attribs\":{\"data\":{\"favorite_abcd\":[\"Coffee A\",\"Coffee B\",\"Coffee C\",\"Coffee D\",\"Coffee A\",\"Coffee B\",\"Coffee C\",\"Coffee D\",\"Coffee A\",\"Coffee B\",\"Coffee C\",\"Coffee D\",\"Coffee A\",\"Coffee B\",\"Coffee C\",\"Coffee D\",\"Coffee A\",\"Coffee B\",\"Coffee C\",\"Coffee D\",\"Coffee A\",\"Coffee B\",\"Coffee C\",\"Coffee D\",\"Coffee A\",\"Coffee B\",\"Coffee C\",\"Coffee D\",\"Coffee A\",\"Coffee B\",\"Coffee C\",\"Coffee D\",\"Coffee A\",\"Coffee B\",\"Coffee C\",\"Coffee D\",\"Coffee A\",\"Coffee B\",\"Coffee C\",\"Coffee D\",\"Coffee A\",\"Coffee B\",\"Coffee C\",\"Coffee D\",\"Coffee A\",\"Coffee B\",\"Coffee C\",\"Coffee D\",\"Coffee A\",\"Coffee B\",\"Coffee C\",\"Coffee D\",\"Coffee A\",\"Coffee B\",\"Coffee C\",\"Coffee D\",\"Coffee A\",\"Coffee B\",\"Coffee C\",\"Coffee D\",\"Coffee A\",\"Coffee B\",\"Coffee C\",\"Coffee D\",\"Coffee A\",\"Coffee B\",\"Coffee C\",\"Coffee D\",\"Coffee A\",\"Coffee B\",\"Coffee C\",\"Coffee D\",\"Coffee A\",\"Coffee B\",\"Coffee C\",\"Coffee D\",\"Coffee A\",\"Coffee B\",\"Coffee C\",\"Coffee D\",\"Coffee A\",\"Coffee B\",\"Coffee C\",\"Coffee D\",\"Coffee A\",\"Coffee B\",\"Coffee C\",\"Coffee D\",\"Coffee A\",\"Coffee B\",\"Coffee C\",\"Coffee D\",\"Coffee A\",\"Coffee B\",\"Coffee C\",\"Coffee D\",\"Coffee A\",\"Coffee B\",\"Coffee C\",\"Coffee D\",\"Coffee A\",\"Coffee B\",\"Coffee C\",\"Coffee D\",\"Coffee A\",\"Coffee B\",\"Coffee C\",\"Coffee D\",\"Coffee A\",\"Coffee B\",\"Coffee C\",\"Coffee D\",\"Coffee A\",\"Coffee B\",\"Coffee C\",\"Coffee D\",\"Coffee A\",\"Coffee B\",\"Coffee C\",\"Coffee D\"],\"roast_preference\":[\"dark\",\"dark\",\"dark\",\"dark\",\"light\",\"light\",\"light\",\"light\",\"medium\",\"medium\",\"medium\",\"medium\",\"dark\",\"dark\",\"dark\",\"dark\",\"light\",\"light\",\"light\",\"light\",\"medium\",\"medium\",\"medium\",\"medium\",\"dark\",\"dark\",\"dark\",\"dark\",\"light\",\"light\",\"light\",\"light\",\"medium\",\"medium\",\"medium\",\"medium\",\"dark\",\"dark\",\"dark\",\"dark\",\"light\",\"light\",\"light\",\"light\",\"medium\",\"medium\",\"medium\",\"medium\",\"dark\",\"dark\",\"dark\",\"dark\",\"light\",\"light\",\"light\",\"light\",\"medium\",\"medium\",\"medium\",\"medium\",\"dark\",\"dark\",\"dark\",\"dark\",\"light\",\"light\",\"light\",\"light\",\"medium\",\"medium\",\"medium\",\"medium\",\"dark\",\"dark\",\"dark\",\"dark\",\"light\",\"light\",\"light\",\"light\",\"medium\",\"medium\",\"medium\",\"medium\",\"dark\",\"dark\",\"dark\",\"dark\",\"light\",\"light\",\"light\",\"light\",\"medium\",\"medium\",\"medium\",\"medium\",\"dark\",\"dark\",\"dark\",\"dark\",\"light\",\"light\",\"light\",\"light\",\"medium\",\"medium\",\"medium\",\"medium\",\"dark\",\"dark\",\"dark\",\"dark\",\"light\",\"light\",\"light\",\"light\",\"medium\",\"medium\",\"medium\",\"medium\"],\"expertise\":[\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"1\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"2\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"3\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"4\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"5\",\"6\",\"6\",\"6\",\"6\",\"6\",\"6\",\"6\",\"6\",\"6\",\"6\",\"6\",\"6\",\"7\",\"7\",\"7\",\"7\",\"7\",\"7\",\"7\",\"7\",\"7\",\"7\",\"7\",\"7\",\"8\",\"8\",\"8\",\"8\",\"8\",\"8\",\"8\",\"8\",\"8\",\"8\",\"8\",\"8\",\"9\",\"9\",\"9\",\"9\",\"9\",\"9\",\"9\",\"9\",\"9\",\"9\",\"9\",\"9\",\"10\",\"10\",\"10\",\"10\",\"10\",\"10\",\"10\",\"10\",\"10\",\"10\",\"10\",\"10\"],\"n\":[0.0881294964028777,0.303956834532374,0.390287769784173,0.217625899280576,0.16743119266055,0.33256880733945,0.222477064220183,0.277522935779817,0.268218623481781,0.438259109311741,0.171052631578947,0.12246963562753,0.210869565217391,0.419565217391304,0.210869565217391,0.158695652173913,0.190711462450593,0.356719367588933,0.190711462450593,0.261857707509881,0.172636103151862,0.310171919770774,0.310171919770774,0.20702005730659,0.16705069124424,0.277649769585253,0.415898617511521,0.139400921658986,0.175655976676385,0.263119533527697,0.175655976676385,0.385568513119534,0.203775038520801,0.370184899845917,0.268489984591679,0.157550077041602,0.125432525951557,0.374567474048443,0.312283737024221,0.187716262975779,0.204159592529711,0.173599320882852,0.163412563667233,0.458828522920204,0.214858199753391,0.237053020961776,0.362823674475956,0.185265104808878,0.121910112359551,0.391573033707865,0.351123595505618,0.135393258426966,0.259251101321586,0.111233480176211,0.132378854625551,0.497136563876652,0.19559585492228,0.262213175425611,0.284418948926721,0.257772020725389,0.0466751918158568,0.414961636828645,0.384271099744246,0.154092071611253,0.252658396101019,0.101129818342933,0.101129818342933,0.545081967213115,0.184337691870381,0.266202387720296,0.296901648664014,0.25255827174531,0.0761964735516373,0.438916876574307,0.333123425692695,0.15176322418136,0.286889504676134,0.0645133356425355,0.0998441288534811,0.548753030827849,0.192194644023514,0.247060744611365,0.290169823644677,0.270574787720444,0.112385321100917,0.607798165137615,0.222477064220184,0.0573394495412844,0.270891364902507,0.0636490250696379,0.0569637883008357,0.608495821727019,0.145448079658606,0.205192034139403,0.299075391180654,0.350284495021337,0.01,0.25,0.49,0.25,0.275787965616046,0.0522922636103152,0.0694842406876791,0.60243553008596,0.214705882352941,0.144117647058824,0.426470588235294,0.214705882352941,0.0131578947368421,0.328947368421053,0.0131578947368421,0.644736842105263,0.448347107438017,0.00206611570247934,0.00206611570247934,0.547520661157025,0.201612903225806,0.201612903225806,0.201612903225806,0.395161290322581]},\"columns\":[{\"id\":\"favorite_abcd\",\"name\":\"favorite_abcd\",\"type\":\"factor\"},{\"id\":\"roast_preference\",\"name\":\"roast_preference\",\"type\":\"factor\"},{\"id\":\"expertise\",\"name\":\"expertise\",\"type\":\"factor\"},{\"id\":\"n\",\"name\":\"n\",\"type\":\"numeric\"}],\"filterable\":true,\"searchable\":true,\"dataKey\":\"81cb5fc7fb9158978e06324ffbd7a3a2\"},\"children\":[]},\"class\":\"reactR_markup\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\n# Queries of Interest\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmale_a <- cpquery(\n  dag_fit,\n  event = (favorite_abcd == \"Coffee A\"),\n  evidence = (gender == \"Male\")\n)\n\nfemale_a <- cpquery(\n  dag_fit,\n  event = (favorite_abcd == \"Coffee A\"),\n  evidence = (gender == \"Female\")\n)\n\nmale_d <- cpquery(\n  dag_fit,\n  event = (favorite_abcd == \"Coffee D\"),\n  evidence = (gender == \"Male\")\n)\n\nfemale_d <- cpquery(\n  dag_fit,\n  event = (favorite_abcd == \"Coffee D\"),\n  evidence = (gender == \"Female\")\n)\n\nmale_ad <- cpquery(\n  dag_fit,\n  event = (favorite_abcd == \"Coffee A\") |\n  (favorite_abcd == \"Coffee D\"),\n  evidence = (gender == \"Male\")\n)\n\nfemale_ad <- cpquery(\n  dag_fit,\n  event = (favorite_abcd == \"Coffee A\") |\n  (favorite_abcd == \"Coffee D\"),\n  evidence = (gender == \"Female\")\n)\n\ntibble(\n  Queries = c(\n    \"Coffee A\", \"Coffee D\", \"Either Coffee A or D\"\n  ),\n  Male = c(male_a, male_d, male_ad),\n  Female = c(female_a, female_d, female_ad)\n) |>\n  mutate(\n    across(\n      -Queries,\n      ~round(.x, 2)\n    )\n  ) |>\n  reactable()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"reactable html-widget html-fill-item\" id=\"htmlwidget-e1f5e1aae010f057230f\" style=\"width:auto;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-e1f5e1aae010f057230f\">{\"x\":{\"tag\":{\"name\":\"Reactable\",\"attribs\":{\"data\":{\"Queries\":[\"Coffee A\",\"Coffee D\",\"Either Coffee A or D\"],\"Male\":[0.21,0.37,0.59],\"Female\":[0.2,0.34,0.54]},\"columns\":[{\"id\":\"Queries\",\"name\":\"Queries\",\"type\":\"character\"},{\"id\":\"Male\",\"name\":\"Male\",\"type\":\"numeric\"},{\"id\":\"Female\",\"name\":\"Female\",\"type\":\"numeric\"}],\"dataKey\":\"75c2eb73c916e1b1bb578bc6be1ff244\"},\"children\":[]},\"class\":\"reactR_markup\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n\n\nWith a reasonable amount of time in the video being spent on male and female differences in preference for coffees A and D, I decided to include some calculations for probabilities for an event with evidence in the model. It is interesting that both males and females has the same probability of preferring coffee A, while males were more likely to prefer coffee D. When the query was whether a participant preferred either coffee A or D, males once again were more likely to enjoy either of the two coffees.\n\n## Probabilities of Coffee A or Coffee D Based on Expertise Level\n\nThe final queries I created were the probability of preferring coffee A or D based on the 10 self-defined expertise levels. These probabilities were extremely interesting because the upper expertise levels were the participants that were more likely to prefer coffees A or D. I'm sure there are additional analyses that could be done with this data, but I think this is where I'll stop. I'm sure including more evidence from the model, such as how participants brew at home and their favorite coffee drinks would paint a better picture.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nexpert1 <- cpquery(\n  dag_fit,\n  event = (favorite_abcd == \"Coffee A\") |\n  (favorite_abcd == \"Coffee D\"),\n  evidence = (expertise == \"1\")\n)\nexpert2 <- cpquery(\n  dag_fit,\n  event = (favorite_abcd == \"Coffee A\") |\n  (favorite_abcd == \"Coffee D\"),\n  evidence = (expertise == \"2\")\n)\nexpert3 <- cpquery(\n  dag_fit,\n  event = (favorite_abcd == \"Coffee A\") |\n  (favorite_abcd == \"Coffee D\"),\n  evidence = (expertise == \"3\")\n)\nexpert4 <- cpquery(\n  dag_fit,\n  event = (favorite_abcd == \"Coffee A\") |\n  (favorite_abcd == \"Coffee D\"),\n  evidence = (expertise == \"4\")\n)\nexpert5 <- cpquery(\n  dag_fit,\n  event = (favorite_abcd == \"Coffee A\") |\n  (favorite_abcd == \"Coffee D\"),\n  evidence = (expertise == \"5\")\n)\nexpert6 <- cpquery(\n  dag_fit,\n  event = (favorite_abcd == \"Coffee A\") |\n  (favorite_abcd == \"Coffee D\"),\n  evidence = (expertise == \"6\")\n)\nexpert7 <- cpquery(\n  dag_fit,\n  event = (favorite_abcd == \"Coffee A\") |\n  (favorite_abcd == \"Coffee D\"),\n  evidence = (expertise == \"7\")\n)\nexpert8 <- cpquery(\n  dag_fit,\n  event = (favorite_abcd == \"Coffee A\") |\n  (favorite_abcd == \"Coffee D\"),\n  evidence = (expertise == \"8\")\n)\nexpert9 <- cpquery(\n  dag_fit,\n  event = (favorite_abcd == \"Coffee A\") |\n  (favorite_abcd == \"Coffee D\"),\n  evidence = (expertise == \"9\")\n)\nexpert10 <- cpquery(\n  dag_fit,\n  event = (favorite_abcd == \"Coffee A\") |\n  (favorite_abcd == \"Coffee D\"),\n  evidence = (expertise == \"10\")\n)\n\ntibble(\n  expertise_level = seq(1, 10, 1),\n  probability_of_a_or_d = c(expert1, expert2, expert3, expert4, expert5, expert6, expert7, expert8, expert9, expert10)\n) |>\n  ggplot(\n    aes(\n      as.factor(expertise_level),\n      probability_of_a_or_d\n    )\n  ) +\n  geom_col(\n    aes(fill = as.factor(expertise_level)),\n    position = position_dodge()\n  ) +\n  geom_text(\n    aes(\n      label = round(probability_of_a_or_d, 2)\n    ),\n    color = \"black\",\n    vjust = -.3\n  ) +\n  scale_y_continuous(\n    limits = c(0, 1),\n    breaks = seq(0, 1, .1)\n  ) +\n  labs(\n    title = \"Probability of Choosing Coffee A or D as Their Favorite Coffee\",\n    subtitle = \"By Level of Self-Defined Expertise\",\n    x = \"Expertise\",\n    y = \"Probability\"\n  ) +\n  scale_fill_brewer(type = \"qual\", palette = \"Set3\") +\n  theme(\n    legend.position = \"none\"\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-46-1.png){width=768}\n:::\n:::",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/core-js-2.5.3/shim.min.js\"></script>\n<script src=\"../../site_libs/react-18.2.0/react.min.js\"></script>\n<script src=\"../../site_libs/react-18.2.0/react-dom.min.js\"></script>\n<script src=\"../../site_libs/reactwidget-2.0.0/react-tools.js\"></script>\n<link href=\"../../site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<link href=\"../../site_libs/reactable-0.4.4/reactable.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/reactable-binding-0.4.4/reactable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}