<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2024-07-10">

<title>Log(J-And-P) - Bayes Net Pt. 2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="../../site_libs/core-js-2.5.3/shim.min.js"></script>
<script src="../../site_libs/react-18.2.0/react.min.js"></script>
<script src="../../site_libs/react-18.2.0/react-dom.min.js"></script>
<script src="../../site_libs/reactwidget-2.0.0/react-tools.umd.cjs"></script>
<link href="../../site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="../../site_libs/reactable-0.4.4/reactable.css" rel="stylesheet">
<script src="../../site_libs/reactable-binding-0.4.4/reactable.js"></script>


<link rel="stylesheet" href="../../jp_style.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Log(J-And-P)</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About Me</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../posts.html"> 
<span class="menu-text">My Posts</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-page">
      <h1 class="title">Bayes Net Pt. 2</h1>
            <p class="subtitle lead"></p><p>Estimation</p><p></p>
                                <div class="quarto-categories">
                <div class="quarto-category">Bayesian</div>
                <div class="quarto-category">Bayesian Network</div>
                <div class="quarto-category">bayes net</div>
                <div class="quarto-category">R</div>
                <div class="quarto-category">stan</div>
                <div class="quarto-category">cmdstanr</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta column-page">

      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">July 10, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
        
    </div>
<!-- main -->
<main class="content quarto-banner-title-block column-page" id="quarto-document-content">





<p><strong>Under Development - Not Complete</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cmdstanr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(posterior)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bayesplot)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_light</span>())</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">mc.cores =</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>(),</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">scipen =</span> <span class="dv">9999</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">color_scheme_set</span>(<span class="st">"viridis"</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>react_table <span class="ot">&lt;-</span> <span class="cf">function</span>(data){</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  reactable<span class="sc">::</span><span class="fu">reactable</span>(</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    {{data}},</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">filterable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">sortable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">highlight =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">searchable =</span> <span class="cn">TRUE</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>As mentioned in the <a href="https://log-of-jandp.com/posts/2024-07-09-bayes-net-introduction/">previous post</a>, the first model I will be running in Stan is a Bayesian Network with 3 latent attributes with edges from these attributes to the 15 observed items. I will be creating the data and I am sure there will be issues since the items and the Q-matrix are being created randomly. Along with using the <code>cmdstanr</code> package to call on Stan for the Bayesian analyses, I am using the <code>posterior</code> package to manipulate the chains, iterations, and draws from the analyses and the <code>bayesplot</code> package to visualize the convergence of each parameter included in the bayes net model. I also love to use whatever table producing package I am interested at the time and create a function with html functionality. Specifically, I always include a feature to filter and highlight specific rows. This time I decided to use the <code>reactable</code> package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>bern_dist <span class="ot">&lt;-</span> <span class="cf">function</span>(prob_value)(</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">30</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> prob_value)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">y1 =</span> <span class="fu">bern_dist</span>(<span class="at">prob =</span> .<span class="dv">7</span>),</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">y2 =</span> <span class="fu">bern_dist</span>(<span class="at">prob =</span> .<span class="dv">74</span>),</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">y3 =</span> <span class="fu">bern_dist</span>(<span class="at">prob =</span> .<span class="dv">88</span>),</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">y4 =</span> <span class="fu">bern_dist</span>(<span class="at">prob =</span> .<span class="dv">90</span>),</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">y5 =</span> <span class="fu">bern_dist</span>(<span class="at">prob =</span> .<span class="dv">64</span>),</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">y6 =</span> <span class="fu">bern_dist</span>(<span class="at">prob =</span> .<span class="dv">61</span>),</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">y7 =</span> <span class="fu">bern_dist</span>(<span class="at">prob =</span> .<span class="dv">79</span>),</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">y8 =</span> <span class="fu">bern_dist</span>(<span class="at">prob =</span> .<span class="dv">89</span>),</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">y9 =</span> <span class="fu">bern_dist</span>(<span class="at">prob =</span> .<span class="dv">81</span>),</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">y10 =</span> <span class="fu">bern_dist</span>(<span class="at">prob =</span> .<span class="dv">54</span>),</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">y11 =</span> <span class="fu">bern_dist</span>(<span class="at">prob =</span> .<span class="dv">60</span>),</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">y12 =</span> <span class="fu">bern_dist</span>(<span class="at">prob =</span> .<span class="dv">46</span>),</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">y13 =</span> <span class="fu">bern_dist</span>(<span class="at">prob =</span> .<span class="dv">37</span>),</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">y14 =</span> <span class="fu">bern_dist</span>(<span class="at">prob =</span> .<span class="dv">3</span>),</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">y15 =</span> <span class="fu">bern_dist</span>(<span class="at">prob =</span> .<span class="dv">65</span>),</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowid_to_column</span>() <span class="sc">|&gt;</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">studentid =</span> rowid</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>q_matrix <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">item_id =</span> <span class="fu">map_chr</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>, <span class="sc">~</span><span class="fu">paste0</span>(<span class="st">"y"</span>, .x)),</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">att1 =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">att2 =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">att3 =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>) </span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>skills <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>skill_combo <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">list</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>), skills)</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(skill_combo)</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> alpha <span class="sc">|&gt;</span></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">att1 =</span> Var1,</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">att2 =</span> Var2,</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">att3 =</span> Var3</span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">class =</span> <span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(alpha)),</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">.before =</span> att1</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The code above is from the previous post as well that discusses the creation of the binary data, the Q-matrix, and the attribute profile matrix.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>stan_file <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">J =</span> <span class="fu">nrow</span>(y[,<span class="sc">-</span><span class="dv">1</span>]),</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">I =</span> <span class="fu">ncol</span>(y[,<span class="sc">-</span><span class="dv">1</span>]),</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">K =</span> <span class="fu">ncol</span>(q_matrix[,<span class="sc">-</span><span class="dv">1</span>]),</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">C =</span> <span class="fu">nrow</span>(alpha),</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> y[,<span class="sc">-</span><span class="dv">1</span>],</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Q =</span> q_matrix[, <span class="sc">-</span><span class="dv">1</span>],</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha =</span> alpha[,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, it is easiest to put your Stan data into a list. So here I take all the tibbles I created for my data, the Q-matrix, and the attribute profile matrix and only call on the columns and rows that are crucial for the bayes net model. For instance, The <strong>J</strong>, <strong>I</strong>, <strong>K</strong>, and <strong>C</strong> list values are all important for looping through:</p>
<ul>
<li><p>J = The number of rows of data; in this case there are 30 “students”</p></li>
<li><p>I = The number of columns in the dataset; which is 15 excluding the first column</p></li>
<li><p>K = The number of latent attributes/skills</p></li>
<li><p>C = The number of rows in the attribute profile matrix. Each row is a latent class with a different set of attribute mastery proficiencies.</p></li>
</ul>
<p>Additionally, we also need to include the actual data to be referenced in our analysis in Stan. For some reason, I decided to shift from <strong>y</strong> for the actual data and then <strong>X</strong> in the analyses. I think I did this from some of the resources I used having X and then other resources using y. In any case, I will draw attention to the data and reference back to the values either being y or X.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"posts/2024-07-10-bayes-net-part2-estimation/simple_bayes_net.stan"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in readLines(stan_file): incomplete final line found on
'C:/Users/Jonathan/Documents/GitHubRepos/log-of-jandp/posts/2024-07-10-bayes-net-part2-estimation/simple_bayes_net.stan'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>In file included from stan/src/stan/model/model_header.hpp:11:
stan/src/stan/model/model_base_crtp.hpp:159: warning: 'stan::math::var stan::model::model_base_crtp&lt;M&gt;::log_prob(std::vector&lt;stan::math::var_value&lt;double&gt;, std::allocator&lt;stan::math::var_value&lt;double&gt; &gt; &gt;&amp;, std::vector&lt;int&gt;&amp;, std::ostream*) const [with M = simple_bayes_net_model_namespace::simple_bayes_net_model; stan::math::var = stan::math::var_value&lt;double&gt;; std::ostream = std::basic_ostream&lt;char&gt;]' was hidden [-Woverloaded-virtual=]
  159 |   inline math::var log_prob(std::vector&lt;math::var&gt;&amp; theta,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>C:/Users/Jonathan/AppData/Local/Temp/Rtmp8cZ17t/model-3aac173c6e5e.hpp:1635: note:   by 'simple_bayes_net_model_namespace::simple_bayes_net_model::log_prob'
 1635 |   log_prob(std::vector&lt;T_&gt;&amp; params_r, std::vector&lt;int&gt;&amp; params_i,
stan/src/stan/model/model_base_crtp.hpp:154: warning: 'double stan::model::model_base_crtp&lt;M&gt;::log_prob(std::vector&lt;double, std::allocator&lt;double&gt; &gt;&amp;, std::vector&lt;int&gt;&amp;, std::ostream*) const [with M = simple_bayes_net_model_namespace::simple_bayes_net_model; std::ostream = std::basic_ostream&lt;char&gt;]' was hidden [-Woverloaded-virtual=]
  154 |   inline double log_prob(std::vector&lt;double&gt;&amp; theta, std::vector&lt;int&gt;&amp; theta_i,
C:/Users/Jonathan/AppData/Local/Temp/Rtmp8cZ17t/model-3aac173c6e5e.hpp:1635: note:   by 'simple_bayes_net_model_namespace::simple_bayes_net_model::log_prob'
 1635 |   log_prob(std::vector&lt;T_&gt;&amp; params_r, std::vector&lt;int&gt;&amp; params_i,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>stan/src/stan/model/model_base_crtp.hpp:96: warning: 'stan::math::var stan::model::model_base_crtp&lt;M&gt;::log_prob(Eigen::Matrix&lt;stan::math::var_value&lt;double&gt;, -1, 1&gt;&amp;, std::ostream*) const [with M = simple_bayes_net_model_namespace::simple_bayes_net_model; stan::math::var = stan::math::var_value&lt;double&gt;; std::ostream = std::basic_ostream&lt;char&gt;]' was hidden [-Woverloaded-virtual=]
   96 |   inline math::var log_prob(Eigen::Matrix&lt;math::var, -1, 1&gt;&amp; theta,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>C:/Users/Jonathan/AppData/Local/Temp/Rtmp8cZ17t/model-3aac173c6e5e.hpp:1635: note:   by 'simple_bayes_net_model_namespace::simple_bayes_net_model::log_prob'
 1635 |   log_prob(std::vector&lt;T_&gt;&amp; params_r, std::vector&lt;int&gt;&amp; params_i,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>stan/src/stan/model/model_base_crtp.hpp:91: warning: 'double stan::model::model_base_crtp&lt;M&gt;::log_prob(Eigen::VectorXd&amp;, std::ostream*) const [with M = simple_bayes_net_model_namespace::simple_bayes_net_model; Eigen::VectorXd = Eigen::Matrix&lt;double, -1, 1&gt;; std::ostream = std::basic_ostream&lt;char&gt;]' was hidden [-Woverloaded-virtual=]
   91 |   inline double log_prob(Eigen::VectorXd&amp; theta,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>C:/Users/Jonathan/AppData/Local/Temp/Rtmp8cZ17t/model-3aac173c6e5e.hpp:1635: note:   by 'simple_bayes_net_model_namespace::simple_bayes_net_model::log_prob'
 1635 |   log_prob(std::vector&lt;T_&gt;&amp; params_r, std::vector&lt;int&gt;&amp; params_i,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>stan/src/stan/model/model_base_crtp.hpp:205: warning: 'void stan::model::model_base_crtp&lt;M&gt;::write_array(stan::rng_t&amp;, std::vector&lt;double, std::allocator&lt;double&gt; &gt;&amp;, std::vector&lt;int&gt;&amp;, std::vector&lt;double, std::allocator&lt;double&gt; &gt;&amp;, bool, bool, std::ostream*) const [with M = simple_bayes_net_model_namespace::simple_bayes_net_model; stan::rng_t = boost::random::mixmax_engine&lt;17, 36, 0&gt;; std::ostream = std::basic_ostream&lt;char&gt;]' was hidden [-Woverloaded-virtual=]
  205 |   void write_array(stan::rng_t&amp; rng, std::vector&lt;double&gt;&amp; theta,</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>C:/Users/Jonathan/AppData/Local/Temp/Rtmp8cZ17t/model-3aac173c6e5e.hpp:1612: note:   by 'simple_bayes_net_model_namespace::simple_bayes_net_model::write_array'
 1612 |   write_array(RNG&amp; base_rng, std::vector&lt;double&gt;&amp; params_r, std::vector&lt;int&gt;&amp;
stan/src/stan/model/model_base_crtp.hpp:136: warning: 'void stan::model::model_base_crtp&lt;M&gt;::write_array(stan::rng_t&amp;, Eigen::VectorXd&amp;, Eigen::VectorXd&amp;, bool, bool, std::ostream*) const [with M = simple_bayes_net_model_namespace::simple_bayes_net_model; stan::rng_t = boost::random::mixmax_engine&lt;17, 36, 0&gt;; Eigen::VectorXd = Eigen::Matrix&lt;double, -1, 1&gt;; std::ostream = std::basic_ostream&lt;char&gt;]' was hidden [-Woverloaded-virtual=]
  136 |   void write_array(stan::rng_t&amp; rng, Eigen::VectorXd&amp; theta,
C:/Users/Jonathan/AppData/Local/Temp/Rtmp8cZ17t/model-3aac173c6e5e.hpp:1612: note:   by 'simple_bayes_net_model_namespace::simple_bayes_net_model::write_array'
 1612 |   write_array(RNG&amp; base_rng, std::vector&lt;double&gt;&amp; params_r, std::vector&lt;int&gt;&amp;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> mod<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> stan_file,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="dv">12345</span>,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter_warmup =</span> <span class="dv">2000</span>,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter_sampling =</span> <span class="dv">2000</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Running MCMC with 4 chains, at most 12 in parallel...

Chain 1 Iteration:    1 / 4000 [  0%]  (Warmup) 
Chain 2 Iteration:    1 / 4000 [  0%]  (Warmup) 
Chain 3 Iteration:    1 / 4000 [  0%]  (Warmup) 
Chain 4 Iteration:    1 / 4000 [  0%]  (Warmup) 
Chain 1 Iteration:  100 / 4000 [  2%]  (Warmup) 
Chain 2 Iteration:  100 / 4000 [  2%]  (Warmup) 
Chain 3 Iteration:  100 / 4000 [  2%]  (Warmup) 
Chain 4 Iteration:  100 / 4000 [  2%]  (Warmup) 
Chain 2 Iteration:  200 / 4000 [  5%]  (Warmup) 
Chain 1 Iteration:  200 / 4000 [  5%]  (Warmup) 
Chain 4 Iteration:  200 / 4000 [  5%]  (Warmup) 
Chain 3 Iteration:  200 / 4000 [  5%]  (Warmup) 
Chain 2 Iteration:  300 / 4000 [  7%]  (Warmup) 
Chain 4 Iteration:  300 / 4000 [  7%]  (Warmup) 
Chain 1 Iteration:  300 / 4000 [  7%]  (Warmup) 
Chain 3 Iteration:  300 / 4000 [  7%]  (Warmup) 
Chain 2 Iteration:  400 / 4000 [ 10%]  (Warmup) 
Chain 4 Iteration:  400 / 4000 [ 10%]  (Warmup) 
Chain 1 Iteration:  400 / 4000 [ 10%]  (Warmup) 
Chain 3 Iteration:  400 / 4000 [ 10%]  (Warmup) 
Chain 2 Iteration:  500 / 4000 [ 12%]  (Warmup) 
Chain 4 Iteration:  500 / 4000 [ 12%]  (Warmup) 
Chain 1 Iteration:  500 / 4000 [ 12%]  (Warmup) 
Chain 3 Iteration:  500 / 4000 [ 12%]  (Warmup) 
Chain 2 Iteration:  600 / 4000 [ 15%]  (Warmup) 
Chain 4 Iteration:  600 / 4000 [ 15%]  (Warmup) 
Chain 1 Iteration:  600 / 4000 [ 15%]  (Warmup) 
Chain 3 Iteration:  600 / 4000 [ 15%]  (Warmup) 
Chain 2 Iteration:  700 / 4000 [ 17%]  (Warmup) 
Chain 4 Iteration:  700 / 4000 [ 17%]  (Warmup) 
Chain 1 Iteration:  700 / 4000 [ 17%]  (Warmup) 
Chain 3 Iteration:  700 / 4000 [ 17%]  (Warmup) 
Chain 2 Iteration:  800 / 4000 [ 20%]  (Warmup) 
Chain 4 Iteration:  800 / 4000 [ 20%]  (Warmup) 
Chain 1 Iteration:  800 / 4000 [ 20%]  (Warmup) 
Chain 3 Iteration:  800 / 4000 [ 20%]  (Warmup) 
Chain 2 Iteration:  900 / 4000 [ 22%]  (Warmup) 
Chain 4 Iteration:  900 / 4000 [ 22%]  (Warmup) 
Chain 3 Iteration:  900 / 4000 [ 22%]  (Warmup) 
Chain 1 Iteration:  900 / 4000 [ 22%]  (Warmup) 
Chain 4 Iteration: 1000 / 4000 [ 25%]  (Warmup) 
Chain 2 Iteration: 1000 / 4000 [ 25%]  (Warmup) 
Chain 3 Iteration: 1000 / 4000 [ 25%]  (Warmup) 
Chain 1 Iteration: 1000 / 4000 [ 25%]  (Warmup) 
Chain 4 Iteration: 1100 / 4000 [ 27%]  (Warmup) 
Chain 2 Iteration: 1100 / 4000 [ 27%]  (Warmup) 
Chain 3 Iteration: 1100 / 4000 [ 27%]  (Warmup) 
Chain 1 Iteration: 1100 / 4000 [ 27%]  (Warmup) 
Chain 4 Iteration: 1200 / 4000 [ 30%]  (Warmup) 
Chain 2 Iteration: 1200 / 4000 [ 30%]  (Warmup) 
Chain 3 Iteration: 1200 / 4000 [ 30%]  (Warmup) 
Chain 1 Iteration: 1200 / 4000 [ 30%]  (Warmup) 
Chain 4 Iteration: 1300 / 4000 [ 32%]  (Warmup) 
Chain 2 Iteration: 1300 / 4000 [ 32%]  (Warmup) 
Chain 3 Iteration: 1300 / 4000 [ 32%]  (Warmup) 
Chain 1 Iteration: 1300 / 4000 [ 32%]  (Warmup) 
Chain 4 Iteration: 1400 / 4000 [ 35%]  (Warmup) 
Chain 2 Iteration: 1400 / 4000 [ 35%]  (Warmup) 
Chain 3 Iteration: 1400 / 4000 [ 35%]  (Warmup) 
Chain 1 Iteration: 1400 / 4000 [ 35%]  (Warmup) 
Chain 4 Iteration: 1500 / 4000 [ 37%]  (Warmup) 
Chain 2 Iteration: 1500 / 4000 [ 37%]  (Warmup) 
Chain 3 Iteration: 1500 / 4000 [ 37%]  (Warmup) 
Chain 1 Iteration: 1500 / 4000 [ 37%]  (Warmup) 
Chain 4 Iteration: 1600 / 4000 [ 40%]  (Warmup) 
Chain 2 Iteration: 1600 / 4000 [ 40%]  (Warmup) 
Chain 3 Iteration: 1600 / 4000 [ 40%]  (Warmup) 
Chain 1 Iteration: 1600 / 4000 [ 40%]  (Warmup) 
Chain 4 Iteration: 1700 / 4000 [ 42%]  (Warmup) 
Chain 2 Iteration: 1700 / 4000 [ 42%]  (Warmup) 
Chain 3 Iteration: 1700 / 4000 [ 42%]  (Warmup) 
Chain 1 Iteration: 1700 / 4000 [ 42%]  (Warmup) 
Chain 4 Iteration: 1800 / 4000 [ 45%]  (Warmup) 
Chain 2 Iteration: 1800 / 4000 [ 45%]  (Warmup) 
Chain 3 Iteration: 1800 / 4000 [ 45%]  (Warmup) 
Chain 1 Iteration: 1800 / 4000 [ 45%]  (Warmup) 
Chain 4 Iteration: 1900 / 4000 [ 47%]  (Warmup) 
Chain 2 Iteration: 1900 / 4000 [ 47%]  (Warmup) 
Chain 3 Iteration: 1900 / 4000 [ 47%]  (Warmup) 
Chain 1 Iteration: 1900 / 4000 [ 47%]  (Warmup) 
Chain 4 Iteration: 2000 / 4000 [ 50%]  (Warmup) 
Chain 2 Iteration: 2000 / 4000 [ 50%]  (Warmup) 
Chain 3 Iteration: 2000 / 4000 [ 50%]  (Warmup) 
Chain 4 Iteration: 2001 / 4000 [ 50%]  (Sampling) 
Chain 2 Iteration: 2001 / 4000 [ 50%]  (Sampling) 
Chain 3 Iteration: 2001 / 4000 [ 50%]  (Sampling) 
Chain 1 Iteration: 2000 / 4000 [ 50%]  (Warmup) 
Chain 1 Iteration: 2001 / 4000 [ 50%]  (Sampling) 
Chain 2 Iteration: 2100 / 4000 [ 52%]  (Sampling) 
Chain 4 Iteration: 2100 / 4000 [ 52%]  (Sampling) 
Chain 1 Iteration: 2100 / 4000 [ 52%]  (Sampling) 
Chain 3 Iteration: 2100 / 4000 [ 52%]  (Sampling) 
Chain 1 Iteration: 2200 / 4000 [ 55%]  (Sampling) 
Chain 4 Iteration: 2200 / 4000 [ 55%]  (Sampling) 
Chain 2 Iteration: 2200 / 4000 [ 55%]  (Sampling) 
Chain 3 Iteration: 2200 / 4000 [ 55%]  (Sampling) 
Chain 1 Iteration: 2300 / 4000 [ 57%]  (Sampling) 
Chain 3 Iteration: 2300 / 4000 [ 57%]  (Sampling) 
Chain 2 Iteration: 2300 / 4000 [ 57%]  (Sampling) 
Chain 4 Iteration: 2300 / 4000 [ 57%]  (Sampling) 
Chain 1 Iteration: 2400 / 4000 [ 60%]  (Sampling) 
Chain 3 Iteration: 2400 / 4000 [ 60%]  (Sampling) 
Chain 4 Iteration: 2400 / 4000 [ 60%]  (Sampling) 
Chain 2 Iteration: 2400 / 4000 [ 60%]  (Sampling) 
Chain 1 Iteration: 2500 / 4000 [ 62%]  (Sampling) 
Chain 3 Iteration: 2500 / 4000 [ 62%]  (Sampling) 
Chain 4 Iteration: 2500 / 4000 [ 62%]  (Sampling) 
Chain 1 Iteration: 2600 / 4000 [ 65%]  (Sampling) 
Chain 2 Iteration: 2500 / 4000 [ 62%]  (Sampling) 
Chain 3 Iteration: 2600 / 4000 [ 65%]  (Sampling) 
Chain 1 Iteration: 2700 / 4000 [ 67%]  (Sampling) 
Chain 4 Iteration: 2600 / 4000 [ 65%]  (Sampling) 
Chain 2 Iteration: 2600 / 4000 [ 65%]  (Sampling) 
Chain 1 Iteration: 2800 / 4000 [ 70%]  (Sampling) 
Chain 3 Iteration: 2700 / 4000 [ 67%]  (Sampling) 
Chain 4 Iteration: 2700 / 4000 [ 67%]  (Sampling) 
Chain 2 Iteration: 2700 / 4000 [ 67%]  (Sampling) 
Chain 1 Iteration: 2900 / 4000 [ 72%]  (Sampling) 
Chain 3 Iteration: 2800 / 4000 [ 70%]  (Sampling) 
Chain 4 Iteration: 2800 / 4000 [ 70%]  (Sampling) 
Chain 2 Iteration: 2800 / 4000 [ 70%]  (Sampling) 
Chain 1 Iteration: 3000 / 4000 [ 75%]  (Sampling) 
Chain 3 Iteration: 2900 / 4000 [ 72%]  (Sampling) 
Chain 4 Iteration: 2900 / 4000 [ 72%]  (Sampling) 
Chain 1 Iteration: 3100 / 4000 [ 77%]  (Sampling) 
Chain 2 Iteration: 2900 / 4000 [ 72%]  (Sampling) 
Chain 3 Iteration: 3000 / 4000 [ 75%]  (Sampling) 
Chain 1 Iteration: 3200 / 4000 [ 80%]  (Sampling) 
Chain 4 Iteration: 3000 / 4000 [ 75%]  (Sampling) 
Chain 2 Iteration: 3000 / 4000 [ 75%]  (Sampling) 
Chain 3 Iteration: 3100 / 4000 [ 77%]  (Sampling) 
Chain 1 Iteration: 3300 / 4000 [ 82%]  (Sampling) 
Chain 4 Iteration: 3100 / 4000 [ 77%]  (Sampling) 
Chain 2 Iteration: 3100 / 4000 [ 77%]  (Sampling) 
Chain 1 Iteration: 3400 / 4000 [ 85%]  (Sampling) 
Chain 3 Iteration: 3200 / 4000 [ 80%]  (Sampling) 
Chain 4 Iteration: 3200 / 4000 [ 80%]  (Sampling) 
Chain 2 Iteration: 3200 / 4000 [ 80%]  (Sampling) 
Chain 1 Iteration: 3500 / 4000 [ 87%]  (Sampling) 
Chain 3 Iteration: 3300 / 4000 [ 82%]  (Sampling) 
Chain 4 Iteration: 3300 / 4000 [ 82%]  (Sampling) 
Chain 1 Iteration: 3600 / 4000 [ 90%]  (Sampling) 
Chain 2 Iteration: 3300 / 4000 [ 82%]  (Sampling) 
Chain 3 Iteration: 3400 / 4000 [ 85%]  (Sampling) 
Chain 1 Iteration: 3700 / 4000 [ 92%]  (Sampling) 
Chain 4 Iteration: 3400 / 4000 [ 85%]  (Sampling) 
Chain 2 Iteration: 3400 / 4000 [ 85%]  (Sampling) 
Chain 3 Iteration: 3500 / 4000 [ 87%]  (Sampling) 
Chain 1 Iteration: 3800 / 4000 [ 95%]  (Sampling) 
Chain 2 Iteration: 3500 / 4000 [ 87%]  (Sampling) 
Chain 4 Iteration: 3500 / 4000 [ 87%]  (Sampling) 
Chain 3 Iteration: 3600 / 4000 [ 90%]  (Sampling) 
Chain 1 Iteration: 3900 / 4000 [ 97%]  (Sampling) 
Chain 2 Iteration: 3600 / 4000 [ 90%]  (Sampling) 
Chain 4 Iteration: 3600 / 4000 [ 90%]  (Sampling) 
Chain 1 Iteration: 4000 / 4000 [100%]  (Sampling) 
Chain 1 finished in 37.6 seconds.
Chain 3 Iteration: 3700 / 4000 [ 92%]  (Sampling) 
Chain 2 Iteration: 3700 / 4000 [ 92%]  (Sampling) 
Chain 4 Iteration: 3700 / 4000 [ 92%]  (Sampling) 
Chain 3 Iteration: 3800 / 4000 [ 95%]  (Sampling) 
Chain 2 Iteration: 3800 / 4000 [ 95%]  (Sampling) 
Chain 4 Iteration: 3800 / 4000 [ 95%]  (Sampling) 
Chain 3 Iteration: 3900 / 4000 [ 97%]  (Sampling) 
Chain 2 Iteration: 3900 / 4000 [ 97%]  (Sampling) 
Chain 4 Iteration: 3900 / 4000 [ 97%]  (Sampling) 
Chain 3 Iteration: 4000 / 4000 [100%]  (Sampling) 
Chain 3 finished in 41.5 seconds.
Chain 2 Iteration: 4000 / 4000 [100%]  (Sampling) 
Chain 4 Iteration: 4000 / 4000 [100%]  (Sampling) 
Chain 4 finished in 42.1 seconds.
Chain 2 finished in 42.2 seconds.

All 4 chains finished successfully.
Mean chain execution time: 40.8 seconds.
Total execution time: 42.4 seconds.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit$save_object("simple_bayes_net.RDS")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>So this next part will be different depending on whether or not you are using <code>RStan</code> or like in this case <code>cmdstanR</code>. If you look up the RStan documentation, I am sure you can find a beginner-friendly tutorial that shows how you would conduct the analysis. For <code>cmdstanR</code>, you call on your Stan file. Below is the Stan code or if you’d like to see it side-by-side, the Stan file can be found <a href="https://raw.githubusercontent.com/jpedroza1228/log-of-jandp/main/posts/2024-07-10-bayes-net-part2-estimation/simple_bayes_net.stan">here</a>. I have kept the defaults and I always include the arguments for the number of warmup iterations and the sampling iterations, just in case I want to make changes to the number of iterations.</p>
<div class="sourceCode" id="cb17" data-include="simple_bayes_net.stan"><pre class="sourceCode stan code-with-copy"><code class="sourceCode stan"></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit &lt;- read_rds(here::here("posts/2024-07-10-bayes-net-part2-estimation/simple_bayes_net.RDS"))</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>fit<span class="sc">$</span><span class="fu">diagnostic_summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$num_divergent
[1] 0 0 0 0

$num_max_treedepth
[1] 0 0 0 0

$ebfmi
[1] 0.9748978 0.9855169 0.9468038 0.9679686</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>bn_converge <span class="ot">&lt;-</span> <span class="fu">summarize_draws</span>(fit<span class="sc">$</span><span class="fu">draws</span>(), <span class="fu">default_convergence_measures</span>())</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>bn_measure <span class="ot">&lt;-</span> <span class="fu">summarize_draws</span>(fit<span class="sc">$</span><span class="fu">draws</span>(), <span class="fu">default_summary_measures</span>())</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>bn_converge <span class="sc">|&gt;</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(rhat)) <span class="sc">|&gt;</span> <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  variable      rhat ess_bulk ess_tail
  &lt;chr&gt;        &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
1 lp__          1.00    3019.    4683.
2 pie           1.00   11711.    6570.
3 log_item[15]  1.00   11711.    6570.
4 x_rep[1,1]    1.00   11711.    6570.
5 x_rep[2,1]    1.00   11711.    6570.
6 x_rep[3,1]    1.00   11711.    6570.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>bn_measure <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="sc">-</span>variable, <span class="sc">~</span><span class="fu">round</span>(.x, <span class="dv">3</span>))) <span class="sc">|&gt;</span> <span class="fu">react_table</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="reactable html-widget html-fill-item" id="htmlwidget-ab973ee4f33d686dc7fc" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-ab973ee4f33d686dc7fc">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"variable":["lp__","nu[1]","nu[2]","nu[3]","nu[4]","nu[5]","nu[6]","nu[7]","nu[8]","false_pos[1]","false_pos[2]","false_pos[3]","false_pos[4]","false_pos[5]","false_pos[6]","false_pos[7]","false_pos[8]","false_pos[9]","false_pos[10]","false_pos[11]","false_pos[12]","false_pos[13]","false_pos[14]","false_pos[15]","true_pos[1]","true_pos[2]","true_pos[3]","true_pos[4]","true_pos[5]","true_pos[6]","true_pos[7]","true_pos[8]","true_pos[9]","true_pos[10]","true_pos[11]","true_pos[12]","true_pos[13]","true_pos[14]","true_pos[15]","lambda1","lambda20","lambda21","lambda30","lambda31","log_nu[1]","log_nu[2]","log_nu[3]","log_nu[4]","log_nu[5]","log_nu[6]","log_nu[7]","log_nu[8]","theta_log1[1]","theta_log1[2]","theta_log2[1]","theta_log2[2]","theta_log3[1]","theta_log3[2]","theta1[1]","theta1[2]","theta1[3]","theta1[4]","theta1[5]","theta1[6]","theta1[7]","theta1[8]","theta2[1]","theta2[2]","theta2[3]","theta2[4]","theta2[5]","theta2[6]","theta2[7]","theta2[8]","theta3[1]","theta3[2]","theta3[3]","theta3[4]","theta3[5]","theta3[6]","theta3[7]","theta3[8]","delta[1,1]","delta[2,1]","delta[3,1]","delta[4,1]","delta[5,1]","delta[6,1]","delta[7,1]","delta[8,1]","delta[9,1]","delta[10,1]","delta[11,1]","delta[12,1]","delta[13,1]","delta[14,1]","delta[15,1]","delta[1,2]","delta[2,2]","delta[3,2]","delta[4,2]","delta[5,2]","delta[6,2]","delta[7,2]","delta[8,2]","delta[9,2]","delta[10,2]","delta[11,2]","delta[12,2]","delta[13,2]","delta[14,2]","delta[15,2]","delta[1,3]","delta[2,3]","delta[3,3]","delta[4,3]","delta[5,3]","delta[6,3]","delta[7,3]","delta[8,3]","delta[9,3]","delta[10,3]","delta[11,3]","delta[12,3]","delta[13,3]","delta[14,3]","delta[15,3]","delta[1,4]","delta[2,4]","delta[3,4]","delta[4,4]","delta[5,4]","delta[6,4]","delta[7,4]","delta[8,4]","delta[9,4]","delta[10,4]","delta[11,4]","delta[12,4]","delta[13,4]","delta[14,4]","delta[15,4]","delta[1,5]","delta[2,5]","delta[3,5]","delta[4,5]","delta[5,5]","delta[6,5]","delta[7,5]","delta[8,5]","delta[9,5]","delta[10,5]","delta[11,5]","delta[12,5]","delta[13,5]","delta[14,5]","delta[15,5]","delta[1,6]","delta[2,6]","delta[3,6]","delta[4,6]","delta[5,6]","delta[6,6]","delta[7,6]","delta[8,6]","delta[9,6]","delta[10,6]","delta[11,6]","delta[12,6]","delta[13,6]","delta[14,6]","delta[15,6]","delta[1,7]","delta[2,7]","delta[3,7]","delta[4,7]","delta[5,7]","delta[6,7]","delta[7,7]","delta[8,7]","delta[9,7]","delta[10,7]","delta[11,7]","delta[12,7]","delta[13,7]","delta[14,7]","delta[15,7]","delta[1,8]","delta[2,8]","delta[3,8]","delta[4,8]","delta[5,8]","delta[6,8]","delta[7,8]","delta[8,8]","delta[9,8]","delta[10,8]","delta[11,8]","delta[12,8]","delta[13,8]","delta[14,8]","delta[15,8]","pie","log_item[1]","log_item[2]","log_item[3]","log_item[4]","log_item[5]","log_item[6]","log_item[7]","log_item[8]","log_item[9]","log_item[10]","log_item[11]","log_item[12]","log_item[13]","log_item[14]","log_item[15]","prob_resp_class[1,1]","prob_resp_class[2,1]","prob_resp_class[3,1]","prob_resp_class[4,1]","prob_resp_class[5,1]","prob_resp_class[6,1]","prob_resp_class[7,1]","prob_resp_class[8,1]","prob_resp_class[9,1]","prob_resp_class[10,1]","prob_resp_class[11,1]","prob_resp_class[12,1]","prob_resp_class[13,1]","prob_resp_class[14,1]","prob_resp_class[15,1]","prob_resp_class[16,1]","prob_resp_class[17,1]","prob_resp_class[18,1]","prob_resp_class[19,1]","prob_resp_class[20,1]","prob_resp_class[21,1]","prob_resp_class[22,1]","prob_resp_class[23,1]","prob_resp_class[24,1]","prob_resp_class[25,1]","prob_resp_class[26,1]","prob_resp_class[27,1]","prob_resp_class[28,1]","prob_resp_class[29,1]","prob_resp_class[30,1]","prob_resp_class[1,2]","prob_resp_class[2,2]","prob_resp_class[3,2]","prob_resp_class[4,2]","prob_resp_class[5,2]","prob_resp_class[6,2]","prob_resp_class[7,2]","prob_resp_class[8,2]","prob_resp_class[9,2]","prob_resp_class[10,2]","prob_resp_class[11,2]","prob_resp_class[12,2]","prob_resp_class[13,2]","prob_resp_class[14,2]","prob_resp_class[15,2]","prob_resp_class[16,2]","prob_resp_class[17,2]","prob_resp_class[18,2]","prob_resp_class[19,2]","prob_resp_class[20,2]","prob_resp_class[21,2]","prob_resp_class[22,2]","prob_resp_class[23,2]","prob_resp_class[24,2]","prob_resp_class[25,2]","prob_resp_class[26,2]","prob_resp_class[27,2]","prob_resp_class[28,2]","prob_resp_class[29,2]","prob_resp_class[30,2]","prob_resp_class[1,3]","prob_resp_class[2,3]","prob_resp_class[3,3]","prob_resp_class[4,3]","prob_resp_class[5,3]","prob_resp_class[6,3]","prob_resp_class[7,3]","prob_resp_class[8,3]","prob_resp_class[9,3]","prob_resp_class[10,3]","prob_resp_class[11,3]","prob_resp_class[12,3]","prob_resp_class[13,3]","prob_resp_class[14,3]","prob_resp_class[15,3]","prob_resp_class[16,3]","prob_resp_class[17,3]","prob_resp_class[18,3]","prob_resp_class[19,3]","prob_resp_class[20,3]","prob_resp_class[21,3]","prob_resp_class[22,3]","prob_resp_class[23,3]","prob_resp_class[24,3]","prob_resp_class[25,3]","prob_resp_class[26,3]","prob_resp_class[27,3]","prob_resp_class[28,3]","prob_resp_class[29,3]","prob_resp_class[30,3]","prob_resp_class[1,4]","prob_resp_class[2,4]","prob_resp_class[3,4]","prob_resp_class[4,4]","prob_resp_class[5,4]","prob_resp_class[6,4]","prob_resp_class[7,4]","prob_resp_class[8,4]","prob_resp_class[9,4]","prob_resp_class[10,4]","prob_resp_class[11,4]","prob_resp_class[12,4]","prob_resp_class[13,4]","prob_resp_class[14,4]","prob_resp_class[15,4]","prob_resp_class[16,4]","prob_resp_class[17,4]","prob_resp_class[18,4]","prob_resp_class[19,4]","prob_resp_class[20,4]","prob_resp_class[21,4]","prob_resp_class[22,4]","prob_resp_class[23,4]","prob_resp_class[24,4]","prob_resp_class[25,4]","prob_resp_class[26,4]","prob_resp_class[27,4]","prob_resp_class[28,4]","prob_resp_class[29,4]","prob_resp_class[30,4]","prob_resp_class[1,5]","prob_resp_class[2,5]","prob_resp_class[3,5]","prob_resp_class[4,5]","prob_resp_class[5,5]","prob_resp_class[6,5]","prob_resp_class[7,5]","prob_resp_class[8,5]","prob_resp_class[9,5]","prob_resp_class[10,5]","prob_resp_class[11,5]","prob_resp_class[12,5]","prob_resp_class[13,5]","prob_resp_class[14,5]","prob_resp_class[15,5]","prob_resp_class[16,5]","prob_resp_class[17,5]","prob_resp_class[18,5]","prob_resp_class[19,5]","prob_resp_class[20,5]","prob_resp_class[21,5]","prob_resp_class[22,5]","prob_resp_class[23,5]","prob_resp_class[24,5]","prob_resp_class[25,5]","prob_resp_class[26,5]","prob_resp_class[27,5]","prob_resp_class[28,5]","prob_resp_class[29,5]","prob_resp_class[30,5]","prob_resp_class[1,6]","prob_resp_class[2,6]","prob_resp_class[3,6]","prob_resp_class[4,6]","prob_resp_class[5,6]","prob_resp_class[6,6]","prob_resp_class[7,6]","prob_resp_class[8,6]","prob_resp_class[9,6]","prob_resp_class[10,6]","prob_resp_class[11,6]","prob_resp_class[12,6]","prob_resp_class[13,6]","prob_resp_class[14,6]","prob_resp_class[15,6]","prob_resp_class[16,6]","prob_resp_class[17,6]","prob_resp_class[18,6]","prob_resp_class[19,6]","prob_resp_class[20,6]","prob_resp_class[21,6]","prob_resp_class[22,6]","prob_resp_class[23,6]","prob_resp_class[24,6]","prob_resp_class[25,6]","prob_resp_class[26,6]","prob_resp_class[27,6]","prob_resp_class[28,6]","prob_resp_class[29,6]","prob_resp_class[30,6]","prob_resp_class[1,7]","prob_resp_class[2,7]","prob_resp_class[3,7]","prob_resp_class[4,7]","prob_resp_class[5,7]","prob_resp_class[6,7]","prob_resp_class[7,7]","prob_resp_class[8,7]","prob_resp_class[9,7]","prob_resp_class[10,7]","prob_resp_class[11,7]","prob_resp_class[12,7]","prob_resp_class[13,7]","prob_resp_class[14,7]","prob_resp_class[15,7]","prob_resp_class[16,7]","prob_resp_class[17,7]","prob_resp_class[18,7]","prob_resp_class[19,7]","prob_resp_class[20,7]","prob_resp_class[21,7]","prob_resp_class[22,7]","prob_resp_class[23,7]","prob_resp_class[24,7]","prob_resp_class[25,7]","prob_resp_class[26,7]","prob_resp_class[27,7]","prob_resp_class[28,7]","prob_resp_class[29,7]","prob_resp_class[30,7]","prob_resp_class[1,8]","prob_resp_class[2,8]","prob_resp_class[3,8]","prob_resp_class[4,8]","prob_resp_class[5,8]","prob_resp_class[6,8]","prob_resp_class[7,8]","prob_resp_class[8,8]","prob_resp_class[9,8]","prob_resp_class[10,8]","prob_resp_class[11,8]","prob_resp_class[12,8]","prob_resp_class[13,8]","prob_resp_class[14,8]","prob_resp_class[15,8]","prob_resp_class[16,8]","prob_resp_class[17,8]","prob_resp_class[18,8]","prob_resp_class[19,8]","prob_resp_class[20,8]","prob_resp_class[21,8]","prob_resp_class[22,8]","prob_resp_class[23,8]","prob_resp_class[24,8]","prob_resp_class[25,8]","prob_resp_class[26,8]","prob_resp_class[27,8]","prob_resp_class[28,8]","prob_resp_class[29,8]","prob_resp_class[30,8]","prob_resp_attr[1,1]","prob_resp_attr[2,1]","prob_resp_attr[3,1]","prob_resp_attr[4,1]","prob_resp_attr[5,1]","prob_resp_attr[6,1]","prob_resp_attr[7,1]","prob_resp_attr[8,1]","prob_resp_attr[9,1]","prob_resp_attr[10,1]","prob_resp_attr[11,1]","prob_resp_attr[12,1]","prob_resp_attr[13,1]","prob_resp_attr[14,1]","prob_resp_attr[15,1]","prob_resp_attr[16,1]","prob_resp_attr[17,1]","prob_resp_attr[18,1]","prob_resp_attr[19,1]","prob_resp_attr[20,1]","prob_resp_attr[21,1]","prob_resp_attr[22,1]","prob_resp_attr[23,1]","prob_resp_attr[24,1]","prob_resp_attr[25,1]","prob_resp_attr[26,1]","prob_resp_attr[27,1]","prob_resp_attr[28,1]","prob_resp_attr[29,1]","prob_resp_attr[30,1]","prob_resp_attr[1,2]","prob_resp_attr[2,2]","prob_resp_attr[3,2]","prob_resp_attr[4,2]","prob_resp_attr[5,2]","prob_resp_attr[6,2]","prob_resp_attr[7,2]","prob_resp_attr[8,2]","prob_resp_attr[9,2]","prob_resp_attr[10,2]","prob_resp_attr[11,2]","prob_resp_attr[12,2]","prob_resp_attr[13,2]","prob_resp_attr[14,2]","prob_resp_attr[15,2]","prob_resp_attr[16,2]","prob_resp_attr[17,2]","prob_resp_attr[18,2]","prob_resp_attr[19,2]","prob_resp_attr[20,2]","prob_resp_attr[21,2]","prob_resp_attr[22,2]","prob_resp_attr[23,2]","prob_resp_attr[24,2]","prob_resp_attr[25,2]","prob_resp_attr[26,2]","prob_resp_attr[27,2]","prob_resp_attr[28,2]","prob_resp_attr[29,2]","prob_resp_attr[30,2]","prob_resp_attr[1,3]","prob_resp_attr[2,3]","prob_resp_attr[3,3]","prob_resp_attr[4,3]","prob_resp_attr[5,3]","prob_resp_attr[6,3]","prob_resp_attr[7,3]","prob_resp_attr[8,3]","prob_resp_attr[9,3]","prob_resp_attr[10,3]","prob_resp_attr[11,3]","prob_resp_attr[12,3]","prob_resp_attr[13,3]","prob_resp_attr[14,3]","prob_resp_attr[15,3]","prob_resp_attr[16,3]","prob_resp_attr[17,3]","prob_resp_attr[18,3]","prob_resp_attr[19,3]","prob_resp_attr[20,3]","prob_resp_attr[21,3]","prob_resp_attr[22,3]","prob_resp_attr[23,3]","prob_resp_attr[24,3]","prob_resp_attr[25,3]","prob_resp_attr[26,3]","prob_resp_attr[27,3]","prob_resp_attr[28,3]","prob_resp_attr[29,3]","prob_resp_attr[30,3]","prob_joint[1]","prob_joint[2]","prob_joint[3]","prob_joint[4]","prob_joint[5]","prob_joint[6]","prob_joint[7]","prob_joint[8]","prob_attr_class[1]","prob_attr_class[2]","prob_attr_class[3]","prob_attr_class[4]","prob_attr_class[5]","prob_attr_class[6]","prob_attr_class[7]","prob_attr_class[8]","x_rep[1,1]","x_rep[2,1]","x_rep[3,1]","x_rep[4,1]","x_rep[5,1]","x_rep[6,1]","x_rep[7,1]","x_rep[8,1]","x_rep[9,1]","x_rep[10,1]","x_rep[11,1]","x_rep[12,1]","x_rep[13,1]","x_rep[14,1]","x_rep[15,1]","x_rep[16,1]","x_rep[17,1]","x_rep[18,1]","x_rep[19,1]","x_rep[20,1]","x_rep[21,1]","x_rep[22,1]","x_rep[23,1]","x_rep[24,1]","x_rep[25,1]","x_rep[26,1]","x_rep[27,1]","x_rep[28,1]","x_rep[29,1]","x_rep[30,1]","x_rep[1,2]","x_rep[2,2]","x_rep[3,2]","x_rep[4,2]","x_rep[5,2]","x_rep[6,2]","x_rep[7,2]","x_rep[8,2]","x_rep[9,2]","x_rep[10,2]","x_rep[11,2]","x_rep[12,2]","x_rep[13,2]","x_rep[14,2]","x_rep[15,2]","x_rep[16,2]","x_rep[17,2]","x_rep[18,2]","x_rep[19,2]","x_rep[20,2]","x_rep[21,2]","x_rep[22,2]","x_rep[23,2]","x_rep[24,2]","x_rep[25,2]","x_rep[26,2]","x_rep[27,2]","x_rep[28,2]","x_rep[29,2]","x_rep[30,2]","x_rep[1,3]","x_rep[2,3]","x_rep[3,3]","x_rep[4,3]","x_rep[5,3]","x_rep[6,3]","x_rep[7,3]","x_rep[8,3]","x_rep[9,3]","x_rep[10,3]","x_rep[11,3]","x_rep[12,3]","x_rep[13,3]","x_rep[14,3]","x_rep[15,3]","x_rep[16,3]","x_rep[17,3]","x_rep[18,3]","x_rep[19,3]","x_rep[20,3]","x_rep[21,3]","x_rep[22,3]","x_rep[23,3]","x_rep[24,3]","x_rep[25,3]","x_rep[26,3]","x_rep[27,3]","x_rep[28,3]","x_rep[29,3]","x_rep[30,3]","x_rep[1,4]","x_rep[2,4]","x_rep[3,4]","x_rep[4,4]","x_rep[5,4]","x_rep[6,4]","x_rep[7,4]","x_rep[8,4]","x_rep[9,4]","x_rep[10,4]","x_rep[11,4]","x_rep[12,4]","x_rep[13,4]","x_rep[14,4]","x_rep[15,4]","x_rep[16,4]","x_rep[17,4]","x_rep[18,4]","x_rep[19,4]","x_rep[20,4]","x_rep[21,4]","x_rep[22,4]","x_rep[23,4]","x_rep[24,4]","x_rep[25,4]","x_rep[26,4]","x_rep[27,4]","x_rep[28,4]","x_rep[29,4]","x_rep[30,4]","x_rep[1,5]","x_rep[2,5]","x_rep[3,5]","x_rep[4,5]","x_rep[5,5]","x_rep[6,5]","x_rep[7,5]","x_rep[8,5]","x_rep[9,5]","x_rep[10,5]","x_rep[11,5]","x_rep[12,5]","x_rep[13,5]","x_rep[14,5]","x_rep[15,5]","x_rep[16,5]","x_rep[17,5]","x_rep[18,5]","x_rep[19,5]","x_rep[20,5]","x_rep[21,5]","x_rep[22,5]","x_rep[23,5]","x_rep[24,5]","x_rep[25,5]","x_rep[26,5]","x_rep[27,5]","x_rep[28,5]","x_rep[29,5]","x_rep[30,5]","x_rep[1,6]","x_rep[2,6]","x_rep[3,6]","x_rep[4,6]","x_rep[5,6]","x_rep[6,6]","x_rep[7,6]","x_rep[8,6]","x_rep[9,6]","x_rep[10,6]","x_rep[11,6]","x_rep[12,6]","x_rep[13,6]","x_rep[14,6]","x_rep[15,6]","x_rep[16,6]","x_rep[17,6]","x_rep[18,6]","x_rep[19,6]","x_rep[20,6]","x_rep[21,6]","x_rep[22,6]","x_rep[23,6]","x_rep[24,6]","x_rep[25,6]","x_rep[26,6]","x_rep[27,6]","x_rep[28,6]","x_rep[29,6]","x_rep[30,6]","x_rep[1,7]","x_rep[2,7]","x_rep[3,7]","x_rep[4,7]","x_rep[5,7]","x_rep[6,7]","x_rep[7,7]","x_rep[8,7]","x_rep[9,7]","x_rep[10,7]","x_rep[11,7]","x_rep[12,7]","x_rep[13,7]","x_rep[14,7]","x_rep[15,7]","x_rep[16,7]","x_rep[17,7]","x_rep[18,7]","x_rep[19,7]","x_rep[20,7]","x_rep[21,7]","x_rep[22,7]","x_rep[23,7]","x_rep[24,7]","x_rep[25,7]","x_rep[26,7]","x_rep[27,7]","x_rep[28,7]","x_rep[29,7]","x_rep[30,7]","x_rep[1,8]","x_rep[2,8]","x_rep[3,8]","x_rep[4,8]","x_rep[5,8]","x_rep[6,8]","x_rep[7,8]","x_rep[8,8]","x_rep[9,8]","x_rep[10,8]","x_rep[11,8]","x_rep[12,8]","x_rep[13,8]","x_rep[14,8]","x_rep[15,8]","x_rep[16,8]","x_rep[17,8]","x_rep[18,8]","x_rep[19,8]","x_rep[20,8]","x_rep[21,8]","x_rep[22,8]","x_rep[23,8]","x_rep[24,8]","x_rep[25,8]","x_rep[26,8]","x_rep[27,8]","x_rep[28,8]","x_rep[29,8]","x_rep[30,8]","x_rep[1,9]","x_rep[2,9]","x_rep[3,9]","x_rep[4,9]","x_rep[5,9]","x_rep[6,9]","x_rep[7,9]","x_rep[8,9]","x_rep[9,9]","x_rep[10,9]","x_rep[11,9]","x_rep[12,9]","x_rep[13,9]","x_rep[14,9]","x_rep[15,9]","x_rep[16,9]","x_rep[17,9]","x_rep[18,9]","x_rep[19,9]","x_rep[20,9]","x_rep[21,9]","x_rep[22,9]","x_rep[23,9]","x_rep[24,9]","x_rep[25,9]","x_rep[26,9]","x_rep[27,9]","x_rep[28,9]","x_rep[29,9]","x_rep[30,9]","x_rep[1,10]","x_rep[2,10]","x_rep[3,10]","x_rep[4,10]","x_rep[5,10]","x_rep[6,10]","x_rep[7,10]","x_rep[8,10]","x_rep[9,10]","x_rep[10,10]","x_rep[11,10]","x_rep[12,10]","x_rep[13,10]","x_rep[14,10]","x_rep[15,10]","x_rep[16,10]","x_rep[17,10]","x_rep[18,10]","x_rep[19,10]","x_rep[20,10]","x_rep[21,10]","x_rep[22,10]","x_rep[23,10]","x_rep[24,10]","x_rep[25,10]","x_rep[26,10]","x_rep[27,10]","x_rep[28,10]","x_rep[29,10]","x_rep[30,10]","x_rep[1,11]","x_rep[2,11]","x_rep[3,11]","x_rep[4,11]","x_rep[5,11]","x_rep[6,11]","x_rep[7,11]","x_rep[8,11]","x_rep[9,11]","x_rep[10,11]","x_rep[11,11]","x_rep[12,11]","x_rep[13,11]","x_rep[14,11]","x_rep[15,11]","x_rep[16,11]","x_rep[17,11]","x_rep[18,11]","x_rep[19,11]","x_rep[20,11]","x_rep[21,11]","x_rep[22,11]","x_rep[23,11]","x_rep[24,11]","x_rep[25,11]","x_rep[26,11]","x_rep[27,11]","x_rep[28,11]","x_rep[29,11]","x_rep[30,11]","x_rep[1,12]","x_rep[2,12]","x_rep[3,12]","x_rep[4,12]","x_rep[5,12]","x_rep[6,12]","x_rep[7,12]","x_rep[8,12]","x_rep[9,12]","x_rep[10,12]","x_rep[11,12]","x_rep[12,12]","x_rep[13,12]","x_rep[14,12]","x_rep[15,12]","x_rep[16,12]","x_rep[17,12]","x_rep[18,12]","x_rep[19,12]","x_rep[20,12]","x_rep[21,12]","x_rep[22,12]","x_rep[23,12]","x_rep[24,12]","x_rep[25,12]","x_rep[26,12]","x_rep[27,12]","x_rep[28,12]","x_rep[29,12]","x_rep[30,12]","x_rep[1,13]","x_rep[2,13]","x_rep[3,13]","x_rep[4,13]","x_rep[5,13]","x_rep[6,13]","x_rep[7,13]","x_rep[8,13]","x_rep[9,13]","x_rep[10,13]","x_rep[11,13]","x_rep[12,13]","x_rep[13,13]","x_rep[14,13]","x_rep[15,13]","x_rep[16,13]","x_rep[17,13]","x_rep[18,13]","x_rep[19,13]","x_rep[20,13]","x_rep[21,13]","x_rep[22,13]","x_rep[23,13]","x_rep[24,13]","x_rep[25,13]","x_rep[26,13]","x_rep[27,13]","x_rep[28,13]","x_rep[29,13]","x_rep[30,13]","x_rep[1,14]","x_rep[2,14]","x_rep[3,14]","x_rep[4,14]","x_rep[5,14]","x_rep[6,14]","x_rep[7,14]","x_rep[8,14]","x_rep[9,14]","x_rep[10,14]","x_rep[11,14]","x_rep[12,14]","x_rep[13,14]","x_rep[14,14]","x_rep[15,14]","x_rep[16,14]","x_rep[17,14]","x_rep[18,14]","x_rep[19,14]","x_rep[20,14]","x_rep[21,14]","x_rep[22,14]","x_rep[23,14]","x_rep[24,14]","x_rep[25,14]","x_rep[26,14]","x_rep[27,14]","x_rep[28,14]","x_rep[29,14]","x_rep[30,14]","x_rep[1,15]","x_rep[2,15]","x_rep[3,15]","x_rep[4,15]","x_rep[5,15]","x_rep[6,15]","x_rep[7,15]","x_rep[8,15]","x_rep[9,15]","x_rep[10,15]","x_rep[11,15]","x_rep[12,15]","x_rep[13,15]","x_rep[14,15]","x_rep[15,15]","x_rep[16,15]","x_rep[17,15]","x_rep[18,15]","x_rep[19,15]","x_rep[20,15]","x_rep[21,15]","x_rep[22,15]","x_rep[23,15]","x_rep[24,15]","x_rep[25,15]","x_rep[26,15]","x_rep[27,15]","x_rep[28,15]","x_rep[29,15]","x_rep[30,15]"],"mean":[-767.481,0.027,0.044,0.032,0.071,0.033,0.083,0.033,0.675,0.14,0.203,0.205,0.188,0.113,0.09,0.173,0.243,0.126,0.134,0.19,0.176,0.09,0.067,0.131,0.87,0.891,0.9,0.902,0.859,0.818,0.888,0.904,0.86,0.861,0.887,0.892,0.813,0.827,0.869,0.859,0.367,0.772,0.177,0.869,-4.155,-3.648,-3.967,-3.109,-3.961,-3.069,-3.955,-0.411,-1.985,-0.153,-1.036,-0.261,-1.817,-0.141,-1.985,-0.153,-1.985,-0.153,-1.985,-0.153,-1.985,-0.153,-1.036,-1.036,-0.261,-0.261,-1.036,-1.036,-0.261,-0.261,-1.817,-1.817,-1.817,-1.817,-0.141,-0.141,-0.141,-0.141,0.141,0.367,0.177,0.141,0.367,0.177,0.141,0.367,0.177,0.141,0.367,0.177,0.141,0.367,0.177,0.859,0.367,0.177,0.859,0.367,0.177,0.859,0.367,0.177,0.859,0.367,0.177,0.859,0.367,0.177,0.141,0.772,0.177,0.141,0.772,0.177,0.141,0.772,0.177,0.141,0.772,0.177,0.141,0.772,0.177,0.859,0.772,0.177,0.859,0.772,0.177,0.859,0.772,0.177,0.859,0.772,0.177,0.859,0.772,0.177,0.141,0.367,0.869,0.141,0.367,0.869,0.141,0.367,0.869,0.141,0.367,0.869,0.141,0.367,0.869,0.859,0.367,0.869,0.859,0.367,0.869,0.859,0.367,0.869,0.859,0.367,0.869,0.859,0.367,0.869,0.141,0.772,0.869,0.141,0.772,0.869,0.141,0.772,0.869,0.141,0.772,0.869,0.141,0.772,0.869,0.859,0.772,0.869,0.859,0.772,0.869,0.859,0.772,0.869,0.859,0.772,0.869,0.859,0.772,0.869,0.672,-0.41,-0.463,-0.307,-0.332,-0.634,-0.938,-0.36,-0.409,-0.416,-0.426,-0.483,-0.336,-0.891,-0.618,-1.133,0.021,0,0.001,0,0.006,0.001,0.003,0,0,0,0,0,0.002,0,0,0,0,0,0,0,0,0.001,0,0,0,0,0.001,0,0.001,0,0.032,0,0.009,0,0.008,0.088,0.275,0,0.002,0,0.001,0.001,0.035,0.002,0.011,0.002,0.003,0,0.001,0,0.034,0.01,0.005,0.002,0,0.004,0.001,0.001,0.139,0.002,0.197,0,0.008,0,0.005,0.001,0.003,0,0,0.001,0,0,0.001,0,0,0,0,0,0,0,0.001,0.001,0.001,0,0,0,0.001,0,0.004,0,0.366,0.002,0.122,0,0.011,0.105,0.327,0,0.019,0.002,0.002,0.002,0.013,0.002,0.015,0.002,0.017,0.002,0.019,0,0.135,0.017,0.02,0.019,0,0.02,0.002,0.002,0.414,0.021,0.002,0,0.001,0.064,0.056,0.001,0,0.003,0,0.025,0,0.003,0.017,0.001,0.001,0.008,0,0.001,0,0.009,0,0.005,0.003,0,0,0,0.057,0,0,0,0.006,0.009,0.016,0.131,0.123,0.119,0.056,0.054,0.022,0.056,0.054,0.061,0.29,0.145,0.138,0.145,0.047,0.023,0.008,0.146,0.044,0.116,0.053,0.022,0.009,0.049,0.126,0.053,0.025,0.022,0.02,0.008,0.006,0.047,0.044,0.001,0,0.007,0.001,0.055,0.001,0.006,0.004,0.001,0.001,0.006,0.001,0.006,0.001,0.006,0.001,0.005,0.007,0.001,0.001,0.001,0.044,0.001,0,0.001,0.357,0.981,0.837,0.757,0.747,0.686,0.335,0.936,0.956,0.861,0.941,0.928,0.639,0.849,0.835,0.837,0.931,0.968,0.971,0.839,0.785,0.845,0.911,0.955,0.99,0.925,0.767,0.943,0.416,0.953,0.76,0.992,0.984,0.888,0.889,0.997,0.993,0.991,0.999,0.919,0.999,0.991,0.976,0.998,0.998,0.986,0.999,0.993,0.999,0.985,0.998,0.988,0.989,0.999,0.999,0.999,0.896,0.999,0.994,0.999,0.94,0.991,0.974,0.804,0.807,0.792,0.665,0.943,0.976,0.919,0.945,0.936,0.656,0.852,0.85,0.845,0.949,0.976,0.991,0.845,0.921,0.868,0.939,0.976,0.991,0.947,0.814,0.946,0.834,0.976,0.384,0.997,0.86,0.999,0.97,0.806,0.391,1,0.979,0.997,0.997,0.997,0.949,0.996,0.974,0.996,0.979,0.997,0.98,1,0.83,0.971,0.974,0.979,1,0.975,0.995,0.997,0.441,0.977,0,0,0,0,0,0,0,0,0,0,0,0,0,0.022,0.001,0.953,-1.133,-1.133,-1.133,-1.133,-0.401,-0.401,-0.401,-0.401,-1.133,-1.133,-0.401,-0.401,-1.133,-0.401,-0.401,-0.401,-0.401,-0.401,-0.401,-1.133,-0.401,-0.401,-1.133,-1.133,-0.401,-0.401,-0.401,-0.401,-0.401,-0.401,-1.133,-0.401,-0.401,-0.401,-0.401,-0.401,-1.133,-1.133,-0.401,-0.401,-1.133,-0.401,-1.133,-1.133,-0.401,-0.401,-0.401,-0.401,-0.401,-0.401,-1.133,-1.133,-0.401,-0.401,-0.401,-0.401,-0.401,-0.401,-0.401,-0.401,-0.401,-0.401,-1.133,-0.401,-1.133,-0.401,-1.133,-0.401,-0.401,-1.133,-0.401,-0.401,-0.401,-0.401,-0.401,-0.401,-1.133,-0.401,-0.401,-0.401,-0.401,-0.401,-0.401,-0.401,-0.401,-0.401,-0.401,-0.401,-0.401,-0.401,-1.133,-0.401,-0.401,-0.401,-0.401,-0.401,-0.401,-0.401,-0.401,-0.401,-0.401,-0.401,-1.133,-0.401,-0.401,-1.133,-0.401,-0.401,-0.401,-0.401,-0.401,-0.401,-0.401,-0.401,-0.401,-1.133,-1.133,-0.401,-0.401,-0.401,-0.401,-0.401,-0.401,-1.133,-1.133,-1.133,-1.133,-0.401,-0.401,-1.133,-0.401,-1.133,-1.133,-1.133,-1.133,-1.133,-1.133,-0.401,-0.401,-1.133,-0.401,-1.133,-0.401,-0.401,-0.401,-1.133,-1.133,-0.401,-1.133,-0.401,-1.133,-0.401,-1.133,-0.401,-0.401,-1.133,-1.133,-0.401,-1.133,-0.401,-1.133,-0.401,-1.133,-1.133,-0.401,-0.401,-1.133,-0.401,-1.133,-0.401,-1.133,-0.401,-1.133,-0.401,-0.401,-1.133,-1.133,-1.133,-1.133,-1.133,-0.401,-0.401,-0.401,-0.401,-1.133,-1.133,-0.401,-1.133,-0.401,-0.401,-0.401,-1.133,-0.401,-0.401,-1.133,-0.401,-0.401,-1.133,-0.401,-0.401,-0.401,-1.133,-0.401,-0.401,-0.401,-0.401,-0.401,-0.401,-0.401,-0.401,-0.401,-0.401,-0.401,-0.401,-1.133,-0.401,-0.401,-0.401,-0.401,-0.401,-0.401,-0.401,-0.401,-0.401,-1.133,-0.401,-1.133,-0.401,-0.401,-0.401,-0.401,-0.401,-0.401,-0.401,-0.401,-0.401,-1.133,-1.133,-0.401,-0.401,-1.133,-1.133,-1.133,-0.401,-0.401,-0.401,-1.133,-0.401,-0.401,-0.401,-0.401,-1.133,-0.401,-0.401,-1.133,-1.133,-0.401,-0.401,-0.401,-0.401,-1.133,-1.133,-1.133,-1.133,-0.401,-0.401,-0.401,-0.401,-1.133,-0.401,-0.401,-0.401,-0.401,-1.133,-1.133,-0.401,-1.133,-0.401,-0.401,-1.133,-0.401,-1.133,-0.401,-0.401,-0.401,-0.401,-0.401,-1.133,-0.401,-0.401,-1.133,-1.133,-0.401,-0.401,-1.133,-0.401,-1.133,-0.401,-1.133,-0.401,-0.401,-0.401,-1.133,-1.133,-0.401,-1.133,-0.401,-0.401,-0.401,-0.401,-0.401,-0.401,-1.133,-0.401,-0.401,-1.133,-0.401,-0.401,-0.401,-1.133,-0.401,-1.133,-1.133,-0.401,-0.401,-1.133,-0.401,-0.401,-0.401,-0.401,-1.133,-0.401,-0.401,-0.401,-1.133,-1.133,-0.401,-0.401,-1.133,-0.401,-0.401,-0.401,-0.401,-0.401,-1.133,-0.401,-0.401,-0.401,-1.133,-0.401,-0.401,-0.401,-0.401,-0.401,-0.401,-0.401,-0.401,-0.401,-1.133,-0.401,-1.133,-1.133,-1.133,-1.133,-1.133,-0.401,-0.401,-1.133,-0.401,-1.133,-1.133,-0.401,-0.401,-1.133,-0.401,-1.133,-1.133,-0.401,-1.133,-1.133,-0.401,-0.401,-1.133,-0.401,-0.401,-0.401,-1.133,-1.133,-0.401,-1.133,-0.401,-0.401,-0.401,-1.133,-1.133,-1.133,-1.133,-1.133,-1.133,-1.133,-1.133,-1.133,-1.133,-1.133,-1.133,-1.133,-0.401,-1.133,-0.401,-1.133,-1.133,-0.401,-1.133,-1.133,-0.401,-0.401,-1.133,-1.133,-1.133,-1.133,-1.133,-0.401,-0.401,-0.401,-0.401,-1.133,-1.133,-0.401,-0.401,-0.401,-0.401,-0.401,-1.133,-0.401,-0.401,-0.401,-0.401,-1.133,-0.401,-0.401,-1.133,-1.133,-0.401,-1.133,-0.401,-1.133,-0.401,-0.401,-1.133,-1.133],"median":[-767.173,0.02,0.032,0.024,0.056,0.023,0.058,0.024,0.687,0.133,0.198,0.199,0.182,0.107,0.082,0.166,0.24,0.118,0.127,0.185,0.17,0.082,0.061,0.124,0.876,0.898,0.905,0.908,0.867,0.824,0.894,0.91,0.866,0.867,0.893,0.899,0.82,0.836,0.876,0.861,0.363,0.775,0.17,0.871,-3.931,-3.429,-3.746,-2.887,-3.758,-2.851,-3.725,-0.375,-1.971,-0.15,-1.014,-0.255,-1.773,-0.138,-1.971,-0.15,-1.971,-0.15,-1.971,-0.15,-1.971,-0.15,-1.014,-1.014,-0.255,-0.255,-1.014,-1.014,-0.255,-0.255,-1.773,-1.773,-1.773,-1.773,-0.138,-0.138,-0.138,-0.138,0.139,0.363,0.17,0.139,0.363,0.17,0.139,0.363,0.17,0.139,0.363,0.17,0.139,0.363,0.17,0.861,0.363,0.17,0.861,0.363,0.17,0.861,0.363,0.17,0.861,0.363,0.17,0.861,0.363,0.17,0.139,0.775,0.17,0.139,0.775,0.17,0.139,0.775,0.17,0.139,0.775,0.17,0.139,0.775,0.17,0.861,0.775,0.17,0.861,0.775,0.17,0.861,0.775,0.17,0.861,0.775,0.17,0.861,0.775,0.17,0.139,0.363,0.871,0.139,0.363,0.871,0.139,0.363,0.871,0.139,0.363,0.871,0.139,0.363,0.871,0.861,0.363,0.871,0.861,0.363,0.871,0.861,0.363,0.871,0.861,0.363,0.871,0.861,0.363,0.871,0.139,0.775,0.871,0.139,0.775,0.871,0.139,0.775,0.871,0.139,0.775,0.871,0.139,0.775,0.871,0.861,0.775,0.871,0.861,0.775,0.871,0.861,0.775,0.871,0.861,0.775,0.871,0.861,0.775,0.871,0.674,-0.404,-0.456,-0.3,-0.326,-0.625,-0.928,-0.353,-0.403,-0.409,-0.42,-0.476,-0.33,-0.884,-0.608,-1.121,0.009,0,0,0,0.003,0,0.001,0,0,0,0,0,0.001,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.001,0,0.014,0,0.004,0,0.004,0.057,0.23,0,0.001,0,0,0,0.019,0.001,0.006,0.001,0.001,0,0,0,0.019,0.005,0.002,0.001,0,0.002,0.001,0,0.091,0.001,0.149,0,0.004,0,0.002,0,0.001,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.001,0,0,0,0,0,0.002,0,0.345,0.001,0.082,0,0.005,0.073,0.296,0,0.01,0.001,0.001,0.001,0.007,0.001,0.008,0.001,0.009,0.001,0.01,0,0.094,0.009,0.01,0.01,0,0.011,0.001,0.001,0.407,0.011,0.001,0,0,0.04,0.034,0,0,0.001,0,0.014,0,0.001,0.008,0,0,0.004,0,0,0,0.004,0,0.003,0.001,0,0,0,0.035,0,0,0,0.002,0.002,0.005,0.089,0.083,0.079,0.031,0.026,0.008,0.029,0.027,0.031,0.25,0.097,0.092,0.099,0.022,0.008,0.002,0.099,0.022,0.072,0.026,0.008,0.002,0.023,0.085,0.026,0.012,0.008,0.011,0.004,0.003,0.03,0.028,0,0,0.003,0,0.035,0,0.003,0.002,0,0,0.003,0,0.003,0,0.003,0,0.003,0.004,0,0,0,0.028,0,0,0,0.328,0.989,0.876,0.791,0.779,0.713,0.302,0.963,0.973,0.891,0.969,0.957,0.67,0.896,0.877,0.883,0.957,0.982,0.983,0.884,0.821,0.885,0.937,0.973,0.997,0.952,0.799,0.97,0.389,0.972,0.803,0.996,0.99,0.914,0.912,0.998,0.996,0.994,0.999,0.941,0.999,0.995,0.985,0.999,0.999,0.991,0.999,0.996,0.999,0.99,0.999,0.992,0.993,0.999,1,0.999,0.92,0.999,0.997,0.999,0.967,0.998,0.988,0.843,0.844,0.83,0.699,0.971,0.991,0.947,0.973,0.966,0.689,0.9,0.895,0.891,0.975,0.991,0.998,0.892,0.949,0.91,0.967,0.991,0.998,0.973,0.853,0.974,0.882,0.991,0.357,0.999,0.899,1,0.979,0.838,0.361,1,0.988,0.998,0.998,0.999,0.966,0.998,0.983,0.998,0.988,0.999,0.989,1,0.867,0.981,0.984,0.989,1,0.985,0.997,0.998,0.417,0.987,0,0,0,0,0,0,0,0,0,0,0,0,0,0.008,0,0.972,-1.121,-1.121,-1.121,-1.121,-0.395,-0.395,-0.395,-0.395,-1.121,-1.121,-0.395,-0.395,-1.121,-0.395,-0.395,-0.395,-0.395,-0.395,-0.395,-1.121,-0.395,-0.395,-1.121,-1.121,-0.395,-0.395,-0.395,-0.395,-0.395,-0.395,-1.121,-0.395,-0.395,-0.395,-0.395,-0.395,-1.121,-1.121,-0.395,-0.395,-1.121,-0.395,-1.121,-1.121,-0.395,-0.395,-0.395,-0.395,-0.395,-0.395,-1.121,-1.121,-0.395,-0.395,-0.395,-0.395,-0.395,-0.395,-0.395,-0.395,-0.395,-0.395,-1.121,-0.395,-1.121,-0.395,-1.121,-0.395,-0.395,-1.121,-0.395,-0.395,-0.395,-0.395,-0.395,-0.395,-1.121,-0.395,-0.395,-0.395,-0.395,-0.395,-0.395,-0.395,-0.395,-0.395,-0.395,-0.395,-0.395,-0.395,-1.121,-0.395,-0.395,-0.395,-0.395,-0.395,-0.395,-0.395,-0.395,-0.395,-0.395,-0.395,-1.121,-0.395,-0.395,-1.121,-0.395,-0.395,-0.395,-0.395,-0.395,-0.395,-0.395,-0.395,-0.395,-1.121,-1.121,-0.395,-0.395,-0.395,-0.395,-0.395,-0.395,-1.121,-1.121,-1.121,-1.121,-0.395,-0.395,-1.121,-0.395,-1.121,-1.121,-1.121,-1.121,-1.121,-1.121,-0.395,-0.395,-1.121,-0.395,-1.121,-0.395,-0.395,-0.395,-1.121,-1.121,-0.395,-1.121,-0.395,-1.121,-0.395,-1.121,-0.395,-0.395,-1.121,-1.121,-0.395,-1.121,-0.395,-1.121,-0.395,-1.121,-1.121,-0.395,-0.395,-1.121,-0.395,-1.121,-0.395,-1.121,-0.395,-1.121,-0.395,-0.395,-1.121,-1.121,-1.121,-1.121,-1.121,-0.395,-0.395,-0.395,-0.395,-1.121,-1.121,-0.395,-1.121,-0.395,-0.395,-0.395,-1.121,-0.395,-0.395,-1.121,-0.395,-0.395,-1.121,-0.395,-0.395,-0.395,-1.121,-0.395,-0.395,-0.395,-0.395,-0.395,-0.395,-0.395,-0.395,-0.395,-0.395,-0.395,-0.395,-1.121,-0.395,-0.395,-0.395,-0.395,-0.395,-0.395,-0.395,-0.395,-0.395,-1.121,-0.395,-1.121,-0.395,-0.395,-0.395,-0.395,-0.395,-0.395,-0.395,-0.395,-0.395,-1.121,-1.121,-0.395,-0.395,-1.121,-1.121,-1.121,-0.395,-0.395,-0.395,-1.121,-0.395,-0.395,-0.395,-0.395,-1.121,-0.395,-0.395,-1.121,-1.121,-0.395,-0.395,-0.395,-0.395,-1.121,-1.121,-1.121,-1.121,-0.395,-0.395,-0.395,-0.395,-1.121,-0.395,-0.395,-0.395,-0.395,-1.121,-1.121,-0.395,-1.121,-0.395,-0.395,-1.121,-0.395,-1.121,-0.395,-0.395,-0.395,-0.395,-0.395,-1.121,-0.395,-0.395,-1.121,-1.121,-0.395,-0.395,-1.121,-0.395,-1.121,-0.395,-1.121,-0.395,-0.395,-0.395,-1.121,-1.121,-0.395,-1.121,-0.395,-0.395,-0.395,-0.395,-0.395,-0.395,-1.121,-0.395,-0.395,-1.121,-0.395,-0.395,-0.395,-1.121,-0.395,-1.121,-1.121,-0.395,-0.395,-1.121,-0.395,-0.395,-0.395,-0.395,-1.121,-0.395,-0.395,-0.395,-1.121,-1.121,-0.395,-0.395,-1.121,-0.395,-0.395,-0.395,-0.395,-0.395,-1.121,-0.395,-0.395,-0.395,-1.121,-0.395,-0.395,-0.395,-0.395,-0.395,-0.395,-0.395,-0.395,-0.395,-1.121,-0.395,-1.121,-1.121,-1.121,-1.121,-1.121,-0.395,-0.395,-1.121,-0.395,-1.121,-1.121,-0.395,-0.395,-1.121,-0.395,-1.121,-1.121,-0.395,-1.121,-1.121,-0.395,-0.395,-1.121,-0.395,-0.395,-0.395,-1.121,-1.121,-0.395,-1.121,-0.395,-0.395,-0.395,-1.121,-1.121,-1.121,-1.121,-1.121,-1.121,-1.121,-1.121,-1.121,-1.121,-1.121,-1.121,-1.121,-0.395,-1.121,-0.395,-1.121,-1.121,-0.395,-1.121,-1.121,-0.395,-0.395,-1.121,-1.121,-1.121,-1.121,-1.121,-0.395,-0.395,-0.395,-0.395,-1.121,-1.121,-0.395,-0.395,-0.395,-0.395,-0.395,-1.121,-0.395,-0.395,-0.395,-0.395,-1.121,-0.395,-0.395,-1.121,-1.121,-0.395,-1.121,-0.395,-1.121,-0.395,-0.395,-1.121,-1.121],"sd":[4.826,0.026,0.041,0.03,0.059,0.032,0.083,0.032,0.113,0.058,0.068,0.069,0.067,0.048,0.045,0.066,0.071,0.054,0.057,0.065,0.065,0.046,0.035,0.056,0.055,0.049,0.045,0.045,0.062,0.071,0.049,0.045,0.058,0.058,0.051,0.049,0.074,0.076,0.056,0.033,0.091,0.045,0.071,0.034,1.272,1.246,1.224,1.161,1.259,1.304,1.28,0.231,0.24,0.039,0.263,0.059,0.436,0.039,0.24,0.039,0.24,0.039,0.24,0.039,0.24,0.039,0.263,0.263,0.059,0.059,0.263,0.263,0.059,0.059,0.436,0.436,0.436,0.436,0.039,0.039,0.039,0.039,0.033,0.091,0.071,0.033,0.091,0.071,0.033,0.091,0.071,0.033,0.091,0.071,0.033,0.091,0.071,0.033,0.091,0.071,0.033,0.091,0.071,0.033,0.091,0.071,0.033,0.091,0.071,0.033,0.091,0.071,0.033,0.045,0.071,0.033,0.045,0.071,0.033,0.045,0.071,0.033,0.045,0.071,0.033,0.045,0.071,0.033,0.045,0.071,0.033,0.045,0.071,0.033,0.045,0.071,0.033,0.045,0.071,0.033,0.045,0.071,0.033,0.091,0.034,0.033,0.091,0.034,0.033,0.091,0.034,0.033,0.091,0.034,0.033,0.091,0.034,0.033,0.091,0.034,0.033,0.091,0.034,0.033,0.091,0.034,0.033,0.091,0.034,0.033,0.091,0.034,0.033,0.045,0.034,0.033,0.045,0.034,0.033,0.045,0.034,0.033,0.045,0.034,0.033,0.045,0.034,0.033,0.045,0.034,0.033,0.045,0.034,0.033,0.045,0.034,0.033,0.045,0.034,0.033,0.045,0.034,0.06,0.086,0.098,0.075,0.074,0.123,0.164,0.079,0.087,0.091,0.088,0.1,0.08,0.148,0.128,0.188,0.034,0,0.002,0,0.01,0.002,0.006,0,0,0.001,0,0,0.004,0,0,0,0,0,0,0,0.001,0.001,0.001,0,0,0,0.002,0,0.003,0,0.051,0,0.018,0,0.012,0.093,0.204,0,0.004,0.001,0.001,0.001,0.047,0.003,0.016,0.003,0.006,0.001,0.002,0,0.046,0.016,0.008,0.004,0,0.008,0.003,0.001,0.141,0.004,0.171,0,0.012,0,0.008,0.001,0.005,0,0,0.002,0,0,0.001,0,0,0,0,0,0,0,0.002,0.001,0.002,0,0,0,0.002,0,0.007,0,0.229,0.004,0.121,0.001,0.016,0.104,0.221,0.001,0.026,0.003,0.004,0.004,0.019,0.004,0.021,0.003,0.024,0.004,0.028,0.001,0.127,0.023,0.027,0.028,0.001,0.029,0.003,0.004,0.241,0.03,0.005,0.001,0.001,0.07,0.062,0.001,0.001,0.004,0,0.033,0.001,0.004,0.024,0.002,0.002,0.012,0.001,0.002,0,0.013,0.001,0.008,0.004,0,0,0,0.065,0.001,0,0,0.015,0.035,0.037,0.132,0.126,0.122,0.07,0.08,0.05,0.078,0.081,0.086,0.211,0.145,0.14,0.145,0.073,0.052,0.034,0.145,0.065,0.126,0.078,0.05,0.038,0.075,0.129,0.08,0.039,0.05,0.025,0.011,0.009,0.052,0.049,0.001,0.001,0.009,0.001,0.059,0.002,0.008,0.005,0.001,0.001,0.008,0.002,0.009,0.002,0.009,0.001,0.007,0.01,0.001,0.001,0.001,0.049,0.002,0.001,0.002,0.194,0.04,0.132,0.153,0.148,0.171,0.189,0.082,0.06,0.109,0.082,0.088,0.206,0.145,0.143,0.146,0.08,0.055,0.047,0.146,0.15,0.131,0.088,0.061,0.038,0.084,0.15,0.08,0.216,0.062,0.178,0.011,0.018,0.09,0.085,0.003,0.01,0.011,0.002,0.071,0.002,0.01,0.028,0.003,0.002,0.016,0.002,0.009,0.002,0.017,0.003,0.013,0.012,0.002,0.002,0.002,0.085,0.002,0.009,0.002,0.076,0.036,0.047,0.148,0.142,0.15,0.208,0.081,0.052,0.09,0.081,0.087,0.208,0.145,0.141,0.146,0.075,0.053,0.035,0.146,0.085,0.129,0.081,0.052,0.038,0.077,0.144,0.08,0.15,0.052,0.202,0.005,0.125,0.001,0.031,0.14,0.206,0.001,0.027,0.005,0.005,0.004,0.055,0.006,0.029,0.005,0.026,0.005,0.028,0.001,0.137,0.032,0.031,0.029,0.001,0.031,0.007,0.005,0.222,0.031,0,0,0,0,0,0,0,0,0,0,0,0,0,0.05,0.002,0.062,0.188,0.188,0.188,0.188,0.091,0.091,0.091,0.091,0.188,0.188,0.091,0.091,0.188,0.091,0.091,0.091,0.091,0.091,0.091,0.188,0.091,0.091,0.188,0.188,0.091,0.091,0.091,0.091,0.091,0.091,0.188,0.091,0.091,0.091,0.091,0.091,0.188,0.188,0.091,0.091,0.188,0.091,0.188,0.188,0.091,0.091,0.091,0.091,0.091,0.091,0.188,0.188,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.188,0.091,0.188,0.091,0.188,0.091,0.091,0.188,0.091,0.091,0.091,0.091,0.091,0.091,0.188,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.188,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.188,0.091,0.091,0.188,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.188,0.188,0.091,0.091,0.091,0.091,0.091,0.091,0.188,0.188,0.188,0.188,0.091,0.091,0.188,0.091,0.188,0.188,0.188,0.188,0.188,0.188,0.091,0.091,0.188,0.091,0.188,0.091,0.091,0.091,0.188,0.188,0.091,0.188,0.091,0.188,0.091,0.188,0.091,0.091,0.188,0.188,0.091,0.188,0.091,0.188,0.091,0.188,0.188,0.091,0.091,0.188,0.091,0.188,0.091,0.188,0.091,0.188,0.091,0.091,0.188,0.188,0.188,0.188,0.188,0.091,0.091,0.091,0.091,0.188,0.188,0.091,0.188,0.091,0.091,0.091,0.188,0.091,0.091,0.188,0.091,0.091,0.188,0.091,0.091,0.091,0.188,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.188,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.188,0.091,0.188,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.188,0.188,0.091,0.091,0.188,0.188,0.188,0.091,0.091,0.091,0.188,0.091,0.091,0.091,0.091,0.188,0.091,0.091,0.188,0.188,0.091,0.091,0.091,0.091,0.188,0.188,0.188,0.188,0.091,0.091,0.091,0.091,0.188,0.091,0.091,0.091,0.091,0.188,0.188,0.091,0.188,0.091,0.091,0.188,0.091,0.188,0.091,0.091,0.091,0.091,0.091,0.188,0.091,0.091,0.188,0.188,0.091,0.091,0.188,0.091,0.188,0.091,0.188,0.091,0.091,0.091,0.188,0.188,0.091,0.188,0.091,0.091,0.091,0.091,0.091,0.091,0.188,0.091,0.091,0.188,0.091,0.091,0.091,0.188,0.091,0.188,0.188,0.091,0.091,0.188,0.091,0.091,0.091,0.091,0.188,0.091,0.091,0.091,0.188,0.188,0.091,0.091,0.188,0.091,0.091,0.091,0.091,0.091,0.188,0.091,0.091,0.091,0.188,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.188,0.091,0.188,0.188,0.188,0.188,0.188,0.091,0.091,0.188,0.091,0.188,0.188,0.091,0.091,0.188,0.091,0.188,0.188,0.091,0.188,0.188,0.091,0.091,0.188,0.091,0.091,0.091,0.188,0.188,0.091,0.188,0.091,0.091,0.091,0.188,0.188,0.188,0.188,0.188,0.188,0.188,0.188,0.188,0.188,0.188,0.188,0.188,0.091,0.188,0.091,0.188,0.188,0.091,0.188,0.188,0.091,0.091,0.188,0.188,0.188,0.188,0.188,0.091,0.091,0.091,0.091,0.188,0.188,0.091,0.091,0.091,0.091,0.091,0.188,0.091,0.091,0.091,0.091,0.188,0.091,0.091,0.188,0.188,0.091,0.188,0.091,0.188,0.091,0.091,0.188,0.188],"mad":[4.767,0.02,0.032,0.024,0.053,0.024,0.059,0.024,0.108,0.057,0.068,0.069,0.067,0.046,0.043,0.066,0.071,0.052,0.056,0.067,0.064,0.043,0.033,0.054,0.055,0.047,0.043,0.044,0.063,0.073,0.049,0.043,0.058,0.059,0.05,0.048,0.076,0.077,0.056,0.032,0.092,0.044,0.072,0.034,1.125,1.082,1.119,1.013,1.111,1.13,1.102,0.156,0.233,0.038,0.254,0.057,0.424,0.039,0.233,0.038,0.233,0.038,0.233,0.038,0.233,0.038,0.254,0.254,0.057,0.057,0.254,0.254,0.057,0.057,0.424,0.424,0.424,0.424,0.039,0.039,0.039,0.039,0.032,0.092,0.072,0.032,0.092,0.072,0.032,0.092,0.072,0.032,0.092,0.072,0.032,0.092,0.072,0.032,0.092,0.072,0.032,0.092,0.072,0.032,0.092,0.072,0.032,0.092,0.072,0.032,0.092,0.072,0.032,0.044,0.072,0.032,0.044,0.072,0.032,0.044,0.072,0.032,0.044,0.072,0.032,0.044,0.072,0.032,0.044,0.072,0.032,0.044,0.072,0.032,0.044,0.072,0.032,0.044,0.072,0.032,0.044,0.072,0.032,0.092,0.034,0.032,0.092,0.034,0.032,0.092,0.034,0.032,0.092,0.034,0.032,0.092,0.034,0.032,0.092,0.034,0.032,0.092,0.034,0.032,0.092,0.034,0.032,0.092,0.034,0.032,0.092,0.034,0.032,0.044,0.034,0.032,0.044,0.034,0.032,0.044,0.034,0.032,0.044,0.034,0.032,0.044,0.034,0.032,0.044,0.034,0.032,0.044,0.034,0.032,0.044,0.034,0.032,0.044,0.034,0.032,0.044,0.034,0.062,0.084,0.095,0.073,0.074,0.119,0.159,0.077,0.085,0.09,0.087,0.097,0.08,0.148,0.126,0.19,0.011,0,0,0,0.003,0,0.002,0,0,0,0,0,0.001,0,0,0,0,0,0,0,0,0,0,0,0,0,0.001,0,0.001,0,0.017,0,0.004,0,0.005,0.06,0.217,0,0.001,0,0,0,0.021,0.001,0.007,0.001,0.002,0,0,0,0.021,0.006,0.003,0.001,0,0.002,0.001,0,0.101,0.001,0.153,0,0.005,0,0.003,0,0.001,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.001,0,0,0,0,0,0.002,0,0.274,0.001,0.088,0,0.006,0.077,0.253,0,0.011,0.001,0.001,0.001,0.008,0.001,0.009,0.001,0.01,0.001,0.012,0,0.099,0.01,0.012,0.011,0,0.012,0.001,0.001,0.297,0.013,0.001,0,0,0.043,0.038,0,0,0.001,0,0.015,0,0.001,0.01,0.001,0,0.005,0,0,0,0.005,0,0.003,0.001,0,0,0,0.038,0,0,0,0.002,0.002,0.006,0.094,0.088,0.084,0.036,0.031,0.01,0.033,0.031,0.036,0.227,0.103,0.099,0.105,0.026,0.01,0.002,0.105,0.025,0.079,0.031,0.01,0.002,0.027,0.091,0.03,0.014,0.01,0.013,0.005,0.004,0.032,0.03,0,0,0.004,0,0.038,0,0.004,0.002,0,0,0.003,0,0.004,0,0.004,0,0.003,0.004,0,0,0,0.03,0,0,0,0.206,0.01,0.102,0.14,0.135,0.175,0.193,0.035,0.024,0.082,0.032,0.04,0.226,0.103,0.107,0.106,0.038,0.016,0.016,0.107,0.135,0.092,0.049,0.025,0.003,0.042,0.134,0.031,0.243,0.026,0.168,0.005,0.01,0.071,0.069,0.002,0.004,0.006,0.001,0.051,0.001,0.005,0.014,0.001,0.001,0.009,0.001,0.004,0.001,0.009,0.001,0.007,0.007,0.001,0,0.001,0.065,0.001,0.003,0.001,0.035,0.002,0.013,0.122,0.116,0.134,0.226,0.032,0.011,0.049,0.032,0.037,0.23,0.103,0.102,0.106,0.028,0.01,0.003,0.106,0.049,0.085,0.034,0.011,0.002,0.03,0.116,0.031,0.114,0.011,0.218,0.001,0.093,0,0.018,0.127,0.219,0,0.012,0.002,0.002,0.002,0.031,0.002,0.016,0.002,0.012,0.001,0.012,0,0.116,0.017,0.015,0.012,0,0.015,0.003,0.002,0.252,0.014,0,0,0,0,0,0,0,0,0,0,0,0,0,0.01,0,0.026,0.19,0.19,0.19,0.19,0.091,0.091,0.091,0.091,0.19,0.19,0.091,0.091,0.19,0.091,0.091,0.091,0.091,0.091,0.091,0.19,0.091,0.091,0.19,0.19,0.091,0.091,0.091,0.091,0.091,0.091,0.19,0.091,0.091,0.091,0.091,0.091,0.19,0.19,0.091,0.091,0.19,0.091,0.19,0.19,0.091,0.091,0.091,0.091,0.091,0.091,0.19,0.19,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.19,0.091,0.19,0.091,0.19,0.091,0.091,0.19,0.091,0.091,0.091,0.091,0.091,0.091,0.19,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.19,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.19,0.091,0.091,0.19,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.19,0.19,0.091,0.091,0.091,0.091,0.091,0.091,0.19,0.19,0.19,0.19,0.091,0.091,0.19,0.091,0.19,0.19,0.19,0.19,0.19,0.19,0.091,0.091,0.19,0.091,0.19,0.091,0.091,0.091,0.19,0.19,0.091,0.19,0.091,0.19,0.091,0.19,0.091,0.091,0.19,0.19,0.091,0.19,0.091,0.19,0.091,0.19,0.19,0.091,0.091,0.19,0.091,0.19,0.091,0.19,0.091,0.19,0.091,0.091,0.19,0.19,0.19,0.19,0.19,0.091,0.091,0.091,0.091,0.19,0.19,0.091,0.19,0.091,0.091,0.091,0.19,0.091,0.091,0.19,0.091,0.091,0.19,0.091,0.091,0.091,0.19,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.19,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.19,0.091,0.19,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.19,0.19,0.091,0.091,0.19,0.19,0.19,0.091,0.091,0.091,0.19,0.091,0.091,0.091,0.091,0.19,0.091,0.091,0.19,0.19,0.091,0.091,0.091,0.091,0.19,0.19,0.19,0.19,0.091,0.091,0.091,0.091,0.19,0.091,0.091,0.091,0.091,0.19,0.19,0.091,0.19,0.091,0.091,0.19,0.091,0.19,0.091,0.091,0.091,0.091,0.091,0.19,0.091,0.091,0.19,0.19,0.091,0.091,0.19,0.091,0.19,0.091,0.19,0.091,0.091,0.091,0.19,0.19,0.091,0.19,0.091,0.091,0.091,0.091,0.091,0.091,0.19,0.091,0.091,0.19,0.091,0.091,0.091,0.19,0.091,0.19,0.19,0.091,0.091,0.19,0.091,0.091,0.091,0.091,0.19,0.091,0.091,0.091,0.19,0.19,0.091,0.091,0.19,0.091,0.091,0.091,0.091,0.091,0.19,0.091,0.091,0.091,0.19,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.091,0.19,0.091,0.19,0.19,0.19,0.19,0.19,0.091,0.091,0.19,0.091,0.19,0.19,0.091,0.091,0.19,0.091,0.19,0.19,0.091,0.19,0.19,0.091,0.091,0.19,0.091,0.091,0.091,0.19,0.19,0.091,0.19,0.091,0.091,0.091,0.19,0.19,0.19,0.19,0.19,0.19,0.19,0.19,0.19,0.19,0.19,0.19,0.19,0.091,0.19,0.091,0.19,0.19,0.091,0.19,0.19,0.091,0.091,0.19,0.19,0.19,0.19,0.19,0.091,0.091,0.091,0.091,0.19,0.19,0.091,0.091,0.091,0.091,0.091,0.19,0.091,0.091,0.091,0.091,0.19,0.091,0.091,0.19,0.19,0.091,0.19,0.091,0.19,0.091,0.091,0.19,0.19],"q5":[-775.801,0.001,0.002,0.002,0.005,0.002,0.004,0.002,0.477,0.057,0.102,0.101,0.089,0.046,0.03,0.077,0.132,0.05,0.053,0.093,0.081,0.029,0.022,0.053,0.77,0.802,0.818,0.819,0.745,0.691,0.799,0.82,0.757,0.757,0.793,0.802,0.682,0.688,0.765,0.801,0.223,0.694,0.074,0.81,-6.512,-6.001,-6.295,-5.294,-6.274,-5.478,-6.391,-0.741,-2.402,-0.222,-1.501,-0.365,-2.606,-0.211,-2.402,-0.222,-2.402,-0.222,-2.402,-0.222,-2.402,-0.222,-1.501,-1.501,-0.365,-0.365,-1.501,-1.501,-0.365,-0.365,-2.606,-2.606,-2.606,-2.606,-0.211,-0.211,-0.211,-0.211,0.091,0.223,0.074,0.091,0.223,0.074,0.091,0.223,0.074,0.091,0.223,0.074,0.091,0.223,0.074,0.801,0.223,0.074,0.801,0.223,0.074,0.801,0.223,0.074,0.801,0.223,0.074,0.801,0.223,0.074,0.091,0.694,0.074,0.091,0.694,0.074,0.091,0.694,0.074,0.091,0.694,0.074,0.091,0.694,0.074,0.801,0.694,0.074,0.801,0.694,0.074,0.801,0.694,0.074,0.801,0.694,0.074,0.801,0.694,0.074,0.091,0.223,0.81,0.091,0.223,0.81,0.091,0.223,0.81,0.091,0.223,0.81,0.091,0.223,0.81,0.801,0.223,0.81,0.801,0.223,0.81,0.801,0.223,0.81,0.801,0.223,0.81,0.801,0.223,0.81,0.091,0.694,0.81,0.091,0.694,0.81,0.091,0.694,0.81,0.091,0.694,0.81,0.091,0.694,0.81,0.801,0.694,0.81,0.801,0.694,0.81,0.801,0.694,0.81,0.801,0.694,0.81,0.801,0.694,0.81,0.569,-0.562,-0.639,-0.443,-0.461,-0.85,-1.221,-0.496,-0.562,-0.578,-0.581,-0.656,-0.477,-1.143,-0.841,-1.465,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.001,0,0,0,0,0.004,0.019,0,0,0,0,0,0.001,0,0,0,0,0,0,0,0.001,0,0,0,0,0,0,0,0.006,0,0.011,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.036,0,0.006,0,0,0.005,0.028,0,0.001,0,0,0,0,0,0,0,0.001,0,0.001,0,0.007,0.001,0.001,0.001,0,0.001,0,0,0.046,0.001,0,0,0,0.003,0.002,0,0,0,0,0.001,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.002,0,0,0,0,0,0,0.006,0.005,0.005,0.002,0.001,0,0.002,0.001,0.002,0.02,0.007,0.006,0.007,0.001,0,0,0.006,0.001,0.004,0.001,0,0,0.001,0.005,0.001,0.001,0,0.001,0,0,0.002,0.002,0,0,0,0,0.002,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.002,0,0,0,0.09,0.944,0.574,0.46,0.459,0.367,0.082,0.784,0.863,0.651,0.79,0.764,0.258,0.547,0.541,0.534,0.783,0.895,0.906,0.535,0.489,0.57,0.75,0.862,0.967,0.772,0.473,0.797,0.106,0.856,0.405,0.972,0.951,0.706,0.716,0.991,0.976,0.97,0.996,0.777,0.996,0.972,0.926,0.993,0.995,0.956,0.995,0.975,0.996,0.953,0.993,0.963,0.965,0.996,0.997,0.996,0.721,0.996,0.979,0.996,0.791,0.967,0.905,0.503,0.521,0.493,0.279,0.791,0.907,0.747,0.792,0.772,0.267,0.548,0.554,0.54,0.812,0.907,0.967,0.539,0.754,0.594,0.786,0.907,0.968,0.807,0.523,0.802,0.523,0.907,0.101,0.99,0.6,0.998,0.909,0.532,0.107,0.999,0.928,0.989,0.989,0.99,0.843,0.986,0.916,0.988,0.929,0.99,0.928,0.998,0.554,0.91,0.916,0.926,0.999,0.918,0.983,0.989,0.118,0.922,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.856,-1.465,-1.465,-1.465,-1.465,-0.564,-0.564,-0.564,-0.564,-1.465,-1.465,-0.564,-0.564,-1.465,-0.564,-0.564,-0.564,-0.564,-0.564,-0.564,-1.465,-0.564,-0.564,-1.465,-1.465,-0.564,-0.564,-0.564,-0.564,-0.564,-0.564,-1.465,-0.564,-0.564,-0.564,-0.564,-0.564,-1.465,-1.465,-0.564,-0.564,-1.465,-0.564,-1.465,-1.465,-0.564,-0.564,-0.564,-0.564,-0.564,-0.564,-1.465,-1.465,-0.564,-0.564,-0.564,-0.564,-0.564,-0.564,-0.564,-0.564,-0.564,-0.564,-1.465,-0.564,-1.465,-0.564,-1.465,-0.564,-0.564,-1.465,-0.564,-0.564,-0.564,-0.564,-0.564,-0.564,-1.465,-0.564,-0.564,-0.564,-0.564,-0.564,-0.564,-0.564,-0.564,-0.564,-0.564,-0.564,-0.564,-0.564,-1.465,-0.564,-0.564,-0.564,-0.564,-0.564,-0.564,-0.564,-0.564,-0.564,-0.564,-0.564,-1.465,-0.564,-0.564,-1.465,-0.564,-0.564,-0.564,-0.564,-0.564,-0.564,-0.564,-0.564,-0.564,-1.465,-1.465,-0.564,-0.564,-0.564,-0.564,-0.564,-0.564,-1.465,-1.465,-1.465,-1.465,-0.564,-0.564,-1.465,-0.564,-1.465,-1.465,-1.465,-1.465,-1.465,-1.465,-0.564,-0.564,-1.465,-0.564,-1.465,-0.564,-0.564,-0.564,-1.465,-1.465,-0.564,-1.465,-0.564,-1.465,-0.564,-1.465,-0.564,-0.564,-1.465,-1.465,-0.564,-1.465,-0.564,-1.465,-0.564,-1.465,-1.465,-0.564,-0.564,-1.465,-0.564,-1.465,-0.564,-1.465,-0.564,-1.465,-0.564,-0.564,-1.465,-1.465,-1.465,-1.465,-1.465,-0.564,-0.564,-0.564,-0.564,-1.465,-1.465,-0.564,-1.465,-0.564,-0.564,-0.564,-1.465,-0.564,-0.564,-1.465,-0.564,-0.564,-1.465,-0.564,-0.564,-0.564,-1.465,-0.564,-0.564,-0.564,-0.564,-0.564,-0.564,-0.564,-0.564,-0.564,-0.564,-0.564,-0.564,-1.465,-0.564,-0.564,-0.564,-0.564,-0.564,-0.564,-0.564,-0.564,-0.564,-1.465,-0.564,-1.465,-0.564,-0.564,-0.564,-0.564,-0.564,-0.564,-0.564,-0.564,-0.564,-1.465,-1.465,-0.564,-0.564,-1.465,-1.465,-1.465,-0.564,-0.564,-0.564,-1.465,-0.564,-0.564,-0.564,-0.564,-1.465,-0.564,-0.564,-1.465,-1.465,-0.564,-0.564,-0.564,-0.564,-1.465,-1.465,-1.465,-1.465,-0.564,-0.564,-0.564,-0.564,-1.465,-0.564,-0.564,-0.564,-0.564,-1.465,-1.465,-0.564,-1.465,-0.564,-0.564,-1.465,-0.564,-1.465,-0.564,-0.564,-0.564,-0.564,-0.564,-1.465,-0.564,-0.564,-1.465,-1.465,-0.564,-0.564,-1.465,-0.564,-1.465,-0.564,-1.465,-0.564,-0.564,-0.564,-1.465,-1.465,-0.564,-1.465,-0.564,-0.564,-0.564,-0.564,-0.564,-0.564,-1.465,-0.564,-0.564,-1.465,-0.564,-0.564,-0.564,-1.465,-0.564,-1.465,-1.465,-0.564,-0.564,-1.465,-0.564,-0.564,-0.564,-0.564,-1.465,-0.564,-0.564,-0.564,-1.465,-1.465,-0.564,-0.564,-1.465,-0.564,-0.564,-0.564,-0.564,-0.564,-1.465,-0.564,-0.564,-0.564,-1.465,-0.564,-0.564,-0.564,-0.564,-0.564,-0.564,-0.564,-0.564,-0.564,-1.465,-0.564,-1.465,-1.465,-1.465,-1.465,-1.465,-0.564,-0.564,-1.465,-0.564,-1.465,-1.465,-0.564,-0.564,-1.465,-0.564,-1.465,-1.465,-0.564,-1.465,-1.465,-0.564,-0.564,-1.465,-0.564,-0.564,-0.564,-1.465,-1.465,-0.564,-1.465,-0.564,-0.564,-0.564,-1.465,-1.465,-1.465,-1.465,-1.465,-1.465,-1.465,-1.465,-1.465,-1.465,-1.465,-1.465,-1.465,-0.564,-1.465,-0.564,-1.465,-1.465,-0.564,-1.465,-1.465,-0.564,-0.564,-1.465,-1.465,-1.465,-1.465,-1.465,-0.564,-0.564,-0.564,-0.564,-1.465,-1.465,-0.564,-0.564,-0.564,-0.564,-0.564,-1.465,-0.564,-0.564,-0.564,-0.564,-1.465,-0.564,-0.564,-1.465,-1.465,-0.564,-1.465,-0.564,-1.465,-0.564,-0.564,-1.465,-1.465],"q95":[-760.056,0.081,0.126,0.091,0.188,0.096,0.245,0.097,0.837,0.246,0.325,0.325,0.307,0.204,0.175,0.292,0.369,0.226,0.239,0.307,0.293,0.176,0.135,0.232,0.95,0.959,0.963,0.963,0.947,0.925,0.957,0.965,0.944,0.946,0.958,0.96,0.923,0.936,0.951,0.909,0.523,0.839,0.305,0.921,-2.512,-2.073,-2.394,-1.671,-2.347,-1.406,-2.332,-0.178,-1.614,-0.095,-0.647,-0.175,-1.186,-0.083,-1.614,-0.095,-1.614,-0.095,-1.614,-0.095,-1.614,-0.095,-0.647,-0.647,-0.175,-0.175,-0.647,-0.647,-0.175,-0.175,-1.186,-1.186,-1.186,-1.186,-0.083,-0.083,-0.083,-0.083,0.199,0.523,0.305,0.199,0.523,0.305,0.199,0.523,0.305,0.199,0.523,0.305,0.199,0.523,0.305,0.909,0.523,0.305,0.909,0.523,0.305,0.909,0.523,0.305,0.909,0.523,0.305,0.909,0.523,0.305,0.199,0.839,0.305,0.199,0.839,0.305,0.199,0.839,0.305,0.199,0.839,0.305,0.199,0.839,0.305,0.909,0.839,0.305,0.909,0.839,0.305,0.909,0.839,0.305,0.909,0.839,0.305,0.909,0.839,0.305,0.199,0.523,0.921,0.199,0.523,0.921,0.199,0.523,0.921,0.199,0.523,0.921,0.199,0.523,0.921,0.909,0.523,0.921,0.909,0.523,0.921,0.909,0.523,0.921,0.909,0.523,0.921,0.909,0.523,0.921,0.199,0.839,0.921,0.199,0.839,0.921,0.199,0.839,0.921,0.199,0.839,0.921,0.199,0.839,0.921,0.909,0.839,0.921,0.909,0.839,0.921,0.909,0.839,0.921,0.909,0.839,0.921,0.909,0.839,0.921,0.769,-0.281,-0.315,-0.193,-0.221,-0.448,-0.686,-0.241,-0.276,-0.28,-0.293,-0.332,-0.216,-0.657,-0.423,-0.841,0.081,0,0.003,0.001,0.022,0.003,0.013,0,0,0.001,0,0,0.009,0,0,0,0,0,0,0,0.001,0.003,0.002,0,0,0,0.004,0,0.006,0,0.123,0,0.036,0.001,0.031,0.281,0.668,0,0.006,0.002,0.002,0.002,0.123,0.007,0.041,0.006,0.014,0.001,0.002,0.001,0.123,0.037,0.017,0.006,0,0.017,0.006,0.002,0.43,0.007,0.551,0.001,0.03,0,0.02,0.003,0.011,0,0,0.003,0,0,0.002,0,0,0,0.001,0,0.001,0,0.004,0.003,0.005,0.001,0,0,0.003,0,0.015,0.001,0.762,0.009,0.374,0.001,0.04,0.321,0.729,0.001,0.068,0.006,0.009,0.009,0.046,0.008,0.053,0.007,0.063,0.009,0.07,0.001,0.396,0.059,0.073,0.071,0.001,0.072,0.007,0.009,0.808,0.074,0.008,0.001,0.003,0.209,0.184,0.003,0.001,0.01,0,0.087,0.001,0.01,0.06,0.004,0.003,0.029,0.001,0.003,0,0.031,0.001,0.02,0.01,0,0,0.001,0.188,0.001,0.001,0.001,0.024,0.032,0.062,0.408,0.387,0.377,0.197,0.205,0.088,0.204,0.206,0.224,0.692,0.45,0.429,0.449,0.179,0.09,0.031,0.449,0.163,0.382,0.199,0.089,0.032,0.184,0.394,0.197,0.093,0.088,0.067,0.027,0.023,0.152,0.142,0.002,0.001,0.024,0.003,0.174,0.003,0.021,0.014,0.003,0.002,0.02,0.003,0.022,0.004,0.022,0.002,0.019,0.025,0.003,0.003,0.003,0.144,0.003,0.001,0.003,0.713,0.998,0.975,0.944,0.933,0.918,0.695,0.994,0.995,0.975,0.996,0.993,0.919,0.989,0.979,0.981,0.992,0.997,0.997,0.983,0.96,0.975,0.985,0.995,1,0.991,0.947,0.996,0.8,0.995,0.969,1,0.998,0.984,0.981,1,1,0.999,1,0.99,1,0.999,0.998,1,1,0.999,1,1,1,0.999,1,0.999,0.999,1,1,1,0.985,1,1,1,0.996,1,0.999,0.969,0.966,0.967,0.947,0.997,0.999,0.992,0.998,0.997,0.936,0.991,0.987,0.987,0.998,0.999,1,0.988,0.993,0.987,0.995,0.999,1,0.997,0.972,0.998,0.985,0.999,0.754,1,0.985,1,0.996,0.971,0.778,1,0.999,1,1,1,0.995,1,0.998,1,0.999,1,0.999,1,0.98,0.997,0.998,0.999,1,0.998,1,1,0.835,0.999,0,0,0,0,0,0,0,0,0,0,0,0,0.001,0.088,0.003,0.995,-0.841,-0.841,-0.841,-0.841,-0.263,-0.263,-0.263,-0.263,-0.841,-0.841,-0.263,-0.263,-0.841,-0.263,-0.263,-0.263,-0.263,-0.263,-0.263,-0.841,-0.263,-0.263,-0.841,-0.841,-0.263,-0.263,-0.263,-0.263,-0.263,-0.263,-0.841,-0.263,-0.263,-0.263,-0.263,-0.263,-0.841,-0.841,-0.263,-0.263,-0.841,-0.263,-0.841,-0.841,-0.263,-0.263,-0.263,-0.263,-0.263,-0.263,-0.841,-0.841,-0.263,-0.263,-0.263,-0.263,-0.263,-0.263,-0.263,-0.263,-0.263,-0.263,-0.841,-0.263,-0.841,-0.263,-0.841,-0.263,-0.263,-0.841,-0.263,-0.263,-0.263,-0.263,-0.263,-0.263,-0.841,-0.263,-0.263,-0.263,-0.263,-0.263,-0.263,-0.263,-0.263,-0.263,-0.263,-0.263,-0.263,-0.263,-0.841,-0.263,-0.263,-0.263,-0.263,-0.263,-0.263,-0.263,-0.263,-0.263,-0.263,-0.263,-0.841,-0.263,-0.263,-0.841,-0.263,-0.263,-0.263,-0.263,-0.263,-0.263,-0.263,-0.263,-0.263,-0.841,-0.841,-0.263,-0.263,-0.263,-0.263,-0.263,-0.263,-0.841,-0.841,-0.841,-0.841,-0.263,-0.263,-0.841,-0.263,-0.841,-0.841,-0.841,-0.841,-0.841,-0.841,-0.263,-0.263,-0.841,-0.263,-0.841,-0.263,-0.263,-0.263,-0.841,-0.841,-0.263,-0.841,-0.263,-0.841,-0.263,-0.841,-0.263,-0.263,-0.841,-0.841,-0.263,-0.841,-0.263,-0.841,-0.263,-0.841,-0.841,-0.263,-0.263,-0.841,-0.263,-0.841,-0.263,-0.841,-0.263,-0.841,-0.263,-0.263,-0.841,-0.841,-0.841,-0.841,-0.841,-0.263,-0.263,-0.263,-0.263,-0.841,-0.841,-0.263,-0.841,-0.263,-0.263,-0.263,-0.841,-0.263,-0.263,-0.841,-0.263,-0.263,-0.841,-0.263,-0.263,-0.263,-0.841,-0.263,-0.263,-0.263,-0.263,-0.263,-0.263,-0.263,-0.263,-0.263,-0.263,-0.263,-0.263,-0.841,-0.263,-0.263,-0.263,-0.263,-0.263,-0.263,-0.263,-0.263,-0.263,-0.841,-0.263,-0.841,-0.263,-0.263,-0.263,-0.263,-0.263,-0.263,-0.263,-0.263,-0.263,-0.841,-0.841,-0.263,-0.263,-0.841,-0.841,-0.841,-0.263,-0.263,-0.263,-0.841,-0.263,-0.263,-0.263,-0.263,-0.841,-0.263,-0.263,-0.841,-0.841,-0.263,-0.263,-0.263,-0.263,-0.841,-0.841,-0.841,-0.841,-0.263,-0.263,-0.263,-0.263,-0.841,-0.263,-0.263,-0.263,-0.263,-0.841,-0.841,-0.263,-0.841,-0.263,-0.263,-0.841,-0.263,-0.841,-0.263,-0.263,-0.263,-0.263,-0.263,-0.841,-0.263,-0.263,-0.841,-0.841,-0.263,-0.263,-0.841,-0.263,-0.841,-0.263,-0.841,-0.263,-0.263,-0.263,-0.841,-0.841,-0.263,-0.841,-0.263,-0.263,-0.263,-0.263,-0.263,-0.263,-0.841,-0.263,-0.263,-0.841,-0.263,-0.263,-0.263,-0.841,-0.263,-0.841,-0.841,-0.263,-0.263,-0.841,-0.263,-0.263,-0.263,-0.263,-0.841,-0.263,-0.263,-0.263,-0.841,-0.841,-0.263,-0.263,-0.841,-0.263,-0.263,-0.263,-0.263,-0.263,-0.841,-0.263,-0.263,-0.263,-0.841,-0.263,-0.263,-0.263,-0.263,-0.263,-0.263,-0.263,-0.263,-0.263,-0.841,-0.263,-0.841,-0.841,-0.841,-0.841,-0.841,-0.263,-0.263,-0.841,-0.263,-0.841,-0.841,-0.263,-0.263,-0.841,-0.263,-0.841,-0.841,-0.263,-0.841,-0.841,-0.263,-0.263,-0.841,-0.263,-0.263,-0.263,-0.841,-0.841,-0.263,-0.841,-0.263,-0.263,-0.263,-0.841,-0.841,-0.841,-0.841,-0.841,-0.841,-0.841,-0.841,-0.841,-0.841,-0.841,-0.841,-0.841,-0.263,-0.841,-0.263,-0.841,-0.841,-0.263,-0.841,-0.841,-0.263,-0.263,-0.841,-0.841,-0.841,-0.841,-0.841,-0.263,-0.263,-0.263,-0.263,-0.841,-0.841,-0.263,-0.263,-0.263,-0.263,-0.263,-0.841,-0.263,-0.263,-0.263,-0.263,-0.841,-0.263,-0.263,-0.841,-0.841,-0.263,-0.841,-0.263,-0.841,-0.263,-0.263,-0.841,-0.841]},"columns":[{"id":"variable","name":"variable","type":"character"},{"id":"mean","name":"mean","type":"numeric"},{"id":"median","name":"median","type":"numeric"},{"id":"sd","name":"sd","type":"numeric"},{"id":"mad","name":"mad","type":"numeric"},{"id":"q5","name":"q5","type":"numeric"},{"id":"q95","name":"q95","type":"numeric"}],"filterable":true,"searchable":true,"highlight":true,"dataKey":"12011ac74608297eb618cd3c22784251"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>I also included the summarized convergence measures and summary statistics for all of the draws. I also will create an interactive table to look over the posterior draws of each parameter.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>y_rep <span class="ot">&lt;-</span> fit<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"x_rep"</span>) <span class="sc">|&gt;</span> <span class="fu">as_draws_matrix</span>()</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>stu_resp_attr <span class="ot">&lt;-</span> fit<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"prob_resp_attr"</span>) <span class="sc">|&gt;</span> <span class="fu">as_draws_matrix</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>I decided to extract the replicated values for the items and the probabilities oof each student’s mastery of each of the three latent attributes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_trace</span>(<span class="fu">exp</span>(y_rep[,<span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">450</span>, <span class="dv">30</span>)])) <span class="sc">+</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>y <span class="sc">|&gt;</span> <span class="fu">react_table</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="reactable html-widget html-fill-item" id="htmlwidget-37d3240ad488a309c639" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-37d3240ad488a309c639">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"studentid":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30],"y1":[0,0,0,0,1,1,1,1,0,0,1,1,0,1,1,1,1,1,1,0,1,1,0,0,1,1,1,1,1,1],"y2":[0,1,1,1,1,1,0,0,1,1,0,1,0,0,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,1],"y3":[1,1,0,1,0,1,0,1,1,0,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1],"y4":[0,1,1,1,1,1,1,1,1,1,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,0,0,1,1,1],"y5":[1,1,1,0,0,0,0,1,1,0,1,0,0,0,0,0,0,1,1,0,1,0,1,1,1,0,0,1,0,1],"y6":[0,1,0,1,1,0,0,1,0,1,0,1,0,0,1,1,0,1,0,1,0,1,0,1,1,0,0,0,0,0],"y7":[1,1,1,1,0,0,1,0,1,1,1,0,1,1,0,1,1,0,1,1,1,0,1,1,1,1,1,1,1,1],"y8":[1,1,1,1,0,1,1,1,1,1,1,1,1,1,0,1,0,1,1,1,1,1,1,1,1,1,0,0,1,1],"y9":[0,0,0,1,1,1,0,1,1,1,1,0,1,1,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,1],"y10":[1,1,1,0,0,1,0,1,1,0,1,0,1,1,1,1,1,0,1,1,0,0,1,1,0,1,0,1,0,1],"y11":[1,1,0,0,1,0,1,1,1,1,1,1,0,1,1,0,1,1,1,0,1,0,0,1,1,0,1,1,1,1],"y12":[0,1,1,1,0,0,1,1,0,1,1,1,1,1,0,1,1,1,0,1,1,1,1,1,1,1,1,1,0,1],"y13":[0,0,0,0,0,1,1,0,1,0,0,1,1,0,1,0,0,1,0,0,1,1,0,1,1,1,0,0,1,0],"y14":[1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,1,0,0,1,1,0,0,0,0],"y15":[0,1,1,1,1,0,0,1,1,1,1,1,0,1,1,1,1,0,1,1,0,0,1,0,1,0,1,1,0,0]},"columns":[{"id":"studentid","name":"studentid","type":"numeric"},{"id":"y1","name":"y1","type":"numeric"},{"id":"y2","name":"y2","type":"numeric"},{"id":"y3","name":"y3","type":"numeric"},{"id":"y4","name":"y4","type":"numeric"},{"id":"y5","name":"y5","type":"numeric"},{"id":"y6","name":"y6","type":"numeric"},{"id":"y7","name":"y7","type":"numeric"},{"id":"y8","name":"y8","type":"numeric"},{"id":"y9","name":"y9","type":"numeric"},{"id":"y10","name":"y10","type":"numeric"},{"id":"y11","name":"y11","type":"numeric"},{"id":"y12","name":"y12","type":"numeric"},{"id":"y13","name":"y13","type":"numeric"},{"id":"y14","name":"y14","type":"numeric"},{"id":"y15","name":"y15","type":"numeric"}],"filterable":true,"searchable":true,"highlight":true,"dataKey":"e4070ee024f9a9b445f3493d12f7fe26"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Next, I decided to compare the probabilities of each item for one student by having a sequence going from 1 to 450 (end of the columns in the matrix) to get the draws for the first student. As we can see from the traceplots for the first student and the originaly data, the original responses and the probabilities with a probability threshold of 0.5 match one another.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_intervals</span>(<span class="fu">exp</span>(y_rep[,<span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">450</span>, <span class="dv">30</span>)]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_areas</span>(<span class="fu">exp</span>(y_rep[,<span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">450</span>, <span class="dv">30</span>)]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ppc_intervals</span>(</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> y <span class="sc">|&gt;</span> <span class="fu">pull</span>(y1) <span class="sc">|&gt;</span> <span class="fu">as.vector</span>(),</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">yrep =</span> <span class="fu">exp</span>(y_rep[, <span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>])</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_hline</span>(<span class="at">yintercept =</span> .<span class="dv">5</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="fu">coord_flip</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-9-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>I enjoy using traceplots just to see how the iterations are doing and that they look like radio static. If we do not wish to use traceplots, we can also use intervals or areas. Both of which show the credible intervals of our probabilities. Lastly, there is the option to use the posterior predictive check intervals where we can compare the probabilities to the actual responses in the same plot. At least for the first student we can see that the replicated data matches the actual data well.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(loo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>This is loo version 2.8.0</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>- Online documentation and vignettes at mc-stan.org/loo</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>- As of v2.0.0 loo defaults to 1 core but we recommend using as many as possible. Use the 'cores' argument or set options(mc.cores = NUM_CORES) for an entire session. </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>- Windows 10 users: loo may be very slow if 'mc.cores' is set in your .Rprofile file (see https://github.com/stan-dev/loo/issues/94).</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">loo</span>(y_rep)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Computed from 8000 by 450 log-likelihood matrix.

         Estimate   SE
elpd_loo   -303.2  7.6
p_loo         8.1  0.3
looic       606.4 15.2
------
MCSE of elpd_loo is 0.0.
MCSE and ESS estimates assume independent draws (r_eff=1).

All Pareto k estimates are good (k &lt; 0.7).
See help('pareto-k-diagnostic') for details.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">waic</span>(y_rep)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Computed from 8000 by 450 log-likelihood matrix.

          Estimate   SE
elpd_waic   -303.2  7.6
p_waic         8.1  0.3
waic         606.4 15.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>bn_resid <span class="ot">&lt;-</span> y[,<span class="sc">-</span><span class="dv">1</span>] <span class="sc">-</span> <span class="fu">exp</span>(y_rep)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>bn_resid<span class="sc">^</span><span class="dv">2</span> <span class="sc">|&gt;</span> </span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowid_to_column</span>() <span class="sc">|&gt;</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>      rowid,</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>      y2</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> .<span class="dv">7</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>actual_stu_resp_attr <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">studentid =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(y),</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">att1 =</span> <span class="fu">runif</span>(<span class="fu">nrow</span>(y), <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">att2 =</span> <span class="fu">runif</span>(<span class="fu">nrow</span>(y), <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">att3 =</span> <span class="fu">runif</span>(<span class="fu">nrow</span>(y), <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>      <span class="sc">-</span>studentid,</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>      <span class="sc">~</span><span class="fu">if_else</span>(.x <span class="sc">&gt;</span> .<span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The last thing I thought to do for this analysis was to create an artificial dataset of all the student attribute mastery responses. I will use this to compare the accuracy of our model in correctly classifying if students had mastery on all of the attributes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>stu_resp_attr_mean <span class="ot">&lt;-</span> stu_resp_attr <span class="sc">|&gt;</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">everything</span>(),</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>      <span class="sc">~</span><span class="fu">mean</span>(.x)</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>stu_resp_attr_class <span class="ot">&lt;-</span> stu_resp_attr_mean <span class="sc">|&gt;</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>      <span class="fu">everything</span>(),</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>      <span class="sc">~</span><span class="fu">if_else</span>(.x <span class="sc">&gt;</span> .<span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>stu_resp_attr_class <span class="ot">&lt;-</span> stu_resp_attr_class <span class="sc">|&gt;</span></span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">everything</span>()</span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(</span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>    name,</span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"stu"</span>, <span class="st">"att"</span>),</span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">","</span></span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">stu =</span> <span class="fu">str_remove</span>(stu, <span class="st">"</span><span class="sc">\\</span><span class="st">["</span>),</span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">att =</span> <span class="fu">str_remove</span>(att, <span class="st">"</span><span class="sc">\\</span><span class="st">]"</span>),</span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">att =</span> <span class="fu">paste0</span>(<span class="st">"att"</span>, att),</span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">stu =</span> <span class="fu">str_remove</span>(stu, <span class="st">"prob_resp_attr"</span>)</span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb40-34"><a href="#cb40-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> att,</span>
<span id="cb40-35"><a href="#cb40-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> value</span>
<span id="cb40-36"><a href="#cb40-36" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For the probabilities, first I will get the average of the draws for each student and their probability of mastery for each of the three attributes. I again used a threshold of 0.5 for classifying whether a student met mastery of each attribute and then did some manipulation to get the data into a wide format where each attribute is its own column and each student is a row. We can how see how well the model classifies these students into mastery of each attribute.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map2</span>(</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  stu_resp_attr_class[,<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>],</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  actual_stu_resp_attr[,<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>],</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span><span class="fu">table</span>(.x, .y)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$att1
   .y
.x   0  1
  1 15 15

$att2
   .y
.x   0  1
  1 14 16

$att3
   .y
.x   0  1
  0  1  2
  1 11 16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map2</span>(</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a> stu_resp_attr_class[,<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>],</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  actual_stu_resp_attr[,<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>],</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span><span class="fu">prop.table</span>(</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">table</span>(.x, .y)</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$att1
   .y
.x    0   1
  1 0.5 0.5

$att2
   .y
.x          0         1
  1 0.4666667 0.5333333

$att3
   .y
.x           0          1
  0 0.03333333 0.06666667
  1 0.36666667 0.53333333</code></pre>
</div>
</div>
<p>As shown above, we can see the counts and percentages for the classification of each attribute. We can see that the problem is that the model is predicting that students are mastering each attribute when they have not mastered the attribute. This is resulting in several false positives for the model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>stu_resp_attr_long <span class="ot">&lt;-</span> stu_resp_attr_class <span class="sc">|&gt;</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>stu)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>actual_stu_resp_attr_long <span class="ot">&lt;-</span> actual_stu_resp_attr <span class="sc">|&gt;</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span>studentid)</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>accuracy_att <span class="ot">&lt;-</span> <span class="fu">mean</span>(stu_resp_attr_long<span class="sc">$</span>value <span class="sc">==</span> actual_stu_resp_attr_long<span class="sc">$</span>value)</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>accuracy_att</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5333333</code></pre>
</div>
</div>
<p>Finally, I pivoted the data to be long so I could compare the values for the actual responses and the posterior draws to show the accuracy of this model. The accuracy value shows that this model was not that accurate with a value of 0.5333333. This is a good starting point, but this may indicate that the model needs better definied priors and may require the edges between the attributes to show latent relationships.</p>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>